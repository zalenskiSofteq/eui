{"remainingRequest":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!D:\\work\\eui\\src\\services\\security\\get_secure_rel_for_target.ts","dependencies":[{"path":"D:\\work\\eui\\src\\services\\security\\get_secure_rel_for_target.ts","mtime":1649070093846},{"path":"D:\\work\\eui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636976621750},{"path":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js","mtime":1649070120649}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbSI7CgovKgogKiBMaWNlbnNlZCB0byBFbGFzdGljc2VhcmNoIEIuVi4gdW5kZXIgb25lIG9yIG1vcmUgY29udHJpYnV0b3IKICogbGljZW5zZSBhZ3JlZW1lbnRzLiBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3RyaWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQKICogb3duZXJzaGlwLiBFbGFzdGljc2VhcmNoIEIuVi4gbGljZW5zZXMgdGhpcyBmaWxlIHRvIHlvdSB1bmRlcgogKiB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heQogKiBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywKICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQogKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCi8qKgogKiBTZWN1cmVzIG91dGJvdW5kIGxpbmtzLiBGb3IgbW9yZSBpbmZvOgogKiBodHRwczovL3d3dy5qaXRiaXQuY29tL2FsZXhibG9nLzI1Ni10YXJnZXRibGFuay0tLXRoZS1tb3N0LXVuZGVyZXN0aW1hdGVkLXZ1bG5lcmFiaWxpdHktZXZlci8KICovCmltcG9ydCB7IGlzRG9tYWluU2VjdXJlIH0gZnJvbSAnLi4vdXJsJzsKZXhwb3J0IHZhciBnZXRTZWN1cmVSZWxGb3JUYXJnZXQgPSBmdW5jdGlvbiBnZXRTZWN1cmVSZWxGb3JUYXJnZXQoX3JlZikgewogIHZhciBocmVmID0gX3JlZi5ocmVmLAogICAgICBfcmVmJHRhcmdldCA9IF9yZWYudGFyZ2V0LAogICAgICB0YXJnZXQgPSBfcmVmJHRhcmdldCA9PT0gdm9pZCAwID8gJycgOiBfcmVmJHRhcmdldCwKICAgICAgcmVsID0gX3JlZi5yZWw7CiAgdmFyIGlzRWxhc3RpY0hyZWYgPSAhIWhyZWYgJiYgaXNEb21haW5TZWN1cmUoaHJlZik7CiAgdmFyIHJlbFBhcnRzID0gISFyZWwgPyByZWwuc3BsaXQoJyAnKS5maWx0ZXIoZnVuY3Rpb24gKHBhcnQpIHsKICAgIHJldHVybiAhIXBhcnQubGVuZ3RoICYmIHBhcnQgIT09ICdub3JlZmVycmVyJzsKICB9KSA6IFtdOwoKICBpZiAoIWlzRWxhc3RpY0hyZWYpIHsKICAgIHJlbFBhcnRzLnB1c2goJ25vcmVmZXJyZXInKTsKICB9CgogIGlmICh0YXJnZXQuaW5jbHVkZXMoJ19ibGFuaycpICYmIHJlbFBhcnRzLmluZGV4T2YoJ25vb3BlbmVyJykgPT09IC0xKSB7CiAgICByZWxQYXJ0cy5wdXNoKCdub29wZW5lcicpOwogIH0KCiAgcmV0dXJuIHJlbFBhcnRzLnNvcnQoKS5qb2luKCcgJykudHJpbSgpOwp9OwoKdHJ5IHsKICBnZXRTZWN1cmVSZWxGb3JUYXJnZXQuX19kb2NnZW5JbmZvID0gewogICAgZGVzY3JpcHRpb246ICcnLAogICAgZGlzcGxheU5hbWU6ICdnZXRTZWN1cmVSZWxGb3JUYXJnZXQnLAogICAgbWV0aG9kczogW10sCiAgICBwcm9wczogewogICAgICBocmVmOiB7CiAgICAgICAgZGVmYXVsdFZhbHVlOiBudWxsLAogICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICBuYW1lOiAnaHJlZicsCiAgICAgICAgcGFyZW50OiB1bmRlZmluZWQsCiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgIHR5cGU6IHsKICAgICAgICAgIG5hbWU6ICdzdHJpbmcnCiAgICAgICAgfQogICAgICB9LAogICAgICB0YXJnZXQ6IHsKICAgICAgICBkZWZhdWx0VmFsdWU6IHsKICAgICAgICAgIHZhbHVlOiAnJwogICAgICAgIH0sCiAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgIG5hbWU6ICd0YXJnZXQnLAogICAgICAgIHBhcmVudDogdW5kZWZpbmVkLAogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB0eXBlOiB7CiAgICAgICAgICBuYW1lOiAnc3RyaW5nJwogICAgICAgIH0KICAgICAgfSwKICAgICAgcmVsOiB7CiAgICAgICAgZGVmYXVsdFZhbHVlOiBudWxsLAogICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICBuYW1lOiAncmVsJywKICAgICAgICBwYXJlbnQ6IHVuZGVmaW5lZCwKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogewogICAgICAgICAgbmFtZTogJ3N0cmluZycKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBleHRlbmRlZEludGVyZmFjZXM6IFtdCiAgfTsKfSBjYXRjaCAoZSkge30="},{"version":3,"sources":["D:/work/eui/src/services/security/get_secure_rel_for_target.ts"],"names":["isDomainSecure","getSecureRelForTarget","href","target","rel","isElasticHref","relParts","split","filter","part","length","push","includes","indexOf","sort","join","trim"],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAASA,cAAT,QAA+B,QAA/B;AAEA,OAAO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,OAQ/B;AAAA,MAPJC,IAOI,QAPJA,IAOI;AAAA,yBANJC,MAMI;AAAA,MANJA,MAMI,4BANK,EAML;AAAA,MALJC,GAKI,QALJA,GAKI;AACJ,MAAMC,aAAa,GAAG,CAAC,CAACH,IAAF,IAAUF,cAAc,CAACE,IAAD,CAA9C;AACA,MAAMI,QAAQ,GAAG,CAAC,CAACF,GAAF,GACbA,GAAG,CAACG,KAAJ,CAAU,GAAV,EAAeC,MAAf,CAAsB,UAACC,IAAD;AAAA,WAAU,CAAC,CAACA,IAAI,CAACC,MAAP,IAAiBD,IAAI,KAAK,YAApC;AAAA,GAAtB,CADa,GAEb,EAFJ;;AAIA,MAAI,CAACJ,aAAL,EAAoB;AAClBC,IAAAA,QAAQ,CAACK,IAAT,CAAc,YAAd;AACD;;AAED,MAAIR,MAAM,CAACS,QAAP,CAAgB,QAAhB,KAA6BN,QAAQ,CAACO,OAAT,CAAiB,UAAjB,MAAiC,CAAC,CAAnE,EAAsE;AACpEP,IAAAA,QAAQ,CAACK,IAAT,CAAc,UAAd;AACD;;AAED,SAAOL,QAAQ,CAACQ,IAAT,GAAgBC,IAAhB,CAAqB,GAArB,EAA0BC,IAA1B,EAAP;AACD,CAvBM","sourcesContent":["/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * Secures outbound links. For more info:\n * https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/\n */\nimport { isDomainSecure } from '../url';\n\nexport const getSecureRelForTarget = ({\n  href,\n  target = '',\n  rel,\n}: {\n  href?: string;\n  target?: '_blank' | '_self' | '_parent' | '_top' | string;\n  rel?: string;\n}) => {\n  const isElasticHref = !!href && isDomainSecure(href);\n  const relParts = !!rel\n    ? rel.split(' ').filter((part) => !!part.length && part !== 'noreferrer')\n    : [];\n\n  if (!isElasticHref) {\n    relParts.push('noreferrer');\n  }\n\n  if (target.includes('_blank') && relParts.indexOf('noopener') === -1) {\n    relParts.push('noopener');\n  }\n\n  return relParts.sort().join(' ').trim();\n};\n"]}]}