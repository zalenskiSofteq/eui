{"remainingRequest":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!D:\\work\\eui\\src\\components\\markdown_editor\\plugins\\markdown_link_validator.tsx","dependencies":[{"path":"D:\\work\\eui\\src\\components\\markdown_editor\\plugins\\markdown_link_validator.tsx","mtime":1649070093704},{"path":"D:\\work\\eui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636976621750},{"path":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js","mtime":1649070120649}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKCi8qCiAqIExpY2Vuc2VkIHRvIEVsYXN0aWNzZWFyY2ggQi5WLiB1bmRlciBvbmUgb3IgbW9yZSBjb250cmlidXRvcgogKiBsaWNlbnNlIGFncmVlbWVudHMuIFNlZSB0aGUgTk9USUNFIGZpbGUgZGlzdHJpYnV0ZWQgd2l0aAogKiB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcmVnYXJkaW5nIGNvcHlyaWdodAogKiBvd25lcnNoaXAuIEVsYXN0aWNzZWFyY2ggQi5WLiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyCiAqIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5CiAqIG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwppbXBvcnQgdmlzaXQgZnJvbSAndW5pc3QtdXRpbC12aXNpdCc7CmV4cG9ydCBmdW5jdGlvbiBtYXJrZG93bkxpbmtWYWxpZGF0b3IoKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIChhc3QpIHsKICAgIHZpc2l0KGFzdCwgJ2xpbmsnLCBmdW5jdGlvbiAoX25vZGUpIHsKICAgICAgdmFyIG5vZGUgPSBfbm9kZTsKCiAgICAgIGlmICghdmFsaWRhdGVVcmwobm9kZS51cmwpKSB7CiAgICAgICAgbXV0YXRlTGlua1RvVGV4dChub2RlKTsKICAgICAgfQogICAgfSk7CiAgfTsKfQpleHBvcnQgZnVuY3Rpb24gbXV0YXRlTGlua1RvVGV4dChub2RlKSB7CiAgdmFyIF87CgogIG5vZGUudHlwZSA9ICd0ZXh0JzsKICBub2RlLnZhbHVlID0gIlsiLmNvbmNhdCgoKF8gPSBub2RlLmNoaWxkcmVuWzBdKSA9PT0gbnVsbCB8fCBfID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfLnZhbHVlKSB8fCAnJywgIl0oIikuY29uY2F0KG5vZGUudXJsLCAiKSIpOwogIGRlbGV0ZSBub2RlLmNoaWxkcmVuOwogIGRlbGV0ZSBub2RlLnRpdGxlOwogIGRlbGV0ZSBub2RlLnVybDsKICByZXR1cm4gbm9kZTsKfQpleHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVVcmwodXJsKSB7CiAgLy8gQSBsaW5rIGlzIHZhbGlkIGlmIGl0IHN0YXJ0cyB3aXRoIGh0dHA6LCBodHRwczosIG9yIC8KICByZXR1cm4gL14oaHR0cHM/OnxcLykvLnRlc3QodXJsKTsKfQoKdHJ5IHsKICBtdXRhdGVMaW5rVG9UZXh0Ll9fZG9jZ2VuSW5mbyA9IHsKICAgIGRlc2NyaXB0aW9uOiAnJywKICAgIGRpc3BsYXlOYW1lOiAnbXV0YXRlTGlua1RvVGV4dCcsCiAgICBtZXRob2RzOiBbXSwKICAgIHByb3BzOiB7CiAgICAgIHR5cGU6IHsKICAgICAgICBkZWZhdWx0VmFsdWU6IG51bGwsCiAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgIG5hbWU6ICd0eXBlJywKICAgICAgICBwYXJlbnQ6IHsKICAgICAgICAgIGZpbGVOYW1lOiAnZXVpL3NyYy9jb21wb25lbnRzL21hcmtkb3duX2VkaXRvci9wbHVnaW5zL21hcmtkb3duX2xpbmtfdmFsaWRhdG9yLnRzeCcsCiAgICAgICAgICBuYW1lOiAnTGlua09yVGV4dE5vZGUnCiAgICAgICAgfSwKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICB0eXBlOiB7CiAgICAgICAgICBuYW1lOiAnc3RyaW5nJwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXJsOiB7CiAgICAgICAgZGVmYXVsdFZhbHVlOiBudWxsLAogICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICBuYW1lOiAndXJsJywKICAgICAgICBwYXJlbnQ6IHsKICAgICAgICAgIGZpbGVOYW1lOiAnZXVpL3NyYy9jb21wb25lbnRzL21hcmtkb3duX2VkaXRvci9wbHVnaW5zL21hcmtkb3duX2xpbmtfdmFsaWRhdG9yLnRzeCcsCiAgICAgICAgICBuYW1lOiAnTGlua09yVGV4dE5vZGUnCiAgICAgICAgfSwKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogewogICAgICAgICAgbmFtZTogJ3N0cmluZycKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRpdGxlOiB7CiAgICAgICAgZGVmYXVsdFZhbHVlOiBudWxsLAogICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICBuYW1lOiAndGl0bGUnLAogICAgICAgIHBhcmVudDogewogICAgICAgICAgZmlsZU5hbWU6ICdldWkvc3JjL2NvbXBvbmVudHMvbWFya2Rvd25fZWRpdG9yL3BsdWdpbnMvbWFya2Rvd25fbGlua192YWxpZGF0b3IudHN4JywKICAgICAgICAgIG5hbWU6ICdMaW5rT3JUZXh0Tm9kZScKICAgICAgICB9LAogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB0eXBlOiB7CiAgICAgICAgICBuYW1lOiAnc3RyaW5nJwogICAgICAgIH0KICAgICAgfSwKICAgICAgdmFsdWU6IHsKICAgICAgICBkZWZhdWx0VmFsdWU6IG51bGwsCiAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgIG5hbWU6ICd2YWx1ZScsCiAgICAgICAgcGFyZW50OiB7CiAgICAgICAgICBmaWxlTmFtZTogJ2V1aS9zcmMvY29tcG9uZW50cy9tYXJrZG93bl9lZGl0b3IvcGx1Z2lucy9tYXJrZG93bl9saW5rX3ZhbGlkYXRvci50c3gnLAogICAgICAgICAgbmFtZTogJ0xpbmtPclRleHROb2RlJwogICAgICAgIH0sCiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgIHR5cGU6IHsKICAgICAgICAgIG5hbWU6ICdzdHJpbmcnCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZXh0ZW5kZWRJbnRlcmZhY2VzOiBbJ0xpbmtPclRleHROb2RlJywgJ1N0cmluZyddCiAgfTsKfSBjYXRjaCAoZSkge30KCnRyeSB7CiAgdmFsaWRhdGVVcmwuX19kb2NnZW5JbmZvID0gewogICAgZGVzY3JpcHRpb246ICcnLAogICAgZGlzcGxheU5hbWU6ICd2YWxpZGF0ZVVybCcsCiAgICBtZXRob2RzOiBbXSwKICAgIHByb3BzOiB7fSwKICAgIGV4dGVuZGVkSW50ZXJmYWNlczogWydMaW5rT3JUZXh0Tm9kZScsICdTdHJpbmcnXQogIH07Cn0gY2F0Y2ggKGUpIHt9"},{"version":3,"sources":["D:/work/eui/src/components/markdown_editor/plugins/markdown_link_validator.tsx"],"names":["visit","markdownLinkValidator","ast","_node","node","validateUrl","url","mutateLinkToText","type","value","children","title","test"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,KAAP,MAAkB,kBAAlB;AAUA,OAAO,SAASC,qBAAT,GAAiC;AACtC,SAAO,UAACC,GAAD,EAAc;AACnBF,IAAAA,KAAK,CAACE,GAAD,EAAM,MAAN,EAAc,UAACC,KAAD,EAAoB;AACrC,UAAMC,IAAI,GAAGD,KAAb;;AAEA,UAAI,CAACE,WAAW,CAACD,IAAI,CAACE,GAAN,CAAhB,EAA6B;AAC3BC,QAAAA,gBAAgB,CAACH,IAAD,CAAhB;AACD;AACF,KANI,CAAL;AAOD,GARD;AASD;AAED,OAAO,SAASG,gBAAT,CAA0BH,IAA1B,EAAgD;AAAA;;AACrDA,EAAAA,IAAI,CAACI,IAAL,GAAY,MAAZ;AACAJ,EAAAA,IAAI,CAACK,KAAL,cAAiB,MAAAL,IAAI,CAACM,QAAL,CAAe,CAAf,yCAAmBD,KAAnB,KAA4B,EAA7C,eAAoDL,IAAI,CAACE,GAAzD;AACA,SAAOF,IAAI,CAACM,QAAZ;AACA,SAAON,IAAI,CAACO,KAAZ;AACA,SAAOP,IAAI,CAACE,GAAZ;AACA,SAAOF,IAAP;AACD;AAED,OAAO,SAASC,WAAT,CAAqBC,GAArB,EAAkC;AACvC;AACA,SAAO,gBAAgBM,IAAhB,CAAqBN,GAArB,CAAP;AACD","sourcesContent":["/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport visit from 'unist-util-visit';\n\ninterface LinkOrTextNode {\n  type: string;\n  url?: string;\n  title?: string | null;\n  value?: string;\n  children?: Array<{ value: string }>;\n}\n\nexport function markdownLinkValidator() {\n  return (ast: any) => {\n    visit(ast, 'link', (_node: unknown) => {\n      const node = _node as LinkOrTextNode;\n\n      if (!validateUrl(node.url!)) {\n        mutateLinkToText(node);\n      }\n    });\n  };\n}\n\nexport function mutateLinkToText(node: LinkOrTextNode) {\n  node.type = 'text';\n  node.value = `[${node.children![0]?.value || ''}](${node.url})`;\n  delete node.children;\n  delete node.title;\n  delete node.url;\n  return node;\n}\n\nexport function validateUrl(url: string) {\n  // A link is valid if it starts with http:, https:, or /\n  return /^(https?:|\\/)/.test(url);\n}\n"]}]}