{"remainingRequest":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!D:\\work\\eui\\src\\components\\markdown_editor\\markdown_actions.ts","dependencies":[{"path":"D:\\work\\eui\\src\\components\\markdown_editor\\markdown_actions.ts","mtime":1649070093699},{"path":"D:\\work\\eui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636976621750},{"path":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js","mtime":1649070120649}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZXZlcnkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5lbmRzLXdpdGgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKLyoKICogTGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZSBvciBtb3JlIGNvbnRyaWJ1dG9yCiAqIGxpY2Vuc2UgYWdyZWVtZW50cy4gU2VlIHRoZSBOT1RJQ0UgZmlsZSBkaXN0cmlidXRlZCB3aXRoCiAqIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiByZWdhcmRpbmcgY29weXJpZ2h0CiAqIG93bmVyc2hpcC4gRWxhc3RpY3NlYXJjaCBCLlYuIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byB5b3UgdW5kZXIKICogdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkKICogbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICovCi8vIFRoZSB0ZXh0LWZvcm1hdHRpbmcgbG9naWMgJiBjb2RlIGluIHRoaXMgZmlsZSBjb21lIGZyb20KLy8gaHR0cHM6Ly9naXRodWIuY29tL2dpdGh1Yi9tYXJrZG93bi10b29sYmFyLWVsZW1lbnQvYmxvYi9tYWluL3NyYy9pbmRleC50cwovLyB1bmRlciB0aGUgZm9sbG93aW5nIE1JVCBsaWNlbnNlCgovKgpDb3B5cmlnaHQgKGMpIDIwMTctMjAxOCBHaXRIdWIsIEluYy4KClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwp0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwpmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsCmNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgpUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgpJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUKU09GVFdBUkUuCiAqLwppbXBvcnQgeyBpc1BsdWdpbldpdGhJbW1lZGlhdGVGb3JtYXR0aW5nIH0gZnJvbSAnLi9tYXJrZG93bl90eXBlcyc7Ci8qKgogKiBDbGFzcyBmb3IgYXBwbHlpbmcgc3R5bGVzIHRvIGEgdGV4dCBlZGl0b3IuIEFjY2VwdHMgdGhlIEhUTUwgSUQgZm9yIHRoZSB0ZXh0YXJlYQogKiBkZXNpcmVkLCBhbmQgZXhwb3NlcyB0aGUgYC5kbyhBQ1RJT04pYCBtZXRob2QgZm9yIG1hbmlwdWxhdGluZyB0aGUgdGV4dC4KICoKICogQGNsYXNzIE1hcmtkb3duQWN0aW9ucwogKiBAcGFyYW0ge3N0cmluZ30gZWRpdG9ySUQKICovCgp2YXIgTWFya2Rvd25BY3Rpb25zID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBNYXJrZG93bkFjdGlvbnMoZWRpdG9ySUQsIHVpUGx1Z2lucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1hcmtkb3duQWN0aW9ucyk7CgogICAgdGhpcy5lZGl0b3JJRCA9IGVkaXRvcklEOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic3R5bGVzIiwgdm9pZCAwKTsKCiAgICAvKioKICAgICAqIFRoaXMgb2JqZWN0IGlzIGluIHRoZSBmb3JtYXQ6CiAgICAgKiBbbmFtZU9mQWN0aW9uXToge1tzdHlsZXMgdG8gYXBwbHldfQogICAgICovCiAgICB0aGlzLnN0eWxlcyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdWlQbHVnaW5zLnJlZHVjZShmdW5jdGlvbiAobWFwcGVkUGx1Z2lucywgcGx1Z2luKSB7CiAgICAgIG1hcHBlZFBsdWdpbnNbcGx1Z2luLm5hbWVdID0gcGx1Z2luOwogICAgICByZXR1cm4gbWFwcGVkUGx1Z2luczsKICAgIH0sIHt9KSksIHt9LCB7CiAgICAgIG1kQm9sZDogewogICAgICAgIG5hbWU6ICdtZEJvbGQnLAogICAgICAgIGJ1dHRvbjogewogICAgICAgICAgbGFiZWw6ICcnLAogICAgICAgICAgaWNvblR5cGU6ICcnCiAgICAgICAgfSwKICAgICAgICBmb3JtYXR0aW5nOiB7CiAgICAgICAgICBwcmVmaXg6ICcqKicsCiAgICAgICAgICBzdWZmaXg6ICcqKicsCiAgICAgICAgICB0cmltRmlyc3Q6IHRydWUKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1kSXRhbGljOiB7CiAgICAgICAgbmFtZTogJ21kSXRhbGljJywKICAgICAgICBidXR0b246IHsKICAgICAgICAgIGxhYmVsOiAnJywKICAgICAgICAgIGljb25UeXBlOiAnJwogICAgICAgIH0sCiAgICAgICAgZm9ybWF0dGluZzogewogICAgICAgICAgcHJlZml4OiAnXycsCiAgICAgICAgICBzdWZmaXg6ICdfJywKICAgICAgICAgIHRyaW1GaXJzdDogdHJ1ZQogICAgICAgIH0KICAgICAgfSwKICAgICAgbWRRdW90ZTogewogICAgICAgIG5hbWU6ICdtZFF1b3RlJywKICAgICAgICBidXR0b246IHsKICAgICAgICAgIGxhYmVsOiAnJywKICAgICAgICAgIGljb25UeXBlOiAnJwogICAgICAgIH0sCiAgICAgICAgZm9ybWF0dGluZzogewogICAgICAgICAgcHJlZml4OiAnPiAnLAogICAgICAgICAgbXVsdGlsaW5lOiB0cnVlLAogICAgICAgICAgc3Vycm91bmRXaXRoTmV3bGluZXM6IHRydWUKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1kQ29kZTogewogICAgICAgIG5hbWU6ICdtZENvZGUnLAogICAgICAgIGJ1dHRvbjogewogICAgICAgICAgbGFiZWw6ICcnLAogICAgICAgICAgaWNvblR5cGU6ICcnCiAgICAgICAgfSwKICAgICAgICBmb3JtYXR0aW5nOiB7CiAgICAgICAgICBwcmVmaXg6ICdgJywKICAgICAgICAgIHN1ZmZpeDogJ2AnLAogICAgICAgICAgYmxvY2tQcmVmaXg6ICdgYGAnLAogICAgICAgICAgYmxvY2tTdWZmaXg6ICdgYGAnCiAgICAgICAgfQogICAgICB9LAogICAgICBtZExpbms6IHsKICAgICAgICBuYW1lOiAnbWRMaW5rJywKICAgICAgICBidXR0b246IHsKICAgICAgICAgIGxhYmVsOiAnJywKICAgICAgICAgIGljb25UeXBlOiAnJwogICAgICAgIH0sCiAgICAgICAgZm9ybWF0dGluZzogewogICAgICAgICAgcHJlZml4OiAnWycsCiAgICAgICAgICBzdWZmaXg6ICddKHVybCknLAogICAgICAgICAgcmVwbGFjZU5leHQ6ICd1cmwnLAogICAgICAgICAgc2NhbkZvcjogJ2h0dHBzPzovLycKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1kVWw6IHsKICAgICAgICBuYW1lOiAnbWRVbCcsCiAgICAgICAgYnV0dG9uOiB7CiAgICAgICAgICBsYWJlbDogJycsCiAgICAgICAgICBpY29uVHlwZTogJycKICAgICAgICB9LAogICAgICAgIGZvcm1hdHRpbmc6IHsKICAgICAgICAgIHByZWZpeDogJy0gJywKICAgICAgICAgIG11bHRpbGluZTogdHJ1ZSwKICAgICAgICAgIHN1cnJvdW5kV2l0aE5ld2xpbmVzOiB0cnVlCiAgICAgICAgfQogICAgICB9LAogICAgICBtZE9sOiB7CiAgICAgICAgbmFtZTogJ21kT2wnLAogICAgICAgIGJ1dHRvbjogewogICAgICAgICAgbGFiZWw6ICcnLAogICAgICAgICAgaWNvblR5cGU6ICcnCiAgICAgICAgfSwKICAgICAgICBmb3JtYXR0aW5nOiB7CiAgICAgICAgICBwcmVmaXg6ICcxLiAnLAogICAgICAgICAgbXVsdGlsaW5lOiB0cnVlLAogICAgICAgICAgb3JkZXJlZExpc3Q6IHRydWUKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1kVGw6IHsKICAgICAgICBuYW1lOiAnbWRUbCcsCiAgICAgICAgYnV0dG9uOiB7CiAgICAgICAgICBsYWJlbDogJycsCiAgICAgICAgICBpY29uVHlwZTogJycKICAgICAgICB9LAogICAgICAgIGZvcm1hdHRpbmc6IHsKICAgICAgICAgIHByZWZpeDogJy0gWyBdICcsCiAgICAgICAgICBtdWx0aWxpbmU6IHRydWUsCiAgICAgICAgICBzdXJyb3VuZFdpdGhOZXdsaW5lczogdHJ1ZQogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQogIC8qKgogICAqIC5kbygpIGFjY2VwdHMgYSBzdHJpbmcgYW5kIHJldHJpZXZlcyB0aGUgY29ycmVsYXRpbmcgc3R5bGUgb2JqZWN0IChkZWZpbmVkIGluIHRoZQogICAqIGNvbnN0cnVjdG9yKS4gSXQgcGFzc2VzIHRoaXMgdG8gYXBwbHlTdHlsZSgpIHRoYXQgZG9lcyB0aGUgdGV4dCBtYW5pcHVsYXRpb24uCiAgICoKICAgKiBAcGFyYW0ge3N0cmluZ30gcGx1Z2luTmFtZQogICAqIEBtZW1iZXJvZiBNYXJrZG93bkFjdGlvbnMKICAgKi8KCgogIF9jcmVhdGVDbGFzcyhNYXJrZG93bkFjdGlvbnMsIFt7CiAgICBrZXk6ICJkbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RvKHBsdWdpbk5hbWUpIHsKICAgICAgdmFyIHBsdWdpbiA9IHRoaXMuc3R5bGVzW3BsdWdpbk5hbWVdOwoKICAgICAgaWYgKGlzUGx1Z2luV2l0aEltbWVkaWF0ZUZvcm1hdHRpbmcocGx1Z2luKSkgewogICAgICAgIHRoaXMuYXBwbHlTdHlsZShwbHVnaW4uZm9ybWF0dGluZyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHBsdWdpbjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBkZWZhdWx0IHN0eWxpbmcgb2JqZWN0IGFuZCB0aGVuIHN1cGVyaW1wb3NlcyB0aGUgY2hhbmdlcyB0byBtYWtlIG9uIHRvcCBvZgogICAgICogaXQuIENhbGxzIHRoZSBgc3R5bGVTZWxlY3RlZFRleHRgIGhlbHBlciBmdW5jdGlvbiB0aGF0IGRvZXMgdGhlIGhlYXZ5IGxpZnRpbmcuCiAgICAgKiBBZGFwdGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2dpdGh1Yi9tYXJrZG93bi10b29sYmFyLWVsZW1lbnQvYmxvYi9tYWluL3NyYy9pbmRleC50cwogICAgICoKICAgICAqIEBwYXJhbSB7b2JqZWN0fSBpbmNvbWluZ1N0eWxlCiAgICAgKiBAbWVtYmVyb2YgTWFya2Rvd25BY3Rpb25zCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYXBwbHlTdHlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlTdHlsZShpbmNvbWluZ1N0eWxlKSB7CiAgICAgIHZhciBkZWZhdWx0cyA9IHsKICAgICAgICBwcmVmaXg6ICcnLAogICAgICAgIHN1ZmZpeDogJycsCiAgICAgICAgYmxvY2tQcmVmaXg6ICcnLAogICAgICAgIGJsb2NrU3VmZml4OiAnJywKICAgICAgICBtdWx0aWxpbmU6IGZhbHNlLAogICAgICAgIHJlcGxhY2VOZXh0OiAnJywKICAgICAgICBwcmVmaXhTcGFjZTogZmFsc2UsCiAgICAgICAgc2NhbkZvcjogJycsCiAgICAgICAgc3Vycm91bmRXaXRoTmV3bGluZXM6IGZhbHNlLAogICAgICAgIG9yZGVyZWRMaXN0OiBmYWxzZSwKICAgICAgICB0cmltRmlyc3Q6IGZhbHNlCiAgICAgIH07CgogICAgICB2YXIgb3V0Z29pbmdTdHlsZSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZGVmYXVsdHMpLCBpbmNvbWluZ1N0eWxlKTsKCiAgICAgIHZhciBlZGl0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVkaXRvcklEKTsKCiAgICAgIGlmIChlZGl0b3IpIHsKICAgICAgICBlZGl0b3IuZm9jdXMoKTsKICAgICAgICBzdHlsZVNlbGVjdGVkVGV4dChlZGl0b3IsIG91dGdvaW5nU3R5bGUpOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTWFya2Rvd25BY3Rpb25zOwp9KCk7Ci8qKgogKiBUaGUgZm9sbG93aW5nIGhlbHBlciBmdW5jdGlvbnMgYW5kIHR5cGVzIHdlcmUgY29waWVkIGZyb20gdGhlIEdpdEh1YiBNYXJrZG93biBUb29sYmFyCiAqIEVsZW1lbnQgcHJvamVjdC4gVGhlIHByb2plY3QgaXMgTUlULWxpY2Vuc2VkLiBTZWUgaXQgaGVyZToKICogaHR0cHM6Ly9naXRodWIuY29tL2dpdGh1Yi9tYXJrZG93bi10b29sYmFyLWVsZW1lbnQKICovCgoKZnVuY3Rpb24gaXNNdWx0aXBsZUxpbmVzKHN0cmluZykgewogIHJldHVybiBzdHJpbmcudHJpbSgpLnNwbGl0KCdcbicpLmxlbmd0aCA+IDE7Cn0KCmZ1bmN0aW9uIHJlcGVhdChzdHJpbmcsIG4pIHsKICByZXR1cm4gQXJyYXkobiArIDEpLmpvaW4oc3RyaW5nKTsKfQoKZnVuY3Rpb24gd29yZFNlbGVjdGlvblN0YXJ0KHRleHQsIGkpIHsKICB2YXIgaW5kZXggPSBpOwoKICB3aGlsZSAodGV4dFtpbmRleF0gJiYgdGV4dFtpbmRleCAtIDFdICE9IG51bGwgJiYgIXRleHRbaW5kZXggLSAxXS5tYXRjaCgvXHMvKSkgewogICAgaW5kZXgtLTsKICB9CgogIHJldHVybiBpbmRleDsKfQoKZnVuY3Rpb24gd29yZFNlbGVjdGlvbkVuZCh0ZXh0LCBpLCBtdWx0aWxpbmUpIHsKICB2YXIgaW5kZXggPSBpOwogIHZhciBicmVha3BvaW50ID0gbXVsdGlsaW5lID8gL1xuLyA6IC9ccy87CgogIHdoaWxlICh0ZXh0W2luZGV4XSAmJiAhdGV4dFtpbmRleF0ubWF0Y2goYnJlYWtwb2ludCkpIHsKICAgIGluZGV4Kys7CiAgfQoKICByZXR1cm4gaW5kZXg7Cn0KCnZhciBNQVhfVFJJRVMgPSAxMDsKdmFyIFRSWV9USU1FT1VUID0gMTA7Ci8qbXMqLwovLyBtb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9naXRodWIvbWFya2Rvd24tdG9vbGJhci1lbGVtZW50L2Jsb2IvbWFpbi9zcmMvaW5kZXgudHMKCmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRUZXh0KHRleHRhcmVhLCBfcmVmKSB7CiAgdmFyIHRleHQgPSBfcmVmLnRleHQsCiAgICAgIHNlbGVjdGlvblN0YXJ0ID0gX3JlZi5zZWxlY3Rpb25TdGFydCwKICAgICAgc2VsZWN0aW9uRW5kID0gX3JlZi5zZWxlY3Rpb25FbmQ7CiAgdmFyIG9yaWdpbmFsU2VsZWN0aW9uU3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDsKICB2YXIgYmVmb3JlID0gdGV4dGFyZWEudmFsdWUuc2xpY2UoMCwgb3JpZ2luYWxTZWxlY3Rpb25TdGFydCk7CiAgdmFyIGFmdGVyID0gdGV4dGFyZWEudmFsdWUuc2xpY2UodGV4dGFyZWEuc2VsZWN0aW9uRW5kKTsgLy8gY29uZmlndXJhdGlvbiBtb2RhbC9kaWFsb2cgd2lsbCBjb250aW51ZSBpbnRlcmNlcHRpbmcgZm9jdXMgaW4gU2FmYXJpCiAgLy8gbmVlZCB0byB3YWl0IHVudGlsIHRoZSB0ZXh0YXJlYSBjYW4gcmVjZWl2ZSBmb2N1cwoKICB2YXIgdHJpZXMgPSAwOwoKICB2YXIgaW5zZXJ0VGV4dCA9IGZ1bmN0aW9uIGluc2VydFRleHQoKSB7CiAgICB2YXIgaW5zZXJ0UmVzdWx0ID0gZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2luc2VydFRleHQnLCBmYWxzZSwgdGV4dCk7CgogICAgaWYgKGluc2VydFJlc3VsdCA9PT0gZmFsc2UpIHsKICAgICAgLyoqCiAgICAgICAqIEZhbGxiYWNrIGZvciBGaXJlZm94OyB0aGlzIGtpbGxzIHVuZG8vcmVkbyBidXQgYXQgbGVhc3QgdXBkYXRlcyB0aGUgdmFsdWUKICAgICAgICoKICAgICAgICogTm90ZSB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBuYXRpdmUgSFRNTFRleHRBcmVhRWxlbWVudC5zZXQoKSBtZXRob2QgdG8gcGxheSBuaWNlbHkgd2l0aAogICAgICAgKiBSZWFjdCdzIHN5bnRoZXRpYyBldmVudCBzeXN0ZW0uCiAgICAgICAqIGh0dHBzOi8vaHVzdGxlLmJpem9uZ28uaW4vc2ltdWxhdGUtcmVhY3Qtb24tY2hhbmdlLW9uLWNvbnRyb2xsZWQtY29tcG9uZW50cy1iYWEzMzY5MjBlMDQKICAgICAgICovCiAgICAgIHZhciBpbnB1dEV2ZW50ID0gbmV3IEV2ZW50KCdpbnB1dCcsIHsKICAgICAgICBidWJibGVzOiB0cnVlCiAgICAgIH0pOwogICAgICB2YXIgbmF0aXZlSW5wdXRWYWx1ZVNldHRlciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LkhUTUxUZXh0QXJlYUVsZW1lbnQucHJvdG90eXBlLCAndmFsdWUnKS5zZXQ7CiAgICAgIG5hdGl2ZUlucHV0VmFsdWVTZXR0ZXIuY2FsbCh0ZXh0YXJlYSwgYmVmb3JlICsgdGV4dCArIGFmdGVyKTsKICAgICAgdGV4dGFyZWEuZGlzcGF0Y2hFdmVudChpbnB1dEV2ZW50KTsKICAgIH0KCiAgICBpZiAoc2VsZWN0aW9uU3RhcnQgIT0gbnVsbCAmJiBzZWxlY3Rpb25FbmQgIT0gbnVsbCkgewogICAgICB0ZXh0YXJlYS5zZXRTZWxlY3Rpb25SYW5nZShzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uRW5kKTsKICAgIH0gZWxzZSB7CiAgICAgIHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKG9yaWdpbmFsU2VsZWN0aW9uU3RhcnQsIHRleHRhcmVhLnNlbGVjdGlvbkVuZCk7CiAgICB9CiAgfTsKCiAgdmFyIGZvY3VzVGV4dGFyZWEgPSBmdW5jdGlvbiBmb2N1c1RleHRhcmVhKCkgewogICAgdGV4dGFyZWEuZm9jdXMoKTsKCiAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGV4dGFyZWEpIHsKICAgICAgaW5zZXJ0VGV4dCgpOwogICAgfSBlbHNlIGlmICgrK3RyaWVzID09PSBNQVhfVFJJRVMpIHsKICAgICAgaW5zZXJ0VGV4dCgpOwogICAgfSBlbHNlIHsKICAgICAgc2V0VGltZW91dChmb2N1c1RleHRhcmVhLCBUUllfVElNRU9VVCk7CiAgICB9CiAgfTsKCiAgZm9jdXNUZXh0YXJlYSgpOwp9IC8vIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2dpdGh1Yi9tYXJrZG93bi10b29sYmFyLWVsZW1lbnQvYmxvYi9tYWluL3NyYy9pbmRleC50cwoKZnVuY3Rpb24gc3R5bGVTZWxlY3RlZFRleHQodGV4dGFyZWEsIHN0eWxlQXJncykgewogIHZhciB0ZXh0ID0gdGV4dGFyZWEudmFsdWUuc2xpY2UodGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQsIHRleHRhcmVhLnNlbGVjdGlvbkVuZCk7CiAgdmFyIHJlc3VsdDsKCiAgaWYgKHN0eWxlQXJncy5vcmRlcmVkTGlzdCkgewogICAgcmVzdWx0ID0gb3JkZXJlZExpc3QodGV4dGFyZWEpOwogIH0gZWxzZSBpZiAoc3R5bGVBcmdzLm11bHRpbGluZSAmJiBpc011bHRpcGxlTGluZXModGV4dCkpIHsKICAgIHJlc3VsdCA9IG11bHRpbGluZVN0eWxlKHRleHRhcmVhLCBzdHlsZUFyZ3MpOwogIH0gZWxzZSB7CiAgICByZXN1bHQgPSBibG9ja1N0eWxlKHRleHRhcmVhLCBzdHlsZUFyZ3MpOwogIH0KCiAgaW5zZXJ0VGV4dCh0ZXh0YXJlYSwgcmVzdWx0KTsKfQoKZnVuY3Rpb24gZXhwYW5kU2VsZWN0ZWRUZXh0KHRleHRhcmVhLCBwcmVmaXhUb1VzZSwgc3VmZml4VG9Vc2UpIHsKICB2YXIgbXVsdGlsaW5lID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKCiAgaWYgKHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ID09PSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQpIHsKICAgIHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ID0gd29yZFNlbGVjdGlvblN0YXJ0KHRleHRhcmVhLnZhbHVlLCB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCk7CiAgICB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPSB3b3JkU2VsZWN0aW9uRW5kKHRleHRhcmVhLnZhbHVlLCB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQsIG11bHRpbGluZSk7CiAgfSBlbHNlIHsKICAgIHZhciBleHBhbmRlZFNlbGVjdGlvblN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgLSBwcmVmaXhUb1VzZS5sZW5ndGg7CiAgICB2YXIgZXhwYW5kZWRTZWxlY3Rpb25FbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQgKyBzdWZmaXhUb1VzZS5sZW5ndGg7CiAgICB2YXIgYmVnaW5zV2l0aFByZWZpeCA9IHRleHRhcmVhLnZhbHVlLnNsaWNlKGV4cGFuZGVkU2VsZWN0aW9uU3RhcnQsIHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0KSA9PT0gcHJlZml4VG9Vc2U7CiAgICB2YXIgZW5kc1dpdGhTdWZmaXggPSB0ZXh0YXJlYS52YWx1ZS5zbGljZSh0ZXh0YXJlYS5zZWxlY3Rpb25FbmQsIGV4cGFuZGVkU2VsZWN0aW9uRW5kKSA9PT0gc3VmZml4VG9Vc2U7CgogICAgaWYgKGJlZ2luc1dpdGhQcmVmaXggJiYgZW5kc1dpdGhTdWZmaXgpIHsKICAgICAgdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgPSBleHBhbmRlZFNlbGVjdGlvblN0YXJ0OwogICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPSBleHBhbmRlZFNlbGVjdGlvbkVuZDsKICAgIH0KICB9CgogIHJldHVybiB0ZXh0YXJlYS52YWx1ZS5zbGljZSh0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCwgdGV4dGFyZWEuc2VsZWN0aW9uRW5kKTsKfQoKZnVuY3Rpb24gbmV3bGluZXNUb1N1cnJvdW5kU2VsZWN0ZWRUZXh0KHRleHRhcmVhKSB7CiAgdmFyIGJlZm9yZVNlbGVjdGlvbiA9IHRleHRhcmVhLnZhbHVlLnNsaWNlKDAsIHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0KTsKICB2YXIgYWZ0ZXJTZWxlY3Rpb24gPSB0ZXh0YXJlYS52YWx1ZS5zbGljZSh0ZXh0YXJlYS5zZWxlY3Rpb25FbmQpOwogIHZhciBicmVha3NCZWZvcmUgPSBiZWZvcmVTZWxlY3Rpb24ubWF0Y2goL1xuKiQvKTsKICB2YXIgYnJlYWtzQWZ0ZXIgPSBhZnRlclNlbGVjdGlvbi5tYXRjaCgvXlxuKi8pOwogIHZhciBuZXdsaW5lc0JlZm9yZVNlbGVjdGlvbiA9IGJyZWFrc0JlZm9yZSA/IGJyZWFrc0JlZm9yZVswXS5sZW5ndGggOiAwOwogIHZhciBuZXdsaW5lc0FmdGVyU2VsZWN0aW9uID0gYnJlYWtzQWZ0ZXIgPyBicmVha3NBZnRlclswXS5sZW5ndGggOiAwOwogIHZhciBuZXdsaW5lc1RvQXBwZW5kOwogIHZhciBuZXdsaW5lc1RvUHJlcGVuZDsKCiAgaWYgKGJlZm9yZVNlbGVjdGlvbi5tYXRjaCgvXFMvKSAmJiBuZXdsaW5lc0JlZm9yZVNlbGVjdGlvbiA8IDIpIHsKICAgIG5ld2xpbmVzVG9BcHBlbmQgPSByZXBlYXQoJ1xuJywgMiAtIG5ld2xpbmVzQmVmb3JlU2VsZWN0aW9uKTsKICB9CgogIGlmIChhZnRlclNlbGVjdGlvbi5tYXRjaCgvXFMvKSAmJiBuZXdsaW5lc0FmdGVyU2VsZWN0aW9uIDwgMikgewogICAgbmV3bGluZXNUb1ByZXBlbmQgPSByZXBlYXQoJ1xuJywgMiAtIG5ld2xpbmVzQWZ0ZXJTZWxlY3Rpb24pOwogIH0KCiAgaWYgKG5ld2xpbmVzVG9BcHBlbmQgPT0gbnVsbCkgewogICAgbmV3bGluZXNUb0FwcGVuZCA9ICcnOwogIH0KCiAgaWYgKG5ld2xpbmVzVG9QcmVwZW5kID09IG51bGwpIHsKICAgIG5ld2xpbmVzVG9QcmVwZW5kID0gJyc7CiAgfQoKICByZXR1cm4gewogICAgbmV3bGluZXNUb0FwcGVuZDogbmV3bGluZXNUb0FwcGVuZCwKICAgIG5ld2xpbmVzVG9QcmVwZW5kOiBuZXdsaW5lc1RvUHJlcGVuZAogIH07Cn0KCmZ1bmN0aW9uIGJsb2NrU3R5bGUodGV4dGFyZWEsIGFyZykgewogIHZhciBuZXdsaW5lc1RvQXBwZW5kOwogIHZhciBuZXdsaW5lc1RvUHJlcGVuZDsKICB2YXIgcHJlZml4ID0gYXJnLnByZWZpeCwKICAgICAgc3VmZml4ID0gYXJnLnN1ZmZpeCwKICAgICAgYmxvY2tQcmVmaXggPSBhcmcuYmxvY2tQcmVmaXgsCiAgICAgIGJsb2NrU3VmZml4ID0gYXJnLmJsb2NrU3VmZml4LAogICAgICByZXBsYWNlTmV4dCA9IGFyZy5yZXBsYWNlTmV4dCwKICAgICAgcHJlZml4U3BhY2UgPSBhcmcucHJlZml4U3BhY2UsCiAgICAgIHNjYW5Gb3IgPSBhcmcuc2NhbkZvciwKICAgICAgc3Vycm91bmRXaXRoTmV3bGluZXMgPSBhcmcuc3Vycm91bmRXaXRoTmV3bGluZXM7CiAgdmFyIG9yaWdpbmFsU2VsZWN0aW9uU3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDsKICB2YXIgb3JpZ2luYWxTZWxlY3Rpb25FbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7CiAgdmFyIHNlbGVjdGVkVGV4dCA9IHRleHRhcmVhLnZhbHVlLnNsaWNlKHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0LCB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQpOwogIHZhciBwcmVmaXhUb1VzZSA9IGlzTXVsdGlwbGVMaW5lcyhzZWxlY3RlZFRleHQpICYmIGJsb2NrUHJlZml4Lmxlbmd0aCA+IDAgPyAiIi5jb25jYXQoYmxvY2tQcmVmaXgsICJcbiIpIDogcHJlZml4OwogIHZhciBzdWZmaXhUb1VzZSA9IGlzTXVsdGlwbGVMaW5lcyhzZWxlY3RlZFRleHQpICYmIGJsb2NrU3VmZml4Lmxlbmd0aCA+IDAgPyAiXG4iLmNvbmNhdChibG9ja1N1ZmZpeCkgOiBzdWZmaXg7CgogIGlmIChwcmVmaXhTcGFjZSkgewogICAgdmFyIGJlZm9yZVNlbGVjdGlvbiA9IHRleHRhcmVhLnZhbHVlW3RleHRhcmVhLnNlbGVjdGlvblN0YXJ0IC0gMV07CgogICAgaWYgKHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ICE9PSAwICYmIGJlZm9yZVNlbGVjdGlvbiAhPSBudWxsICYmICFiZWZvcmVTZWxlY3Rpb24ubWF0Y2goL1xzLykpIHsKICAgICAgcHJlZml4VG9Vc2UgPSAiICIuY29uY2F0KHByZWZpeFRvVXNlKTsKICAgIH0KICB9CgogIHNlbGVjdGVkVGV4dCA9IGV4cGFuZFNlbGVjdGVkVGV4dCh0ZXh0YXJlYSwgcHJlZml4VG9Vc2UsIHN1ZmZpeFRvVXNlLCBhcmcubXVsdGlsaW5lKTsKICB2YXIgc2VsZWN0aW9uU3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDsKICB2YXIgc2VsZWN0aW9uRW5kID0gdGV4dGFyZWEuc2VsZWN0aW9uRW5kOwogIHZhciBoYXNSZXBsYWNlTmV4dCA9IHJlcGxhY2VOZXh0Lmxlbmd0aCA+IDAgJiYgc3VmZml4VG9Vc2UuaW5kZXhPZihyZXBsYWNlTmV4dCkgPiAtMSAmJiBzZWxlY3RlZFRleHQubGVuZ3RoID4gMDsKCiAgaWYgKHN1cnJvdW5kV2l0aE5ld2xpbmVzKSB7CiAgICB2YXIgcmVmID0gbmV3bGluZXNUb1N1cnJvdW5kU2VsZWN0ZWRUZXh0KHRleHRhcmVhKTsKICAgIG5ld2xpbmVzVG9BcHBlbmQgPSByZWYubmV3bGluZXNUb0FwcGVuZDsKICAgIG5ld2xpbmVzVG9QcmVwZW5kID0gcmVmLm5ld2xpbmVzVG9QcmVwZW5kOwogICAgcHJlZml4VG9Vc2UgPSBuZXdsaW5lc1RvQXBwZW5kICsgcHJlZml4OwogICAgc3VmZml4VG9Vc2UgKz0gbmV3bGluZXNUb1ByZXBlbmQ7CiAgfQoKICBpZiAoc2VsZWN0ZWRUZXh0LnN0YXJ0c1dpdGgocHJlZml4VG9Vc2UpICYmIHNlbGVjdGVkVGV4dC5lbmRzV2l0aChzdWZmaXhUb1VzZSkpIHsKICAgIHZhciByZXBsYWNlbWVudFRleHQgPSBzZWxlY3RlZFRleHQuc2xpY2UocHJlZml4VG9Vc2UubGVuZ3RoLCBzZWxlY3RlZFRleHQubGVuZ3RoIC0gc3VmZml4VG9Vc2UubGVuZ3RoKTsKCiAgICBpZiAob3JpZ2luYWxTZWxlY3Rpb25TdGFydCA9PT0gb3JpZ2luYWxTZWxlY3Rpb25FbmQpIHsKICAgICAgdmFyIHBvc2l0aW9uID0gb3JpZ2luYWxTZWxlY3Rpb25TdGFydCAtIHByZWZpeFRvVXNlLmxlbmd0aDsKICAgICAgcG9zaXRpb24gPSBNYXRoLm1heChwb3NpdGlvbiwgc2VsZWN0aW9uU3RhcnQpOwogICAgICBwb3NpdGlvbiA9IE1hdGgubWluKHBvc2l0aW9uLCBzZWxlY3Rpb25TdGFydCArIHJlcGxhY2VtZW50VGV4dC5sZW5ndGgpOwogICAgICBzZWxlY3Rpb25TdGFydCA9IHNlbGVjdGlvbkVuZCA9IHBvc2l0aW9uOwogICAgfSBlbHNlIHsKICAgICAgc2VsZWN0aW9uRW5kID0gc2VsZWN0aW9uU3RhcnQgKyByZXBsYWNlbWVudFRleHQubGVuZ3RoOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHRleHQ6IHJlcGxhY2VtZW50VGV4dCwKICAgICAgc2VsZWN0aW9uU3RhcnQ6IHNlbGVjdGlvblN0YXJ0LAogICAgICBzZWxlY3Rpb25FbmQ6IHNlbGVjdGlvbkVuZAogICAgfTsKICB9IGVsc2UgaWYgKCFoYXNSZXBsYWNlTmV4dCkgewogICAgdmFyIF9yZXBsYWNlbWVudFRleHQgPSBwcmVmaXhUb1VzZSArIHNlbGVjdGVkVGV4dCArIHN1ZmZpeFRvVXNlOwoKICAgIHNlbGVjdGlvblN0YXJ0ID0gb3JpZ2luYWxTZWxlY3Rpb25TdGFydCArIHByZWZpeFRvVXNlLmxlbmd0aDsKICAgIHNlbGVjdGlvbkVuZCA9IG9yaWdpbmFsU2VsZWN0aW9uRW5kICsgcHJlZml4VG9Vc2UubGVuZ3RoOwogICAgdmFyIHdoaXRlc3BhY2VFZGdlcyA9IHNlbGVjdGVkVGV4dC5tYXRjaCgvXlxzKnxccyokL2cpOwoKICAgIGlmIChhcmcudHJpbUZpcnN0ICYmIHdoaXRlc3BhY2VFZGdlcykgewogICAgICB2YXIgbGVhZGluZ1doaXRlc3BhY2UgPSB3aGl0ZXNwYWNlRWRnZXNbMF0gfHwgJyc7CiAgICAgIHZhciB0cmFpbGluZ1doaXRlc3BhY2UgPSB3aGl0ZXNwYWNlRWRnZXNbMV0gfHwgJyc7CiAgICAgIF9yZXBsYWNlbWVudFRleHQgPSBsZWFkaW5nV2hpdGVzcGFjZSArIHByZWZpeFRvVXNlICsgc2VsZWN0ZWRUZXh0LnRyaW0oKSArIHN1ZmZpeFRvVXNlICsgdHJhaWxpbmdXaGl0ZXNwYWNlOwogICAgICBzZWxlY3Rpb25TdGFydCArPSBsZWFkaW5nV2hpdGVzcGFjZS5sZW5ndGg7CiAgICAgIHNlbGVjdGlvbkVuZCAtPSB0cmFpbGluZ1doaXRlc3BhY2UubGVuZ3RoOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHRleHQ6IF9yZXBsYWNlbWVudFRleHQsCiAgICAgIHNlbGVjdGlvblN0YXJ0OiBzZWxlY3Rpb25TdGFydCwKICAgICAgc2VsZWN0aW9uRW5kOiBzZWxlY3Rpb25FbmQKICAgIH07CiAgfSBlbHNlIGlmIChzY2FuRm9yLmxlbmd0aCA+IDAgJiYgc2VsZWN0ZWRUZXh0Lm1hdGNoKHNjYW5Gb3IpKSB7CiAgICBzdWZmaXhUb1VzZSA9IHN1ZmZpeFRvVXNlLnJlcGxhY2UocmVwbGFjZU5leHQsIHNlbGVjdGVkVGV4dCk7CgogICAgdmFyIF9yZXBsYWNlbWVudFRleHQyID0gcHJlZml4VG9Vc2UgKyBzdWZmaXhUb1VzZTsKCiAgICBzZWxlY3Rpb25TdGFydCA9IHNlbGVjdGlvbkVuZCA9IHNlbGVjdGlvblN0YXJ0ICsgcHJlZml4VG9Vc2UubGVuZ3RoOwogICAgcmV0dXJuIHsKICAgICAgdGV4dDogX3JlcGxhY2VtZW50VGV4dDIsCiAgICAgIHNlbGVjdGlvblN0YXJ0OiBzZWxlY3Rpb25TdGFydCwKICAgICAgc2VsZWN0aW9uRW5kOiBzZWxlY3Rpb25FbmQKICAgIH07CiAgfSBlbHNlIHsKICAgIHZhciBfcmVwbGFjZW1lbnRUZXh0MyA9IHByZWZpeFRvVXNlICsgc2VsZWN0ZWRUZXh0ICsgc3VmZml4VG9Vc2U7CgogICAgc2VsZWN0aW9uU3RhcnQgPSBzZWxlY3Rpb25TdGFydCArIHByZWZpeFRvVXNlLmxlbmd0aCArIHNlbGVjdGVkVGV4dC5sZW5ndGggKyBzdWZmaXhUb1VzZS5pbmRleE9mKHJlcGxhY2VOZXh0KTsKICAgIHNlbGVjdGlvbkVuZCA9IHNlbGVjdGlvblN0YXJ0ICsgcmVwbGFjZU5leHQubGVuZ3RoOwogICAgcmV0dXJuIHsKICAgICAgdGV4dDogX3JlcGxhY2VtZW50VGV4dDMsCiAgICAgIHNlbGVjdGlvblN0YXJ0OiBzZWxlY3Rpb25TdGFydCwKICAgICAgc2VsZWN0aW9uRW5kOiBzZWxlY3Rpb25FbmQKICAgIH07CiAgfQp9CgpmdW5jdGlvbiBtdWx0aWxpbmVTdHlsZSh0ZXh0YXJlYSwgYXJnKSB7CiAgdmFyIHByZWZpeCA9IGFyZy5wcmVmaXgsCiAgICAgIHN1ZmZpeCA9IGFyZy5zdWZmaXgsCiAgICAgIHN1cnJvdW5kV2l0aE5ld2xpbmVzID0gYXJnLnN1cnJvdW5kV2l0aE5ld2xpbmVzOwogIHZhciB0ZXh0ID0gdGV4dGFyZWEudmFsdWUuc2xpY2UodGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQsIHRleHRhcmVhLnNlbGVjdGlvbkVuZCk7CiAgdmFyIHNlbGVjdGlvblN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7CiAgdmFyIHNlbGVjdGlvbkVuZCA9IHRleHRhcmVhLnNlbGVjdGlvbkVuZDsKICB2YXIgbGluZXMgPSB0ZXh0LnNwbGl0KCdcbicpOwogIHZhciB1bmRvU3R5bGUgPSBsaW5lcy5ldmVyeShmdW5jdGlvbiAobGluZSkgewogICAgcmV0dXJuIGxpbmUuc3RhcnRzV2l0aChwcmVmaXgpICYmIGxpbmUuZW5kc1dpdGgoc3VmZml4KTsKICB9KTsKCiAgaWYgKHVuZG9TdHlsZSkgewogICAgdGV4dCA9IGxpbmVzLm1hcChmdW5jdGlvbiAobGluZSkgewogICAgICByZXR1cm4gbGluZS5zbGljZShwcmVmaXgubGVuZ3RoLCBsaW5lLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGgpOwogICAgfSkuam9pbignXG4nKTsKICAgIHNlbGVjdGlvbkVuZCA9IHNlbGVjdGlvblN0YXJ0ICsgdGV4dC5sZW5ndGg7CiAgfSBlbHNlIHsKICAgIHRleHQgPSBsaW5lcy5tYXAoZnVuY3Rpb24gKGxpbmUpIHsKICAgICAgcmV0dXJuIHByZWZpeCArIGxpbmUgKyBzdWZmaXg7CiAgICB9KS5qb2luKCdcbicpOwoKICAgIGlmIChzdXJyb3VuZFdpdGhOZXdsaW5lcykgewogICAgICB2YXIgX25ld2xpbmVzVG9TdXJyb3VuZFNlID0gbmV3bGluZXNUb1N1cnJvdW5kU2VsZWN0ZWRUZXh0KHRleHRhcmVhKSwKICAgICAgICAgIG5ld2xpbmVzVG9BcHBlbmQgPSBfbmV3bGluZXNUb1N1cnJvdW5kU2UubmV3bGluZXNUb0FwcGVuZCwKICAgICAgICAgIG5ld2xpbmVzVG9QcmVwZW5kID0gX25ld2xpbmVzVG9TdXJyb3VuZFNlLm5ld2xpbmVzVG9QcmVwZW5kOwoKICAgICAgc2VsZWN0aW9uU3RhcnQgKz0gbmV3bGluZXNUb0FwcGVuZC5sZW5ndGg7CiAgICAgIHNlbGVjdGlvbkVuZCA9IHNlbGVjdGlvblN0YXJ0ICsgdGV4dC5sZW5ndGg7CiAgICAgIHRleHQgPSBuZXdsaW5lc1RvQXBwZW5kICsgdGV4dCArIG5ld2xpbmVzVG9QcmVwZW5kOwogICAgfQogIH0KCiAgcmV0dXJuIHsKICAgIHRleHQ6IHRleHQsCiAgICBzZWxlY3Rpb25TdGFydDogc2VsZWN0aW9uU3RhcnQsCiAgICBzZWxlY3Rpb25FbmQ6IHNlbGVjdGlvbkVuZAogIH07Cn0KCmZ1bmN0aW9uIG9yZGVyZWRMaXN0KHRleHRhcmVhKSB7CiAgdmFyIG9yZGVyZWRMaXN0UmVnZXggPSAvXlxkK1wuXHMrLzsKICB2YXIgbm9Jbml0aWFsU2VsZWN0aW9uID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgPT09IHRleHRhcmVhLnNlbGVjdGlvbkVuZDsKICB2YXIgc2VsZWN0aW9uRW5kOwogIHZhciBzZWxlY3Rpb25TdGFydDsKICB2YXIgdGV4dCA9IHRleHRhcmVhLnZhbHVlLnNsaWNlKHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0LCB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQpOwogIHZhciB0ZXh0VG9VbnN0eWxlID0gdGV4dDsKICB2YXIgbGluZXMgPSB0ZXh0LnNwbGl0KCdcbicpOwogIHZhciBzdGFydE9mTGluZTsKICB2YXIgZW5kT2ZMaW5lOwoKICBpZiAobm9Jbml0aWFsU2VsZWN0aW9uKSB7CiAgICB2YXIgbGluZXNCZWZvcmUgPSB0ZXh0YXJlYS52YWx1ZS5zbGljZSgwLCB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCkuc3BsaXQoL1xuLyk7CiAgICBzdGFydE9mTGluZSA9IHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0IC0gbGluZXNCZWZvcmVbbGluZXNCZWZvcmUubGVuZ3RoIC0gMV0ubGVuZ3RoOwogICAgZW5kT2ZMaW5lID0gd29yZFNlbGVjdGlvbkVuZCh0ZXh0YXJlYS52YWx1ZSwgdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQsIHRydWUpOwogICAgdGV4dFRvVW5zdHlsZSA9IHRleHRhcmVhLnZhbHVlLnNsaWNlKHN0YXJ0T2ZMaW5lLCBlbmRPZkxpbmUpOwogIH0KCiAgdmFyIGxpbmVzVG9VbnN0eWxlID0gdGV4dFRvVW5zdHlsZS5zcGxpdCgnXG4nKTsKICB2YXIgdW5kb1N0eWxpbmcgPSBsaW5lc1RvVW5zdHlsZS5ldmVyeShmdW5jdGlvbiAobGluZSkgewogICAgcmV0dXJuIG9yZGVyZWRMaXN0UmVnZXgudGVzdChsaW5lKTsKICB9KTsKCiAgaWYgKHVuZG9TdHlsaW5nKSB7CiAgICBsaW5lcyA9IGxpbmVzVG9VbnN0eWxlLm1hcChmdW5jdGlvbiAobGluZSkgewogICAgICByZXR1cm4gbGluZS5yZXBsYWNlKG9yZGVyZWRMaXN0UmVnZXgsICcnKTsKICAgIH0pOwogICAgdGV4dCA9IGxpbmVzLmpvaW4oJ1xuJyk7CgogICAgaWYgKG5vSW5pdGlhbFNlbGVjdGlvbiAmJiBzdGFydE9mTGluZSAmJiBlbmRPZkxpbmUpIHsKICAgICAgdmFyIGxlbmd0aERpZmYgPSBsaW5lc1RvVW5zdHlsZVswXS5sZW5ndGggLSBsaW5lc1swXS5sZW5ndGg7CiAgICAgIHNlbGVjdGlvblN0YXJ0ID0gc2VsZWN0aW9uRW5kID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgLSBsZW5ndGhEaWZmOwogICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCA9IHN0YXJ0T2ZMaW5lOwogICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPSBlbmRPZkxpbmU7CiAgICB9CiAgfSBlbHNlIHsKICAgIGxpbmVzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgaTsKICAgICAgdmFyIGxlbjsKICAgICAgdmFyIGluZGV4OwogICAgICB2YXIgcmVzdWx0cyA9IFtdOwoKICAgICAgZm9yIChpbmRleCA9IGkgPSAwLCBsZW4gPSBsaW5lcy5sZW5ndGg7IGkgPCBsZW47IGluZGV4ID0gKytpKSB7CiAgICAgICAgdmFyIGxpbmUgPSBsaW5lc1tpbmRleF07CiAgICAgICAgcmVzdWx0cy5wdXNoKCIiLmNvbmNhdChpbmRleCArIDEsICIuICIpLmNvbmNhdChsaW5lKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHRzOwogICAgfSgpOwoKICAgIHRleHQgPSBsaW5lcy5qb2luKCdcbicpOwoKICAgIHZhciBfbmV3bGluZXNUb1N1cnJvdW5kU2UyID0gbmV3bGluZXNUb1N1cnJvdW5kU2VsZWN0ZWRUZXh0KHRleHRhcmVhKSwKICAgICAgICBuZXdsaW5lc1RvQXBwZW5kID0gX25ld2xpbmVzVG9TdXJyb3VuZFNlMi5uZXdsaW5lc1RvQXBwZW5kLAogICAgICAgIG5ld2xpbmVzVG9QcmVwZW5kID0gX25ld2xpbmVzVG9TdXJyb3VuZFNlMi5uZXdsaW5lc1RvUHJlcGVuZDsKCiAgICBzZWxlY3Rpb25TdGFydCA9IHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ICsgbmV3bGluZXNUb0FwcGVuZC5sZW5ndGg7CiAgICBzZWxlY3Rpb25FbmQgPSBzZWxlY3Rpb25TdGFydCArIHRleHQubGVuZ3RoOwogICAgaWYgKG5vSW5pdGlhbFNlbGVjdGlvbikgc2VsZWN0aW9uU3RhcnQgPSBzZWxlY3Rpb25FbmQ7CiAgICB0ZXh0ID0gbmV3bGluZXNUb0FwcGVuZCArIHRleHQgKyBuZXdsaW5lc1RvUHJlcGVuZDsKICB9CgogIHJldHVybiB7CiAgICB0ZXh0OiB0ZXh0LAogICAgc2VsZWN0aW9uU3RhcnQ6IHNlbGVjdGlvblN0YXJ0LAogICAgc2VsZWN0aW9uRW5kOiBzZWxlY3Rpb25FbmQKICB9Owp9CgpleHBvcnQgZGVmYXVsdCBNYXJrZG93bkFjdGlvbnM7Cgp0cnkgewogIE1hcmtkb3duQWN0aW9ucy5fX2RvY2dlbkluZm8gPSB7CiAgICBkZXNjcmlwdGlvbjogJ0NsYXNzIGZvciBhcHBseWluZyBzdHlsZXMgdG8gYSB0ZXh0IGVkaXRvci4gQWNjZXB0cyB0aGUgSFRNTCBJRCBmb3IgdGhlIHRleHRhcmVhXG4nICsgJ2Rlc2lyZWQsIGFuZCBleHBvc2VzIHRoZSBgLmRvKEFDVElPTilgIG1ldGhvZCBmb3IgbWFuaXB1bGF0aW5nIHRoZSB0ZXh0LicsCiAgICBkaXNwbGF5TmFtZTogJ01hcmtkb3duQWN0aW9ucycsCiAgICBtZXRob2RzOiBbXSwKICAgIHByb3BzOiB7fSwKICAgIGV4dGVuZGVkSW50ZXJmYWNlczogW10KICB9Owp9IGNhdGNoIChlKSB7fQ=="},{"version":3,"sources":["D:/work/eui/src/components/markdown_editor/markdown_actions.ts"],"names":["isPluginWithImmediateFormatting","MarkdownActions","editorID","uiPlugins","styles","reduce","mappedPlugins","plugin","name","mdBold","button","label","iconType","formatting","prefix","suffix","trimFirst","mdItalic","mdQuote","multiline","surroundWithNewlines","mdCode","blockPrefix","blockSuffix","mdLink","replaceNext","scanFor","mdUl","mdOl","orderedList","mdTl","pluginName","applyStyle","incomingStyle","defaults","prefixSpace","outgoingStyle","editor","document","getElementById","focus","styleSelectedText","isMultipleLines","string","trim","split","length","repeat","n","Array","join","wordSelectionStart","text","i","index","match","wordSelectionEnd","breakpoint","MAX_TRIES","TRY_TIMEOUT","insertText","textarea","selectionStart","selectionEnd","originalSelectionStart","before","value","slice","after","tries","insertResult","execCommand","inputEvent","Event","bubbles","nativeInputValueSetter","Object","getOwnPropertyDescriptor","window","HTMLTextAreaElement","prototype","set","call","dispatchEvent","setSelectionRange","focusTextarea","activeElement","setTimeout","styleArgs","result","multilineStyle","blockStyle","expandSelectedText","prefixToUse","suffixToUse","expandedSelectionStart","expandedSelectionEnd","beginsWithPrefix","endsWithSuffix","newlinesToSurroundSelectedText","beforeSelection","afterSelection","breaksBefore","breaksAfter","newlinesBeforeSelection","newlinesAfterSelection","newlinesToAppend","newlinesToPrepend","arg","originalSelectionEnd","selectedText","hasReplaceNext","indexOf","ref","startsWith","endsWith","replacementText","position","Math","max","min","whitespaceEdges","leadingWhitespace","trailingWhitespace","replace","lines","undoStyle","every","line","map","orderedListRegex","noInitialSelection","textToUnstyle","startOfLine","endOfLine","linesBefore","linesToUnstyle","undoStyling","test","lengthDiff","len","results","push"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAGEA,+BAHF,QAIO,kBAJP;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;;IACMC,e;AAGJ,2BAAmBC,QAAnB,EAAqCC,SAArC,EAA6E;AAAA;;AAAA,SAA1DD,QAA0D,GAA1DA,QAA0D;;AAAA;;AAC3E;AACJ;AACA;AACA;AACI,SAAKE,MAAL,mCACKD,SAAS,CAACE,MAAV,CACD,UAACC,aAAD,EAAgBC,MAAhB,EAA2B;AACzBD,MAAAA,aAAa,CAACC,MAAM,CAACC,IAAR,CAAb,GAA6BD,MAA7B;AACA,aAAOD,aAAP;AACD,KAJA,EAKD,EALC,CADL;AAQEG,MAAAA,MAAM,EAAE;AACND,QAAAA,IAAI,EAAE,QADA;AAENE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFF;AAGNC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,IADE;AAEVC,UAAAA,MAAM,EAAE,IAFE;AAGVC,UAAAA,SAAS,EAAE;AAHD;AAHN,OARV;AAiBEC,MAAAA,QAAQ,EAAE;AACRT,QAAAA,IAAI,EAAE,UADE;AAERE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFA;AAGRC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,GADE;AAEVC,UAAAA,MAAM,EAAE,GAFE;AAGVC,UAAAA,SAAS,EAAE;AAHD;AAHJ,OAjBZ;AA0BEE,MAAAA,OAAO,EAAE;AACPV,QAAAA,IAAI,EAAE,SADC;AAEPE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFD;AAGPC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,IADE;AAEVK,UAAAA,SAAS,EAAE,IAFD;AAGVC,UAAAA,oBAAoB,EAAE;AAHZ;AAHL,OA1BX;AAmCEC,MAAAA,MAAM,EAAE;AACNb,QAAAA,IAAI,EAAE,QADA;AAENE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFF;AAGNC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,GADE;AAEVC,UAAAA,MAAM,EAAE,GAFE;AAGVO,UAAAA,WAAW,EAAE,KAHH;AAIVC,UAAAA,WAAW,EAAE;AAJH;AAHN,OAnCV;AA6CEC,MAAAA,MAAM,EAAE;AACNhB,QAAAA,IAAI,EAAE,QADA;AAENE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFF;AAGNC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,GADE;AAEVC,UAAAA,MAAM,EAAE,QAFE;AAGVU,UAAAA,WAAW,EAAE,KAHH;AAIVC,UAAAA,OAAO,EAAE;AAJC;AAHN,OA7CV;AAuDEC,MAAAA,IAAI,EAAE;AACJnB,QAAAA,IAAI,EAAE,MADF;AAEJE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFJ;AAGJC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,IADE;AAEVK,UAAAA,SAAS,EAAE,IAFD;AAGVC,UAAAA,oBAAoB,EAAE;AAHZ;AAHR,OAvDR;AAgEEQ,MAAAA,IAAI,EAAE;AACJpB,QAAAA,IAAI,EAAE,MADF;AAEJE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFJ;AAGJC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,KADE;AAEVK,UAAAA,SAAS,EAAE,IAFD;AAGVU,UAAAA,WAAW,EAAE;AAHH;AAHR,OAhER;AAyEEC,MAAAA,IAAI,EAAE;AACJtB,QAAAA,IAAI,EAAE,MADF;AAEJE,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,EAAT;AAAaC,UAAAA,QAAQ,EAAE;AAAvB,SAFJ;AAGJC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,QADE;AAEVK,UAAAA,SAAS,EAAE,IAFD;AAGVC,UAAAA,oBAAoB,EAAE;AAHZ;AAHR;AAzER;AAmFD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;;;wBACKW,U,EAAoB;AACrB,UAAMxB,MAAM,GAAG,KAAKH,MAAL,CAAY2B,UAAZ,CAAf;;AACA,UAAI/B,+BAA+B,CAACO,MAAD,CAAnC,EAA6C;AAC3C,aAAKyB,UAAL,CAAgBzB,MAAM,CAACM,UAAvB;AACA,eAAO,IAAP;AACD,OAHD,MAGO;AACL,eAAON,MAAP;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;;+BACa0B,a,EAAsC;AAC/C,UAAMC,QAAQ,GAAG;AACfpB,QAAAA,MAAM,EAAE,EADO;AAEfC,QAAAA,MAAM,EAAE,EAFO;AAGfO,QAAAA,WAAW,EAAE,EAHE;AAIfC,QAAAA,WAAW,EAAE,EAJE;AAKfJ,QAAAA,SAAS,EAAE,KALI;AAMfM,QAAAA,WAAW,EAAE,EANE;AAOfU,QAAAA,WAAW,EAAE,KAPE;AAQfT,QAAAA,OAAO,EAAE,EARM;AASfN,QAAAA,oBAAoB,EAAE,KATP;AAUfS,QAAAA,WAAW,EAAE,KAVE;AAWfb,QAAAA,SAAS,EAAE;AAXI,OAAjB;;AAcA,UAAMoB,aAAa,mCACdF,QADc,GAEdD,aAFc,CAAnB;;AAIA,UAAMI,MAAM,GAAGC,QAAQ,CAACC,cAAT,CACb,KAAKrC,QADQ,CAAf;;AAIA,UAAImC,MAAJ,EAAY;AACVA,QAAAA,MAAM,CAACG,KAAP;AACAC,QAAAA,iBAAiB,CAACJ,MAAD,EAASD,aAAT,CAAjB;AACD;AACF;;;;;AAGH;AACA;AACA;AACA;AACA;;;AA2BA,SAASM,eAAT,CAAyBC,MAAzB,EAAkD;AAChD,SAAOA,MAAM,CAACC,IAAP,GAAcC,KAAd,CAAoB,IAApB,EAA0BC,MAA1B,GAAmC,CAA1C;AACD;;AAED,SAASC,MAAT,CAAgBJ,MAAhB,EAAgCK,CAAhC,EAAmD;AACjD,SAAOC,KAAK,CAACD,CAAC,GAAG,CAAL,CAAL,CAAaE,IAAb,CAAkBP,MAAlB,CAAP;AACD;;AAED,SAASQ,kBAAT,CAA4BC,IAA5B,EAA0CC,CAA1C,EAA6D;AAC3D,MAAIC,KAAK,GAAGD,CAAZ;;AACA,SACED,IAAI,CAACE,KAAD,CAAJ,IACAF,IAAI,CAACE,KAAK,GAAG,CAAT,CAAJ,IAAmB,IADnB,IAEA,CAACF,IAAI,CAACE,KAAK,GAAG,CAAT,CAAJ,CAAgBC,KAAhB,CAAsB,IAAtB,CAHH,EAIE;AACAD,IAAAA,KAAK;AACN;;AACD,SAAOA,KAAP;AACD;;AAED,SAASE,gBAAT,CAA0BJ,IAA1B,EAAwCC,CAAxC,EAAmDlC,SAAnD,EAA+E;AAC7E,MAAImC,KAAK,GAAGD,CAAZ;AACA,MAAMI,UAAU,GAAGtC,SAAS,GAAG,IAAH,GAAU,IAAtC;;AACA,SAAOiC,IAAI,CAACE,KAAD,CAAJ,IAAe,CAACF,IAAI,CAACE,KAAD,CAAJ,CAAYC,KAAZ,CAAkBE,UAAlB,CAAvB,EAAsD;AACpDH,IAAAA,KAAK;AACN;;AACD,SAAOA,KAAP;AACD;;AAED,IAAMI,SAAS,GAAG,EAAlB;AACA,IAAMC,WAAW,GAAG,EAApB;AAAwB;AACxB;;AACA,OAAO,SAASC,UAAT,CACLC,QADK,QAGL;AAAA,MADET,IACF,QADEA,IACF;AAAA,MADQU,cACR,QADQA,cACR;AAAA,MADwBC,YACxB,QADwBA,YACxB;AACA,MAAMC,sBAAsB,GAAGH,QAAQ,CAACC,cAAxC;AACA,MAAMG,MAAM,GAAGJ,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqB,CAArB,EAAwBH,sBAAxB,CAAf;AACA,MAAMI,KAAK,GAAGP,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqBN,QAAQ,CAACE,YAA9B,CAAd,CAHA,CAKA;AACA;;AACA,MAAIM,KAAK,GAAG,CAAZ;;AAEA,MAAMT,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,QAAMU,YAAY,GAAGhC,QAAQ,CAACiC,WAAT,CAAqB,YAArB,EAAmC,KAAnC,EAA0CnB,IAA1C,CAArB;;AAEA,QAAIkB,YAAY,KAAK,KAArB,EAA4B;AAC1B;AACN;AACA;AACA;AACA;AACA;AACA;AACM,UAAME,UAAU,GAAG,IAAIC,KAAJ,CAAU,OAAV,EAAmB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAAnB,CAAnB;AACA,UAAMC,sBAAsB,GAAGC,MAAM,CAACC,wBAAP,CAC7BC,MAAM,CAACC,mBAAP,CAA2BC,SADE,EAE7B,OAF6B,EAG5BC,GAHH;AAIAN,MAAAA,sBAAsB,CAAEO,IAAxB,CAA6BrB,QAA7B,EAAuCI,MAAM,GAAGb,IAAT,GAAgBgB,KAAvD;AACAP,MAAAA,QAAQ,CAACsB,aAAT,CAAuBX,UAAvB;AACD;;AAED,QAAIV,cAAc,IAAI,IAAlB,IAA0BC,YAAY,IAAI,IAA9C,EAAoD;AAClDF,MAAAA,QAAQ,CAACuB,iBAAT,CAA2BtB,cAA3B,EAA2CC,YAA3C;AACD,KAFD,MAEO;AACLF,MAAAA,QAAQ,CAACuB,iBAAT,CAA2BpB,sBAA3B,EAAmDH,QAAQ,CAACE,YAA5D;AACD;AACF,GAzBD;;AA2BA,MAAMsB,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAC1BxB,IAAAA,QAAQ,CAACrB,KAAT;;AACA,QAAIF,QAAQ,CAACgD,aAAT,KAA2BzB,QAA/B,EAAyC;AACvCD,MAAAA,UAAU;AACX,KAFD,MAEO,IAAI,EAAES,KAAF,KAAYX,SAAhB,EAA2B;AAChCE,MAAAA,UAAU;AACX,KAFM,MAEA;AACL2B,MAAAA,UAAU,CAACF,aAAD,EAAgB1B,WAAhB,CAAV;AACD;AACF,GATD;;AAWA0B,EAAAA,aAAa;AACd,C,CAED;;AACA,SAAS5C,iBAAT,CACEoB,QADF,EAEE2B,SAFF,EAGE;AACA,MAAMpC,IAAI,GAAGS,QAAQ,CAACK,KAAT,CAAeC,KAAf,CACXN,QAAQ,CAACC,cADE,EAEXD,QAAQ,CAACE,YAFE,CAAb;AAKA,MAAI0B,MAAJ;;AACA,MAAID,SAAS,CAAC3D,WAAd,EAA2B;AACzB4D,IAAAA,MAAM,GAAG5D,WAAW,CAACgC,QAAD,CAApB;AACD,GAFD,MAEO,IAAI2B,SAAS,CAACrE,SAAV,IAAuBuB,eAAe,CAACU,IAAD,CAA1C,EAAkD;AACvDqC,IAAAA,MAAM,GAAGC,cAAc,CAAC7B,QAAD,EAAW2B,SAAX,CAAvB;AACD,GAFM,MAEA;AACLC,IAAAA,MAAM,GAAGE,UAAU,CAAC9B,QAAD,EAAW2B,SAAX,CAAnB;AACD;;AAED5B,EAAAA,UAAU,CAACC,QAAD,EAAW4B,MAAX,CAAV;AACD;;AAED,SAASG,kBAAT,CACE/B,QADF,EAEEgC,WAFF,EAGEC,WAHF,EAKU;AAAA,MADR3E,SACQ,uEADa,KACb;;AACR,MAAI0C,QAAQ,CAACC,cAAT,KAA4BD,QAAQ,CAACE,YAAzC,EAAuD;AACrDF,IAAAA,QAAQ,CAACC,cAAT,GAA0BX,kBAAkB,CAC1CU,QAAQ,CAACK,KADiC,EAE1CL,QAAQ,CAACC,cAFiC,CAA5C;AAIAD,IAAAA,QAAQ,CAACE,YAAT,GAAwBP,gBAAgB,CACtCK,QAAQ,CAACK,KAD6B,EAEtCL,QAAQ,CAACE,YAF6B,EAGtC5C,SAHsC,CAAxC;AAKD,GAVD,MAUO;AACL,QAAM4E,sBAAsB,GAAGlC,QAAQ,CAACC,cAAT,GAA0B+B,WAAW,CAAC/C,MAArE;AACA,QAAMkD,oBAAoB,GAAGnC,QAAQ,CAACE,YAAT,GAAwB+B,WAAW,CAAChD,MAAjE;AACA,QAAMmD,gBAAgB,GACpBpC,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqB4B,sBAArB,EAA6ClC,QAAQ,CAACC,cAAtD,MACA+B,WAFF;AAGA,QAAMK,cAAc,GAClBrC,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqBN,QAAQ,CAACE,YAA9B,EAA4CiC,oBAA5C,MACAF,WAFF;;AAGA,QAAIG,gBAAgB,IAAIC,cAAxB,EAAwC;AACtCrC,MAAAA,QAAQ,CAACC,cAAT,GAA0BiC,sBAA1B;AACAlC,MAAAA,QAAQ,CAACE,YAAT,GAAwBiC,oBAAxB;AACD;AACF;;AACD,SAAOnC,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqBN,QAAQ,CAACC,cAA9B,EAA8CD,QAAQ,CAACE,YAAvD,CAAP;AACD;;AAED,SAASoC,8BAAT,CACEtC,QADF,EAEY;AACV,MAAMuC,eAAe,GAAGvC,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqB,CAArB,EAAwBN,QAAQ,CAACC,cAAjC,CAAxB;AACA,MAAMuC,cAAc,GAAGxC,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqBN,QAAQ,CAACE,YAA9B,CAAvB;AAEA,MAAMuC,YAAY,GAAGF,eAAe,CAAC7C,KAAhB,CAAsB,MAAtB,CAArB;AACA,MAAMgD,WAAW,GAAGF,cAAc,CAAC9C,KAAf,CAAqB,MAArB,CAApB;AACA,MAAMiD,uBAAuB,GAAGF,YAAY,GAAGA,YAAY,CAAC,CAAD,CAAZ,CAAgBxD,MAAnB,GAA4B,CAAxE;AACA,MAAM2D,sBAAsB,GAAGF,WAAW,GAAGA,WAAW,CAAC,CAAD,CAAX,CAAezD,MAAlB,GAA2B,CAArE;AAEA,MAAI4D,gBAAJ;AACA,MAAIC,iBAAJ;;AAEA,MAAIP,eAAe,CAAC7C,KAAhB,CAAsB,IAAtB,KAA+BiD,uBAAuB,GAAG,CAA7D,EAAgE;AAC9DE,IAAAA,gBAAgB,GAAG3D,MAAM,CAAC,IAAD,EAAO,IAAIyD,uBAAX,CAAzB;AACD;;AAED,MAAIH,cAAc,CAAC9C,KAAf,CAAqB,IAArB,KAA8BkD,sBAAsB,GAAG,CAA3D,EAA8D;AAC5DE,IAAAA,iBAAiB,GAAG5D,MAAM,CAAC,IAAD,EAAO,IAAI0D,sBAAX,CAA1B;AACD;;AAED,MAAIC,gBAAgB,IAAI,IAAxB,EAA8B;AAC5BA,IAAAA,gBAAgB,GAAG,EAAnB;AACD;;AAED,MAAIC,iBAAiB,IAAI,IAAzB,EAA+B;AAC7BA,IAAAA,iBAAiB,GAAG,EAApB;AACD;;AAED,SAAO;AAAED,IAAAA,gBAAgB,EAAhBA,gBAAF;AAAoBC,IAAAA,iBAAiB,EAAjBA;AAApB,GAAP;AACD;;AAED,SAAShB,UAAT,CACE9B,QADF,EAEE+C,GAFF,EAGkB;AAChB,MAAIF,gBAAJ;AACA,MAAIC,iBAAJ;AAFgB,MAKd7F,MALc,GAaZ8F,GAbY,CAKd9F,MALc;AAAA,MAMdC,MANc,GAaZ6F,GAbY,CAMd7F,MANc;AAAA,MAOdO,WAPc,GAaZsF,GAbY,CAOdtF,WAPc;AAAA,MAQdC,WARc,GAaZqF,GAbY,CAQdrF,WARc;AAAA,MASdE,WATc,GAaZmF,GAbY,CASdnF,WATc;AAAA,MAUdU,WAVc,GAaZyE,GAbY,CAUdzE,WAVc;AAAA,MAWdT,OAXc,GAaZkF,GAbY,CAWdlF,OAXc;AAAA,MAYdN,oBAZc,GAaZwF,GAbY,CAYdxF,oBAZc;AAchB,MAAM4C,sBAAsB,GAAGH,QAAQ,CAACC,cAAxC;AACA,MAAM+C,oBAAoB,GAAGhD,QAAQ,CAACE,YAAtC;AAEA,MAAI+C,YAAY,GAAGjD,QAAQ,CAACK,KAAT,CAAeC,KAAf,CACjBN,QAAQ,CAACC,cADQ,EAEjBD,QAAQ,CAACE,YAFQ,CAAnB;AAIA,MAAI8B,WAAW,GACbnD,eAAe,CAACoE,YAAD,CAAf,IAAiCxF,WAAW,CAACwB,MAAZ,GAAqB,CAAtD,aACOxB,WADP,UAEIR,MAHN;AAIA,MAAIgF,WAAW,GACbpD,eAAe,CAACoE,YAAD,CAAf,IAAiCvF,WAAW,CAACuB,MAAZ,GAAqB,CAAtD,eACSvB,WADT,IAEIR,MAHN;;AAKA,MAAIoB,WAAJ,EAAiB;AACf,QAAMiE,eAAe,GAAGvC,QAAQ,CAACK,KAAT,CAAeL,QAAQ,CAACC,cAAT,GAA0B,CAAzC,CAAxB;;AACA,QACED,QAAQ,CAACC,cAAT,KAA4B,CAA5B,IACAsC,eAAe,IAAI,IADnB,IAEA,CAACA,eAAe,CAAC7C,KAAhB,CAAsB,IAAtB,CAHH,EAIE;AACAsC,MAAAA,WAAW,cAAOA,WAAP,CAAX;AACD;AACF;;AACDiB,EAAAA,YAAY,GAAGlB,kBAAkB,CAC/B/B,QAD+B,EAE/BgC,WAF+B,EAG/BC,WAH+B,EAI/Bc,GAAG,CAACzF,SAJ2B,CAAjC;AAMA,MAAI2C,cAAc,GAAGD,QAAQ,CAACC,cAA9B;AACA,MAAIC,YAAY,GAAGF,QAAQ,CAACE,YAA5B;AACA,MAAMgD,cAAc,GAClBtF,WAAW,CAACqB,MAAZ,GAAqB,CAArB,IACAgD,WAAW,CAACkB,OAAZ,CAAoBvF,WAApB,IAAmC,CAAC,CADpC,IAEAqF,YAAY,CAAChE,MAAb,GAAsB,CAHxB;;AAIA,MAAI1B,oBAAJ,EAA0B;AACxB,QAAM6F,GAAG,GAAGd,8BAA8B,CAACtC,QAAD,CAA1C;AACA6C,IAAAA,gBAAgB,GAAGO,GAAG,CAACP,gBAAvB;AACAC,IAAAA,iBAAiB,GAAGM,GAAG,CAACN,iBAAxB;AACAd,IAAAA,WAAW,GAAGa,gBAAgB,GAAG5F,MAAjC;AACAgF,IAAAA,WAAW,IAAIa,iBAAf;AACD;;AAED,MACEG,YAAY,CAACI,UAAb,CAAwBrB,WAAxB,KACAiB,YAAY,CAACK,QAAb,CAAsBrB,WAAtB,CAFF,EAGE;AACA,QAAMsB,eAAe,GAAGN,YAAY,CAAC3C,KAAb,CACtB0B,WAAW,CAAC/C,MADU,EAEtBgE,YAAY,CAAChE,MAAb,GAAsBgD,WAAW,CAAChD,MAFZ,CAAxB;;AAIA,QAAIkB,sBAAsB,KAAK6C,oBAA/B,EAAqD;AACnD,UAAIQ,QAAQ,GAAGrD,sBAAsB,GAAG6B,WAAW,CAAC/C,MAApD;AACAuE,MAAAA,QAAQ,GAAGC,IAAI,CAACC,GAAL,CAASF,QAAT,EAAmBvD,cAAnB,CAAX;AACAuD,MAAAA,QAAQ,GAAGC,IAAI,CAACE,GAAL,CAASH,QAAT,EAAmBvD,cAAc,GAAGsD,eAAe,CAACtE,MAApD,CAAX;AACAgB,MAAAA,cAAc,GAAGC,YAAY,GAAGsD,QAAhC;AACD,KALD,MAKO;AACLtD,MAAAA,YAAY,GAAGD,cAAc,GAAGsD,eAAe,CAACtE,MAAhD;AACD;;AACD,WAAO;AAAEM,MAAAA,IAAI,EAAEgE,eAAR;AAAyBtD,MAAAA,cAAc,EAAdA,cAAzB;AAAyCC,MAAAA,YAAY,EAAZA;AAAzC,KAAP;AACD,GAjBD,MAiBO,IAAI,CAACgD,cAAL,EAAqB;AAC1B,QAAIK,gBAAe,GAAGvB,WAAW,GAAGiB,YAAd,GAA6BhB,WAAnD;;AACAhC,IAAAA,cAAc,GAAGE,sBAAsB,GAAG6B,WAAW,CAAC/C,MAAtD;AACAiB,IAAAA,YAAY,GAAG8C,oBAAoB,GAAGhB,WAAW,CAAC/C,MAAlD;AACA,QAAM2E,eAAe,GAAGX,YAAY,CAACvD,KAAb,CAAmB,YAAnB,CAAxB;;AACA,QAAIqD,GAAG,CAAC5F,SAAJ,IAAiByG,eAArB,EAAsC;AACpC,UAAMC,iBAAiB,GAAGD,eAAe,CAAC,CAAD,CAAf,IAAsB,EAAhD;AACA,UAAME,kBAAkB,GAAGF,eAAe,CAAC,CAAD,CAAf,IAAsB,EAAjD;AACAL,MAAAA,gBAAe,GACbM,iBAAiB,GACjB7B,WADA,GAEAiB,YAAY,CAAClE,IAAb,EAFA,GAGAkD,WAHA,GAIA6B,kBALF;AAMA7D,MAAAA,cAAc,IAAI4D,iBAAiB,CAAC5E,MAApC;AACAiB,MAAAA,YAAY,IAAI4D,kBAAkB,CAAC7E,MAAnC;AACD;;AACD,WAAO;AAAEM,MAAAA,IAAI,EAAEgE,gBAAR;AAAyBtD,MAAAA,cAAc,EAAdA,cAAzB;AAAyCC,MAAAA,YAAY,EAAZA;AAAzC,KAAP;AACD,GAlBM,MAkBA,IAAIrC,OAAO,CAACoB,MAAR,GAAiB,CAAjB,IAAsBgE,YAAY,CAACvD,KAAb,CAAmB7B,OAAnB,CAA1B,EAAuD;AAC5DoE,IAAAA,WAAW,GAAGA,WAAW,CAAC8B,OAAZ,CAAoBnG,WAApB,EAAiCqF,YAAjC,CAAd;;AACA,QAAMM,iBAAe,GAAGvB,WAAW,GAAGC,WAAtC;;AACAhC,IAAAA,cAAc,GAAGC,YAAY,GAAGD,cAAc,GAAG+B,WAAW,CAAC/C,MAA7D;AACA,WAAO;AAAEM,MAAAA,IAAI,EAAEgE,iBAAR;AAAyBtD,MAAAA,cAAc,EAAdA,cAAzB;AAAyCC,MAAAA,YAAY,EAAZA;AAAzC,KAAP;AACD,GALM,MAKA;AACL,QAAMqD,iBAAe,GAAGvB,WAAW,GAAGiB,YAAd,GAA6BhB,WAArD;;AACAhC,IAAAA,cAAc,GACZA,cAAc,GACd+B,WAAW,CAAC/C,MADZ,GAEAgE,YAAY,CAAChE,MAFb,GAGAgD,WAAW,CAACkB,OAAZ,CAAoBvF,WAApB,CAJF;AAKAsC,IAAAA,YAAY,GAAGD,cAAc,GAAGrC,WAAW,CAACqB,MAA5C;AACA,WAAO;AAAEM,MAAAA,IAAI,EAAEgE,iBAAR;AAAyBtD,MAAAA,cAAc,EAAdA,cAAzB;AAAyCC,MAAAA,YAAY,EAAZA;AAAzC,KAAP;AACD;AACF;;AAED,SAAS2B,cAAT,CAAwB7B,QAAxB,EAAuD+C,GAAvD,EAAuE;AAAA,MAC7D9F,MAD6D,GACpB8F,GADoB,CAC7D9F,MAD6D;AAAA,MACrDC,MADqD,GACpB6F,GADoB,CACrD7F,MADqD;AAAA,MAC7CK,oBAD6C,GACpBwF,GADoB,CAC7CxF,oBAD6C;AAErE,MAAIgC,IAAI,GAAGS,QAAQ,CAACK,KAAT,CAAeC,KAAf,CACTN,QAAQ,CAACC,cADA,EAETD,QAAQ,CAACE,YAFA,CAAX;AAIA,MAAID,cAAc,GAAGD,QAAQ,CAACC,cAA9B;AACA,MAAIC,YAAY,GAAGF,QAAQ,CAACE,YAA5B;AACA,MAAM8D,KAAK,GAAGzE,IAAI,CAACP,KAAL,CAAW,IAAX,CAAd;AACA,MAAMiF,SAAS,GAAGD,KAAK,CAACE,KAAN,CAChB,UAACC,IAAD;AAAA,WAAUA,IAAI,CAACd,UAAL,CAAgBpG,MAAhB,KAA2BkH,IAAI,CAACb,QAAL,CAAcpG,MAAd,CAArC;AAAA,GADgB,CAAlB;;AAIA,MAAI+G,SAAJ,EAAe;AACb1E,IAAAA,IAAI,GAAGyE,KAAK,CACTI,GADI,CACA,UAACD,IAAD;AAAA,aAAUA,IAAI,CAAC7D,KAAL,CAAWrD,MAAM,CAACgC,MAAlB,EAA0BkF,IAAI,CAAClF,MAAL,GAAc/B,MAAM,CAAC+B,MAA/C,CAAV;AAAA,KADA,EAEJI,IAFI,CAEC,IAFD,CAAP;AAGAa,IAAAA,YAAY,GAAGD,cAAc,GAAGV,IAAI,CAACN,MAArC;AACD,GALD,MAKO;AACLM,IAAAA,IAAI,GAAGyE,KAAK,CAACI,GAAN,CAAU,UAACD,IAAD;AAAA,aAAUlH,MAAM,GAAGkH,IAAT,GAAgBjH,MAA1B;AAAA,KAAV,EAA4CmC,IAA5C,CAAiD,IAAjD,CAAP;;AACA,QAAI9B,oBAAJ,EAA0B;AAAA,kCAIpB+E,8BAA8B,CAACtC,QAAD,CAJV;AAAA,UAEtB6C,gBAFsB,yBAEtBA,gBAFsB;AAAA,UAGtBC,iBAHsB,yBAGtBA,iBAHsB;;AAKxB7C,MAAAA,cAAc,IAAI4C,gBAAgB,CAAC5D,MAAnC;AACAiB,MAAAA,YAAY,GAAGD,cAAc,GAAGV,IAAI,CAACN,MAArC;AACAM,MAAAA,IAAI,GAAGsD,gBAAgB,GAAGtD,IAAnB,GAA0BuD,iBAAjC;AACD;AACF;;AAED,SAAO;AAAEvD,IAAAA,IAAI,EAAJA,IAAF;AAAQU,IAAAA,cAAc,EAAdA,cAAR;AAAwBC,IAAAA,YAAY,EAAZA;AAAxB,GAAP;AACD;;AAED,SAASlC,WAAT,CAAqBgC,QAArB,EAAoE;AAClE,MAAMqE,gBAAgB,GAAG,WAAzB;AACA,MAAMC,kBAAkB,GAAGtE,QAAQ,CAACC,cAAT,KAA4BD,QAAQ,CAACE,YAAhE;AACA,MAAIA,YAAJ;AACA,MAAID,cAAJ;AACA,MAAIV,IAAI,GAAGS,QAAQ,CAACK,KAAT,CAAeC,KAAf,CACTN,QAAQ,CAACC,cADA,EAETD,QAAQ,CAACE,YAFA,CAAX;AAIA,MAAIqE,aAAa,GAAGhF,IAApB;AACA,MAAIyE,KAAK,GAAGzE,IAAI,CAACP,KAAL,CAAW,IAAX,CAAZ;AACA,MAAIwF,WAAJ;AACA,MAAIC,SAAJ;;AACA,MAAIH,kBAAJ,EAAwB;AACtB,QAAMI,WAAW,GAAG1E,QAAQ,CAACK,KAAT,CACjBC,KADiB,CACX,CADW,EACRN,QAAQ,CAACC,cADD,EAEjBjB,KAFiB,CAEX,IAFW,CAApB;AAGAwF,IAAAA,WAAW,GACTxE,QAAQ,CAACC,cAAT,GAA0ByE,WAAW,CAACA,WAAW,CAACzF,MAAZ,GAAqB,CAAtB,CAAX,CAAoCA,MADhE;AAEAwF,IAAAA,SAAS,GAAG9E,gBAAgB,CAACK,QAAQ,CAACK,KAAV,EAAiBL,QAAQ,CAACC,cAA1B,EAA0C,IAA1C,CAA5B;AACAsE,IAAAA,aAAa,GAAGvE,QAAQ,CAACK,KAAT,CAAeC,KAAf,CAAqBkE,WAArB,EAAkCC,SAAlC,CAAhB;AACD;;AACD,MAAME,cAAc,GAAGJ,aAAa,CAACvF,KAAd,CAAoB,IAApB,CAAvB;AACA,MAAM4F,WAAW,GAAGD,cAAc,CAACT,KAAf,CAAqB,UAACC,IAAD;AAAA,WACvCE,gBAAgB,CAACQ,IAAjB,CAAsBV,IAAtB,CADuC;AAAA,GAArB,CAApB;;AAIA,MAAIS,WAAJ,EAAiB;AACfZ,IAAAA,KAAK,GAAGW,cAAc,CAACP,GAAf,CAAmB,UAACD,IAAD;AAAA,aAAUA,IAAI,CAACJ,OAAL,CAAaM,gBAAb,EAA+B,EAA/B,CAAV;AAAA,KAAnB,CAAR;AACA9E,IAAAA,IAAI,GAAGyE,KAAK,CAAC3E,IAAN,CAAW,IAAX,CAAP;;AACA,QAAIiF,kBAAkB,IAAIE,WAAtB,IAAqCC,SAAzC,EAAoD;AAClD,UAAMK,UAAU,GAAGH,cAAc,CAAC,CAAD,CAAd,CAAkB1F,MAAlB,GAA2B+E,KAAK,CAAC,CAAD,CAAL,CAAS/E,MAAvD;AACAgB,MAAAA,cAAc,GAAGC,YAAY,GAAGF,QAAQ,CAACC,cAAT,GAA0B6E,UAA1D;AACA9E,MAAAA,QAAQ,CAACC,cAAT,GAA0BuE,WAA1B;AACAxE,MAAAA,QAAQ,CAACE,YAAT,GAAwBuE,SAAxB;AACD;AACF,GATD,MASO;AACLT,IAAAA,KAAK,GAAI,YAAY;AACnB,UAAIxE,CAAJ;AACA,UAAIuF,GAAJ;AACA,UAAItF,KAAJ;AACA,UAAMuF,OAAO,GAAG,EAAhB;;AACA,WAAKvF,KAAK,GAAGD,CAAC,GAAG,CAAZ,EAAeuF,GAAG,GAAGf,KAAK,CAAC/E,MAAhC,EAAwCO,CAAC,GAAGuF,GAA5C,EAAiDtF,KAAK,GAAG,EAAED,CAA3D,EAA8D;AAC5D,YAAM2E,IAAI,GAAGH,KAAK,CAACvE,KAAD,CAAlB;AACAuF,QAAAA,OAAO,CAACC,IAAR,WAAgBxF,KAAK,GAAG,CAAxB,eAA8B0E,IAA9B;AACD;;AACD,aAAOa,OAAP;AACD,KAVO,EAAR;;AAWAzF,IAAAA,IAAI,GAAGyE,KAAK,CAAC3E,IAAN,CAAW,IAAX,CAAP;;AAZK,iCAgBDiD,8BAA8B,CAACtC,QAAD,CAhB7B;AAAA,QAcH6C,gBAdG,0BAcHA,gBAdG;AAAA,QAeHC,iBAfG,0BAeHA,iBAfG;;AAiBL7C,IAAAA,cAAc,GAAGD,QAAQ,CAACC,cAAT,GAA0B4C,gBAAgB,CAAC5D,MAA5D;AACAiB,IAAAA,YAAY,GAAGD,cAAc,GAAGV,IAAI,CAACN,MAArC;AACA,QAAIqF,kBAAJ,EAAwBrE,cAAc,GAAGC,YAAjB;AACxBX,IAAAA,IAAI,GAAGsD,gBAAgB,GAAGtD,IAAnB,GAA0BuD,iBAAjC;AACD;;AAED,SAAO;AAAEvD,IAAAA,IAAI,EAAJA,IAAF;AAAQU,IAAAA,cAAc,EAAdA,cAAR;AAAwBC,IAAAA,YAAY,EAAZA;AAAxB,GAAP;AACD;;AAED,eAAe9D,eAAf","sourcesContent":["/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// The text-formatting logic & code in this file come from\n// https://github.com/github/markdown-toolbar-element/blob/main/src/index.ts\n// under the following MIT license\n/*\nCopyright (c) 2017-2018 GitHub, Inc.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n */\n\nimport {\n  EuiMarkdownEditorUiPlugin,\n  EuiMarkdownFormatting,\n  isPluginWithImmediateFormatting,\n} from './markdown_types';\n\n/**\n * Class for applying styles to a text editor. Accepts the HTML ID for the textarea\n * desired, and exposes the `.do(ACTION)` method for manipulating the text.\n *\n * @class MarkdownActions\n * @param {string} editorID\n */\nclass MarkdownActions {\n  styles: Record<string, EuiMarkdownEditorUiPlugin>;\n\n  constructor(public editorID: string, uiPlugins: EuiMarkdownEditorUiPlugin[]) {\n    /**\n     * This object is in the format:\n     * [nameOfAction]: {[styles to apply]}\n     */\n    this.styles = {\n      ...uiPlugins.reduce<MarkdownActions['styles']>(\n        (mappedPlugins, plugin) => {\n          mappedPlugins[plugin.name] = plugin;\n          return mappedPlugins;\n        },\n        {}\n      ),\n      mdBold: {\n        name: 'mdBold',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '**',\n          suffix: '**',\n          trimFirst: true,\n        },\n      },\n      mdItalic: {\n        name: 'mdItalic',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '_',\n          suffix: '_',\n          trimFirst: true,\n        },\n      },\n      mdQuote: {\n        name: 'mdQuote',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '> ',\n          multiline: true,\n          surroundWithNewlines: true,\n        },\n      },\n      mdCode: {\n        name: 'mdCode',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '`',\n          suffix: '`',\n          blockPrefix: '```',\n          blockSuffix: '```',\n        },\n      },\n      mdLink: {\n        name: 'mdLink',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '[',\n          suffix: '](url)',\n          replaceNext: 'url',\n          scanFor: 'https?://',\n        },\n      },\n      mdUl: {\n        name: 'mdUl',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '- ',\n          multiline: true,\n          surroundWithNewlines: true,\n        },\n      },\n      mdOl: {\n        name: 'mdOl',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '1. ',\n          multiline: true,\n          orderedList: true,\n        },\n      },\n      mdTl: {\n        name: 'mdTl',\n        button: { label: '', iconType: '' },\n        formatting: {\n          prefix: '- [ ] ',\n          multiline: true,\n          surroundWithNewlines: true,\n        },\n      },\n    };\n  }\n\n  /**\n   * .do() accepts a string and retrieves the correlating style object (defined in the\n   * constructor). It passes this to applyStyle() that does the text manipulation.\n   *\n   * @param {string} pluginName\n   * @memberof MarkdownActions\n   */\n  do(pluginName: string) {\n    const plugin = this.styles[pluginName];\n    if (isPluginWithImmediateFormatting(plugin)) {\n      this.applyStyle(plugin.formatting);\n      return true;\n    } else {\n      return plugin;\n    }\n  }\n\n  /**\n   * Sets the default styling object and then superimposes the changes to make on top of\n   * it. Calls the `styleSelectedText` helper function that does the heavy lifting.\n   * Adapted from https://github.com/github/markdown-toolbar-element/blob/main/src/index.ts\n   *\n   * @param {object} incomingStyle\n   * @memberof MarkdownActions\n   */\n  applyStyle(incomingStyle: EuiMarkdownFormatting) {\n    const defaults = {\n      prefix: '',\n      suffix: '',\n      blockPrefix: '',\n      blockSuffix: '',\n      multiline: false,\n      replaceNext: '',\n      prefixSpace: false,\n      scanFor: '',\n      surroundWithNewlines: false,\n      orderedList: false,\n      trimFirst: false,\n    };\n\n    const outgoingStyle = {\n      ...defaults,\n      ...incomingStyle,\n    };\n    const editor = document.getElementById(\n      this.editorID\n    ) as HTMLTextAreaElement;\n\n    if (editor) {\n      editor.focus();\n      styleSelectedText(editor, outgoingStyle);\n    }\n  }\n}\n\n/**\n * The following helper functions and types were copied from the GitHub Markdown Toolbar\n * Element project. The project is MIT-licensed. See it here:\n * https://github.com/github/markdown-toolbar-element\n */\n\ninterface Newlines {\n  newlinesToAppend: string;\n  newlinesToPrepend: string;\n}\n\ninterface SelectionRange {\n  text: string;\n  selectionStart?: number;\n  selectionEnd?: number;\n}\n\ninterface StyleArgs {\n  prefix: string;\n  suffix: string;\n  blockPrefix: string;\n  blockSuffix: string;\n  multiline: boolean;\n  replaceNext: string;\n  prefixSpace: boolean;\n  scanFor: string;\n  surroundWithNewlines: boolean;\n  orderedList: boolean;\n  trimFirst: boolean;\n}\n\nfunction isMultipleLines(string: string): boolean {\n  return string.trim().split('\\n').length > 1;\n}\n\nfunction repeat(string: string, n: number): string {\n  return Array(n + 1).join(string);\n}\n\nfunction wordSelectionStart(text: string, i: number): number {\n  let index = i;\n  while (\n    text[index] &&\n    text[index - 1] != null &&\n    !text[index - 1].match(/\\s/)\n  ) {\n    index--;\n  }\n  return index;\n}\n\nfunction wordSelectionEnd(text: string, i: number, multiline: boolean): number {\n  let index = i;\n  const breakpoint = multiline ? /\\n/ : /\\s/;\n  while (text[index] && !text[index].match(breakpoint)) {\n    index++;\n  }\n  return index;\n}\n\nconst MAX_TRIES = 10;\nconst TRY_TIMEOUT = 10; /*ms*/\n// modified from https://github.com/github/markdown-toolbar-element/blob/main/src/index.ts\nexport function insertText(\n  textarea: HTMLTextAreaElement,\n  { text, selectionStart, selectionEnd }: SelectionRange\n) {\n  const originalSelectionStart = textarea.selectionStart;\n  const before = textarea.value.slice(0, originalSelectionStart);\n  const after = textarea.value.slice(textarea.selectionEnd);\n\n  // configuration modal/dialog will continue intercepting focus in Safari\n  // need to wait until the textarea can receive focus\n  let tries = 0;\n\n  const insertText = () => {\n    const insertResult = document.execCommand('insertText', false, text);\n\n    if (insertResult === false) {\n      /**\n       * Fallback for Firefox; this kills undo/redo but at least updates the value\n       *\n       * Note that we're using the native HTMLTextAreaElement.set() method to play nicely with\n       * React's synthetic event system.\n       * https://hustle.bizongo.in/simulate-react-on-change-on-controlled-components-baa336920e04\n       */\n      const inputEvent = new Event('input', { bubbles: true });\n      const nativeInputValueSetter = Object.getOwnPropertyDescriptor(\n        window.HTMLTextAreaElement.prototype,\n        'value'\n      )!.set;\n      nativeInputValueSetter!.call(textarea, before + text + after);\n      textarea.dispatchEvent(inputEvent);\n    }\n\n    if (selectionStart != null && selectionEnd != null) {\n      textarea.setSelectionRange(selectionStart, selectionEnd);\n    } else {\n      textarea.setSelectionRange(originalSelectionStart, textarea.selectionEnd);\n    }\n  };\n\n  const focusTextarea = () => {\n    textarea.focus();\n    if (document.activeElement === textarea) {\n      insertText();\n    } else if (++tries === MAX_TRIES) {\n      insertText();\n    } else {\n      setTimeout(focusTextarea, TRY_TIMEOUT);\n    }\n  };\n\n  focusTextarea();\n}\n\n// from https://github.com/github/markdown-toolbar-element/blob/main/src/index.ts\nfunction styleSelectedText(\n  textarea: HTMLTextAreaElement,\n  styleArgs: StyleArgs\n) {\n  const text = textarea.value.slice(\n    textarea.selectionStart,\n    textarea.selectionEnd\n  );\n\n  let result;\n  if (styleArgs.orderedList) {\n    result = orderedList(textarea);\n  } else if (styleArgs.multiline && isMultipleLines(text)) {\n    result = multilineStyle(textarea, styleArgs);\n  } else {\n    result = blockStyle(textarea, styleArgs);\n  }\n\n  insertText(textarea, result);\n}\n\nfunction expandSelectedText(\n  textarea: HTMLTextAreaElement,\n  prefixToUse: string,\n  suffixToUse: string,\n  multiline: boolean = false\n): string {\n  if (textarea.selectionStart === textarea.selectionEnd) {\n    textarea.selectionStart = wordSelectionStart(\n      textarea.value,\n      textarea.selectionStart\n    );\n    textarea.selectionEnd = wordSelectionEnd(\n      textarea.value,\n      textarea.selectionEnd,\n      multiline\n    );\n  } else {\n    const expandedSelectionStart = textarea.selectionStart - prefixToUse.length;\n    const expandedSelectionEnd = textarea.selectionEnd + suffixToUse.length;\n    const beginsWithPrefix =\n      textarea.value.slice(expandedSelectionStart, textarea.selectionStart) ===\n      prefixToUse;\n    const endsWithSuffix =\n      textarea.value.slice(textarea.selectionEnd, expandedSelectionEnd) ===\n      suffixToUse;\n    if (beginsWithPrefix && endsWithSuffix) {\n      textarea.selectionStart = expandedSelectionStart;\n      textarea.selectionEnd = expandedSelectionEnd;\n    }\n  }\n  return textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n}\n\nfunction newlinesToSurroundSelectedText(\n  textarea: HTMLTextAreaElement\n): Newlines {\n  const beforeSelection = textarea.value.slice(0, textarea.selectionStart);\n  const afterSelection = textarea.value.slice(textarea.selectionEnd);\n\n  const breaksBefore = beforeSelection.match(/\\n*$/);\n  const breaksAfter = afterSelection.match(/^\\n*/);\n  const newlinesBeforeSelection = breaksBefore ? breaksBefore[0].length : 0;\n  const newlinesAfterSelection = breaksAfter ? breaksAfter[0].length : 0;\n\n  let newlinesToAppend;\n  let newlinesToPrepend;\n\n  if (beforeSelection.match(/\\S/) && newlinesBeforeSelection < 2) {\n    newlinesToAppend = repeat('\\n', 2 - newlinesBeforeSelection);\n  }\n\n  if (afterSelection.match(/\\S/) && newlinesAfterSelection < 2) {\n    newlinesToPrepend = repeat('\\n', 2 - newlinesAfterSelection);\n  }\n\n  if (newlinesToAppend == null) {\n    newlinesToAppend = '';\n  }\n\n  if (newlinesToPrepend == null) {\n    newlinesToPrepend = '';\n  }\n\n  return { newlinesToAppend, newlinesToPrepend };\n}\n\nfunction blockStyle(\n  textarea: HTMLTextAreaElement,\n  arg: StyleArgs\n): SelectionRange {\n  let newlinesToAppend;\n  let newlinesToPrepend;\n\n  const {\n    prefix,\n    suffix,\n    blockPrefix,\n    blockSuffix,\n    replaceNext,\n    prefixSpace,\n    scanFor,\n    surroundWithNewlines,\n  } = arg;\n  const originalSelectionStart = textarea.selectionStart;\n  const originalSelectionEnd = textarea.selectionEnd;\n\n  let selectedText = textarea.value.slice(\n    textarea.selectionStart,\n    textarea.selectionEnd\n  );\n  let prefixToUse =\n    isMultipleLines(selectedText) && blockPrefix.length > 0\n      ? `${blockPrefix}\\n`\n      : prefix;\n  let suffixToUse =\n    isMultipleLines(selectedText) && blockSuffix.length > 0\n      ? `\\n${blockSuffix}`\n      : suffix;\n\n  if (prefixSpace) {\n    const beforeSelection = textarea.value[textarea.selectionStart - 1];\n    if (\n      textarea.selectionStart !== 0 &&\n      beforeSelection != null &&\n      !beforeSelection.match(/\\s/)\n    ) {\n      prefixToUse = ` ${prefixToUse}`;\n    }\n  }\n  selectedText = expandSelectedText(\n    textarea,\n    prefixToUse,\n    suffixToUse,\n    arg.multiline\n  );\n  let selectionStart = textarea.selectionStart;\n  let selectionEnd = textarea.selectionEnd;\n  const hasReplaceNext =\n    replaceNext.length > 0 &&\n    suffixToUse.indexOf(replaceNext) > -1 &&\n    selectedText.length > 0;\n  if (surroundWithNewlines) {\n    const ref = newlinesToSurroundSelectedText(textarea);\n    newlinesToAppend = ref.newlinesToAppend;\n    newlinesToPrepend = ref.newlinesToPrepend;\n    prefixToUse = newlinesToAppend + prefix;\n    suffixToUse += newlinesToPrepend;\n  }\n\n  if (\n    selectedText.startsWith(prefixToUse) &&\n    selectedText.endsWith(suffixToUse)\n  ) {\n    const replacementText = selectedText.slice(\n      prefixToUse.length,\n      selectedText.length - suffixToUse.length\n    );\n    if (originalSelectionStart === originalSelectionEnd) {\n      let position = originalSelectionStart - prefixToUse.length;\n      position = Math.max(position, selectionStart);\n      position = Math.min(position, selectionStart + replacementText.length);\n      selectionStart = selectionEnd = position;\n    } else {\n      selectionEnd = selectionStart + replacementText.length;\n    }\n    return { text: replacementText, selectionStart, selectionEnd };\n  } else if (!hasReplaceNext) {\n    let replacementText = prefixToUse + selectedText + suffixToUse;\n    selectionStart = originalSelectionStart + prefixToUse.length;\n    selectionEnd = originalSelectionEnd + prefixToUse.length;\n    const whitespaceEdges = selectedText.match(/^\\s*|\\s*$/g);\n    if (arg.trimFirst && whitespaceEdges) {\n      const leadingWhitespace = whitespaceEdges[0] || '';\n      const trailingWhitespace = whitespaceEdges[1] || '';\n      replacementText =\n        leadingWhitespace +\n        prefixToUse +\n        selectedText.trim() +\n        suffixToUse +\n        trailingWhitespace;\n      selectionStart += leadingWhitespace.length;\n      selectionEnd -= trailingWhitespace.length;\n    }\n    return { text: replacementText, selectionStart, selectionEnd };\n  } else if (scanFor.length > 0 && selectedText.match(scanFor)) {\n    suffixToUse = suffixToUse.replace(replaceNext, selectedText);\n    const replacementText = prefixToUse + suffixToUse;\n    selectionStart = selectionEnd = selectionStart + prefixToUse.length;\n    return { text: replacementText, selectionStart, selectionEnd };\n  } else {\n    const replacementText = prefixToUse + selectedText + suffixToUse;\n    selectionStart =\n      selectionStart +\n      prefixToUse.length +\n      selectedText.length +\n      suffixToUse.indexOf(replaceNext);\n    selectionEnd = selectionStart + replaceNext.length;\n    return { text: replacementText, selectionStart, selectionEnd };\n  }\n}\n\nfunction multilineStyle(textarea: HTMLTextAreaElement, arg: StyleArgs) {\n  const { prefix, suffix, surroundWithNewlines } = arg;\n  let text = textarea.value.slice(\n    textarea.selectionStart,\n    textarea.selectionEnd\n  );\n  let selectionStart = textarea.selectionStart;\n  let selectionEnd = textarea.selectionEnd;\n  const lines = text.split('\\n');\n  const undoStyle = lines.every(\n    (line) => line.startsWith(prefix) && line.endsWith(suffix)\n  );\n\n  if (undoStyle) {\n    text = lines\n      .map((line) => line.slice(prefix.length, line.length - suffix.length))\n      .join('\\n');\n    selectionEnd = selectionStart + text.length;\n  } else {\n    text = lines.map((line) => prefix + line + suffix).join('\\n');\n    if (surroundWithNewlines) {\n      const {\n        newlinesToAppend,\n        newlinesToPrepend,\n      } = newlinesToSurroundSelectedText(textarea);\n      selectionStart += newlinesToAppend.length;\n      selectionEnd = selectionStart + text.length;\n      text = newlinesToAppend + text + newlinesToPrepend;\n    }\n  }\n\n  return { text, selectionStart, selectionEnd };\n}\n\nfunction orderedList(textarea: HTMLTextAreaElement): SelectionRange {\n  const orderedListRegex = /^\\d+\\.\\s+/;\n  const noInitialSelection = textarea.selectionStart === textarea.selectionEnd;\n  let selectionEnd;\n  let selectionStart;\n  let text = textarea.value.slice(\n    textarea.selectionStart,\n    textarea.selectionEnd\n  );\n  let textToUnstyle = text;\n  let lines = text.split('\\n');\n  let startOfLine;\n  let endOfLine;\n  if (noInitialSelection) {\n    const linesBefore = textarea.value\n      .slice(0, textarea.selectionStart)\n      .split(/\\n/);\n    startOfLine =\n      textarea.selectionStart - linesBefore[linesBefore.length - 1].length;\n    endOfLine = wordSelectionEnd(textarea.value, textarea.selectionStart, true);\n    textToUnstyle = textarea.value.slice(startOfLine, endOfLine);\n  }\n  const linesToUnstyle = textToUnstyle.split('\\n');\n  const undoStyling = linesToUnstyle.every((line) =>\n    orderedListRegex.test(line)\n  );\n\n  if (undoStyling) {\n    lines = linesToUnstyle.map((line) => line.replace(orderedListRegex, ''));\n    text = lines.join('\\n');\n    if (noInitialSelection && startOfLine && endOfLine) {\n      const lengthDiff = linesToUnstyle[0].length - lines[0].length;\n      selectionStart = selectionEnd = textarea.selectionStart - lengthDiff;\n      textarea.selectionStart = startOfLine;\n      textarea.selectionEnd = endOfLine;\n    }\n  } else {\n    lines = (function () {\n      let i;\n      let len;\n      let index;\n      const results = [];\n      for (index = i = 0, len = lines.length; i < len; index = ++i) {\n        const line = lines[index];\n        results.push(`${index + 1}. ${line}`);\n      }\n      return results;\n    })();\n    text = lines.join('\\n');\n    const {\n      newlinesToAppend,\n      newlinesToPrepend,\n    } = newlinesToSurroundSelectedText(textarea);\n    selectionStart = textarea.selectionStart + newlinesToAppend.length;\n    selectionEnd = selectionStart + text.length;\n    if (noInitialSelection) selectionStart = selectionEnd;\n    text = newlinesToAppend + text + newlinesToPrepend;\n  }\n\n  return { text, selectionStart, selectionEnd };\n}\n\nexport default MarkdownActions;\n"]}]}