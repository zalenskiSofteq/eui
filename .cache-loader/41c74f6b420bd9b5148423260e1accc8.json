{"remainingRequest":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!D:\\work\\eui\\src\\components\\resizable_container\\helpers.ts","dependencies":[{"path":"D:\\work\\eui\\src\\components\\resizable_container\\helpers.ts","mtime":1649070093740},{"path":"D:\\work\\eui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636976621750},{"path":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js","mtime":1649070120649}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudmFsdWVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucGFyc2UtaW50IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQoKZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH0KCmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gInVuZGVmaW5lZCIgfHwgIShTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGFycikpKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX2UgPSB1bmRlZmluZWQ7IHRyeSB7IGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsgX2Fyci5wdXNoKF9zLnZhbHVlKTsgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9IHRydWU7IF9lID0gZXJyOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsgfSBmaW5hbGx5IHsgaWYgKF9kKSB0aHJvdyBfZTsgfSB9IHJldHVybiBfYXJyOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCi8qCiAqIExpY2Vuc2VkIHRvIEVsYXN0aWNzZWFyY2ggQi5WLiB1bmRlciBvbmUgb3IgbW9yZSBjb250cmlidXRvcgogKiBsaWNlbnNlIGFncmVlbWVudHMuIFNlZSB0aGUgTk9USUNFIGZpbGUgZGlzdHJpYnV0ZWQgd2l0aAogKiB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcmVnYXJkaW5nIGNvcHlyaWdodAogKiBvd25lcnNoaXAuIEVsYXN0aWNzZWFyY2ggQi5WLiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyCiAqIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5CiAqIG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwppbXBvcnQgeyB1c2VNZW1vLCB1c2VSZWR1Y2VyIH0gZnJvbSAncmVhY3QnOwppbXBvcnQgeyBhc3NlcnROZXZlciB9IGZyb20gJy4uL2NvbW1vbic7CgpmdW5jdGlvbiBpc01vdXNlRXZlbnQoZXZlbnQpIHsKICByZXR1cm4gX3R5cGVvZihldmVudCkgPT09ICdvYmplY3QnICYmICdwYWdlWCcgaW4gZXZlbnQgJiYgJ3BhZ2VZJyBpbiBldmVudDsKfQoKZXhwb3J0IHZhciBweFRvUGVyY2VudCA9IGZ1bmN0aW9uIHB4VG9QZXJjZW50KHByb3BvcnRpb24sIHdob2xlKSB7CiAgaWYgKHdob2xlIDwgMSB8fCBwcm9wb3J0aW9uIDwgMCkgcmV0dXJuIDA7CiAgcmV0dXJuIHByb3BvcnRpb24gLyB3aG9sZSAqIDEwMDsKfTsKZXhwb3J0IHZhciBzaXplc09ubHkgPSBmdW5jdGlvbiBzaXplc09ubHkocGFuZWxPYmplY3QpIHsKICByZXR1cm4gT2JqZWN0LnZhbHVlcyhwYW5lbE9iamVjdCkucmVkdWNlKGZ1bmN0aW9uIChvdXQsIHBhbmVsKSB7CiAgICBvdXRbcGFuZWwuaWRdID0gcGFuZWwuc2l6ZTsKICAgIHJldHVybiBvdXQ7CiAgfSwge30pOwp9OwoKdmFyIF9nZXRQYW5lbE1pblNpemUgPSBmdW5jdGlvbiBfZ2V0UGFuZWxNaW5TaXplKHBhbmVsTWluU2l6ZSwgY29udGFpbmVyU2l6ZSkgewogIHZhciBwYW5lbE1pblNpemVQZXJjZW50ID0gMDsKICB2YXIgcGFuZWxNaW5TaXplSW50ID0gcGFyc2VJbnQocGFuZWxNaW5TaXplKTsKCiAgaWYgKHBhbmVsTWluU2l6ZS5pbmRleE9mKCdweCcpID4gLTEpIHsKICAgIHBhbmVsTWluU2l6ZVBlcmNlbnQgPSBweFRvUGVyY2VudChwYW5lbE1pblNpemVJbnQsIGNvbnRhaW5lclNpemUpOwogIH0gZWxzZSBpZiAocGFuZWxNaW5TaXplLmluZGV4T2YoJyUnKSA+IC0xKSB7CiAgICBwYW5lbE1pblNpemVQZXJjZW50ID0gcHhUb1BlcmNlbnQoY29udGFpbmVyU2l6ZSAqIChwYW5lbE1pblNpemVJbnQgLyAxMDApLCBjb250YWluZXJTaXplKTsKICB9CgogIHJldHVybiBwYW5lbE1pblNpemVQZXJjZW50Owp9OwoKZXhwb3J0IHZhciBnZXRQYW5lbE1pblNpemUgPSBmdW5jdGlvbiBnZXRQYW5lbE1pblNpemUocGFuZWxNaW5TaXplLCBjb250YWluZXJTaXplKSB7CiAgdmFyIHBhZGRpbmdNaW4gPSBfZ2V0UGFuZWxNaW5TaXplKHBhbmVsTWluU2l6ZVsxXSwgY29udGFpbmVyU2l6ZSk7CgogIHZhciBjb25maWdNaW4gPSBfZ2V0UGFuZWxNaW5TaXplKHBhbmVsTWluU2l6ZVswXSwgY29udGFpbmVyU2l6ZSk7CgogIHJldHVybiBNYXRoLm1heChjb25maWdNaW4sIHBhZGRpbmdNaW4pOwp9OwpleHBvcnQgdmFyIGdldFBvc2l0aW9uID0gZnVuY3Rpb24gZ2V0UG9zaXRpb24oZXZlbnQsIGlzSG9yaXpvbnRhbCkgewogIHZhciBjbGllbnRYID0gaXNNb3VzZUV2ZW50KGV2ZW50KSA/IGV2ZW50LmNsaWVudFggOiBldmVudC50b3VjaGVzWzBdLmNsaWVudFg7CiAgdmFyIGNsaWVudFkgPSBpc01vdXNlRXZlbnQoZXZlbnQpID8gZXZlbnQuY2xpZW50WSA6IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WTsKICByZXR1cm4gaXNIb3Jpem9udGFsID8gY2xpZW50WCA6IGNsaWVudFk7Cn07Cgp2YXIgZ2V0U2libGluZ1BhbmVsID0gZnVuY3Rpb24gZ2V0U2libGluZ1BhbmVsKGVsZW1lbnQsIGFkamFjZW5jeSkgewogIGlmICghZWxlbWVudCkgcmV0dXJuIG51bGw7CiAgdmFyIG1ldGhvZCA9IGFkamFjZW5jeSA9PT0gJ3ByZXYnID8gJ3ByZXZpb3VzRWxlbWVudFNpYmxpbmcnIDogJ25leHRFbGVtZW50U2libGluZyc7CiAgdmFyIHNpYmxpbmcgPSBlbGVtZW50W21ldGhvZF07CgogIHdoaWxlIChzaWJsaW5nKSB7CiAgICBpZiAoc2libGluZy5tYXRjaGVzKCcuZXVpUmVzaXphYmxlUGFuZWw6bm90KC5ldWlSZXNpemFibGVQYW5lbC1pc0NvbGxhcHNlZCknKSkgewogICAgICByZXR1cm4gc2libGluZzsKICAgIH0KCiAgICBzaWJsaW5nID0gc2libGluZ1ttZXRob2RdOwogIH0KfTsgLy8gbGF6eSBpbml0aWFsaXphdGlvbiB0byBwcmV2ZW50IHJlcmVuZGVyIG9uIGluaXRpYWwgaW50ZXJhY3Rpb24KCgp2YXIgaW5pdCA9IGZ1bmN0aW9uIGluaXQoc3RhdGUpIHsKICByZXR1cm4gc3RhdGU7Cn07CgpleHBvcnQgdmFyIHVzZUNvbnRhaW5lckNhbGxiYWNrcyA9IGZ1bmN0aW9uIHVzZUNvbnRhaW5lckNhbGxiYWNrcyhfcmVmKSB7CiAgdmFyIGluaXRpYWxTdGF0ZSA9IF9yZWYuaW5pdGlhbFN0YXRlLAogICAgICBjb250YWluZXJSZWYgPSBfcmVmLmNvbnRhaW5lclJlZiwKICAgICAgb25QYW5lbFdpZHRoQ2hhbmdlID0gX3JlZi5vblBhbmVsV2lkdGhDaGFuZ2U7CgogIGZ1bmN0aW9uIHJlZHVjZXIoc3RhdGUsIGFjdGlvbikgewogICAgdmFyIGdldENvbnRhaW5lclNpemUgPSBmdW5jdGlvbiBnZXRDb250YWluZXJTaXplKGlzSG9yaXpvbnRhbCkgewogICAgICByZXR1cm4gaXNIb3Jpem9udGFsID8gY29udGFpbmVyUmVmLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggOiBjb250YWluZXJSZWYuY3VycmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7CiAgICB9OwoKICAgIHZhciBydW5TaWRlRWZmZWN0ID0gZnVuY3Rpb24gcnVuU2lkZUVmZmVjdChwYW5lbHMpIHsKICAgICAgaWYgKG9uUGFuZWxXaWR0aENoYW5nZSkgewogICAgICAgIG9uUGFuZWxXaWR0aENoYW5nZShzaXplc09ubHkocGFuZWxzKSk7CiAgICAgIH0KICAgIH07CgogICAgdmFyIHdpdGhTaWRlRWZmZWN0ID0gZnVuY3Rpb24gd2l0aFNpZGVFZmZlY3QobmV3U3RhdGUpIHsKICAgICAgcnVuU2lkZUVmZmVjdChuZXdTdGF0ZS5wYW5lbHMpOwogICAgICByZXR1cm4gbmV3U3RhdGU7CiAgICB9OwoKICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHsKICAgICAgY2FzZSAnRVVJX1JFU0laQUJMRV9DT05UQUlORVJfSU5JVCc6CiAgICAgICAgewogICAgICAgICAgdmFyIGlzSG9yaXpvbnRhbCA9IGFjdGlvbi5wYXlsb2FkLmlzSG9yaXpvbnRhbDsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlKSwge30sIHsKICAgICAgICAgICAgaXNIb3Jpem9udGFsOiBpc0hvcml6b250YWwsCiAgICAgICAgICAgIGNvbnRhaW5lclNpemU6IGdldENvbnRhaW5lclNpemUoaXNIb3Jpem9udGFsKQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgY2FzZSAnRVVJX1JFU0laQUJMRV9QQU5FTF9SRUdJU1RFUic6CiAgICAgICAgewogICAgICAgICAgdmFyIHBhbmVsID0gYWN0aW9uLnBheWxvYWQucGFuZWw7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZSksIHt9LCB7CiAgICAgICAgICAgIHBhbmVsczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZS5wYW5lbHMpLCB7fSwgX2RlZmluZVByb3BlcnR5KHt9LCBwYW5lbC5pZCwgcGFuZWwpKQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgY2FzZSAnRVVJX1JFU0laQUJMRV9QQU5FTF9ERVJFR0lTVEVSJzoKICAgICAgICB7CiAgICAgICAgICB2YXIgcGFuZWxJZCA9IGFjdGlvbi5wYXlsb2FkLnBhbmVsSWQ7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZSksIHt9LCB7CiAgICAgICAgICAgIHBhbmVsczogT2JqZWN0LnZhbHVlcyhzdGF0ZS5wYW5lbHMpLnJlZHVjZShmdW5jdGlvbiAob3V0LCBwYW5lbCkgewogICAgICAgICAgICAgIGlmIChwYW5lbC5pZCAhPT0gcGFuZWxJZCkgewogICAgICAgICAgICAgICAgb3V0W3BhbmVsLmlkXSA9IHBhbmVsOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfSwge30pCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICBjYXNlICdFVUlfUkVTSVpBQkxFX0JVVFRPTl9SRUdJU1RFUic6CiAgICAgICAgewogICAgICAgICAgdmFyIHJlc2l6ZXIgPSBhY3Rpb24ucGF5bG9hZC5yZXNpemVyOwogICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUpLCB7fSwgewogICAgICAgICAgICByZXNpemVyczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZS5yZXNpemVycyksIHt9LCBfZGVmaW5lUHJvcGVydHkoe30sIHJlc2l6ZXIuaWQsIHJlc2l6ZXIpKQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgY2FzZSAnRVVJX1JFU0laQUJMRV9CVVRUT05fREVSRUdJU1RFUic6CiAgICAgICAgewogICAgICAgICAgdmFyIHJlc2l6ZXJJZCA9IGFjdGlvbi5wYXlsb2FkLnJlc2l6ZXJJZDsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlKSwge30sIHsKICAgICAgICAgICAgcmVzaXplcnM6IE9iamVjdC52YWx1ZXMoc3RhdGUucmVzaXplcnMpLnJlZHVjZShmdW5jdGlvbiAob3V0LCBwYW5lbCkgewogICAgICAgICAgICAgIGlmIChwYW5lbC5pZCAhPT0gcmVzaXplcklkKSB7CiAgICAgICAgICAgICAgICBvdXRbcGFuZWwuaWRdID0gcGFuZWw7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgICAgICB9LCB7fSkKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ0VVSV9SRVNJWkFCTEVfRFJBR19TVEFSVCc6CiAgICAgICAgewogICAgICAgICAgdmFyIF9hY3Rpb24kcGF5bG9hZCA9IGFjdGlvbi5wYXlsb2FkLAogICAgICAgICAgICAgIHBvc2l0aW9uID0gX2FjdGlvbiRwYXlsb2FkLnBvc2l0aW9uLAogICAgICAgICAgICAgIHByZXZQYW5lbElkID0gX2FjdGlvbiRwYXlsb2FkLnByZXZQYW5lbElkLAogICAgICAgICAgICAgIG5leHRQYW5lbElkID0gX2FjdGlvbiRwYXlsb2FkLm5leHRQYW5lbElkOwogICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUpLCB7fSwgewogICAgICAgICAgICBpc0RyYWdnaW5nOiB0cnVlLAogICAgICAgICAgICBjdXJyZW50UmVzaXplclBvczogcG9zaXRpb24sCiAgICAgICAgICAgIHByZXZQYW5lbElkOiBwcmV2UGFuZWxJZCwKICAgICAgICAgICAgbmV4dFBhbmVsSWQ6IG5leHRQYW5lbElkCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICBjYXNlICdFVUlfUkVTSVpBQkxFX0RSQUdfTU9WRSc6CiAgICAgICAgewogICAgICAgICAgaWYgKCFzdGF0ZS5pc0RyYWdnaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgX2FjdGlvbiRwYXlsb2FkMiA9IGFjdGlvbi5wYXlsb2FkLAogICAgICAgICAgICAgIF9wb3NpdGlvbiA9IF9hY3Rpb24kcGF5bG9hZDIucG9zaXRpb24sCiAgICAgICAgICAgICAgX3ByZXZQYW5lbElkID0gX2FjdGlvbiRwYXlsb2FkMi5wcmV2UGFuZWxJZCwKICAgICAgICAgICAgICBfbmV4dFBhbmVsSWQgPSBfYWN0aW9uJHBheWxvYWQyLm5leHRQYW5lbElkOwogICAgICAgICAgdmFyIHByZXZQYW5lbCA9IHN0YXRlLnBhbmVsc1tfcHJldlBhbmVsSWRdOwogICAgICAgICAgdmFyIG5leHRQYW5lbCA9IHN0YXRlLnBhbmVsc1tfbmV4dFBhbmVsSWRdOwogICAgICAgICAgdmFyIGRlbHRhID0gX3Bvc2l0aW9uIC0gc3RhdGUuY3VycmVudFJlc2l6ZXJQb3M7CiAgICAgICAgICB2YXIgcHJldlBhbmVsTWluID0gZ2V0UGFuZWxNaW5TaXplKHByZXZQYW5lbC5taW5TaXplLCBzdGF0ZS5jb250YWluZXJTaXplKTsKICAgICAgICAgIHZhciBuZXh0UGFuZWxNaW4gPSBnZXRQYW5lbE1pblNpemUobmV4dFBhbmVsLm1pblNpemUsIHN0YXRlLmNvbnRhaW5lclNpemUpOwogICAgICAgICAgdmFyIHByZXZQYW5lbFNpemUgPSBweFRvUGVyY2VudChwcmV2UGFuZWwuZ2V0U2l6ZVB4KCkgKyBkZWx0YSwgc3RhdGUuY29udGFpbmVyU2l6ZSk7CiAgICAgICAgICB2YXIgbmV4dFBhbmVsU2l6ZSA9IHB4VG9QZXJjZW50KG5leHRQYW5lbC5nZXRTaXplUHgoKSAtIGRlbHRhLCBzdGF0ZS5jb250YWluZXJTaXplKTsKCiAgICAgICAgICBpZiAocHJldlBhbmVsU2l6ZSA+PSBwcmV2UGFuZWxNaW4gJiYgbmV4dFBhbmVsU2l6ZSA+PSBuZXh0UGFuZWxNaW4pIHsKICAgICAgICAgICAgdmFyIF9vYmplY3RTcHJlYWQ0OwoKICAgICAgICAgICAgcmV0dXJuIHdpdGhTaWRlRWZmZWN0KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUpLCB7fSwgewogICAgICAgICAgICAgIGN1cnJlbnRSZXNpemVyUG9zOiBfcG9zaXRpb24sCiAgICAgICAgICAgICAgcGFuZWxzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLnBhbmVscyksIHt9LCAoX29iamVjdFNwcmVhZDQgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9vYmplY3RTcHJlYWQ0LCBfcHJldlBhbmVsSWQsIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUucGFuZWxzW19wcmV2UGFuZWxJZF0pLCB7fSwgewogICAgICAgICAgICAgICAgc2l6ZTogcHJldlBhbmVsU2l6ZQogICAgICAgICAgICAgIH0pKSwgX2RlZmluZVByb3BlcnR5KF9vYmplY3RTcHJlYWQ0LCBfbmV4dFBhbmVsSWQsIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUucGFuZWxzW19uZXh0UGFuZWxJZF0pLCB7fSwgewogICAgICAgICAgICAgICAgc2l6ZTogbmV4dFBhbmVsU2l6ZQogICAgICAgICAgICAgIH0pKSwgX29iamVjdFNwcmVhZDQpKQogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ0VVSV9SRVNJWkFCTEVfS0VZX01PVkUnOgogICAgICAgIHsKICAgICAgICAgIHZhciBfYWN0aW9uJHBheWxvYWQzID0gYWN0aW9uLnBheWxvYWQsCiAgICAgICAgICAgICAgX3ByZXZQYW5lbElkMiA9IF9hY3Rpb24kcGF5bG9hZDMucHJldlBhbmVsSWQsCiAgICAgICAgICAgICAgX25leHRQYW5lbElkMiA9IF9hY3Rpb24kcGF5bG9hZDMubmV4dFBhbmVsSWQsCiAgICAgICAgICAgICAgZGlyZWN0aW9uID0gX2FjdGlvbiRwYXlsb2FkMy5kaXJlY3Rpb247CiAgICAgICAgICB2YXIgX3ByZXZQYW5lbCA9IHN0YXRlLnBhbmVsc1tfcHJldlBhbmVsSWQyXTsKICAgICAgICAgIHZhciBfbmV4dFBhbmVsID0gc3RhdGUucGFuZWxzW19uZXh0UGFuZWxJZDJdOwoKICAgICAgICAgIHZhciBfcHJldlBhbmVsTWluID0gZ2V0UGFuZWxNaW5TaXplKF9wcmV2UGFuZWwubWluU2l6ZSwgc3RhdGUuY29udGFpbmVyU2l6ZSk7CgogICAgICAgICAgdmFyIF9uZXh0UGFuZWxNaW4gPSBnZXRQYW5lbE1pblNpemUoX25leHRQYW5lbC5taW5TaXplLCBzdGF0ZS5jb250YWluZXJTaXplKTsKCiAgICAgICAgICB2YXIgX3ByZXZQYW5lbFNpemUgPSBweFRvUGVyY2VudChfcHJldlBhbmVsLmdldFNpemVQeCgpIC0gKGRpcmVjdGlvbiA9PT0gJ2JhY2t3YXJkJyA/IDEwIDogLTEwKSwgc3RhdGUuY29udGFpbmVyU2l6ZSk7CgogICAgICAgICAgdmFyIF9uZXh0UGFuZWxTaXplID0gcHhUb1BlcmNlbnQoX25leHRQYW5lbC5nZXRTaXplUHgoKSAtIChkaXJlY3Rpb24gPT09ICdmb3J3YXJkJyA/IDEwIDogLTEwKSwgc3RhdGUuY29udGFpbmVyU2l6ZSk7CgogICAgICAgICAgaWYgKF9wcmV2UGFuZWxTaXplID49IF9wcmV2UGFuZWxNaW4gJiYgX25leHRQYW5lbFNpemUgPj0gX25leHRQYW5lbE1pbikgewogICAgICAgICAgICB2YXIgX29iamVjdFNwcmVhZDU7CgogICAgICAgICAgICByZXR1cm4gd2l0aFNpZGVFZmZlY3QoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZSksIHt9LCB7CiAgICAgICAgICAgICAgaXNEcmFnZ2luZzogZmFsc2UsCiAgICAgICAgICAgICAgcGFuZWxzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLnBhbmVscyksIHt9LCAoX29iamVjdFNwcmVhZDUgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9vYmplY3RTcHJlYWQ1LCBfcHJldlBhbmVsSWQyLCBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLnBhbmVsc1tfcHJldlBhbmVsSWQyXSksIHt9LCB7CiAgICAgICAgICAgICAgICBzaXplOiBfcHJldlBhbmVsU2l6ZQogICAgICAgICAgICAgIH0pKSwgX2RlZmluZVByb3BlcnR5KF9vYmplY3RTcHJlYWQ1LCBfbmV4dFBhbmVsSWQyLCBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLnBhbmVsc1tfbmV4dFBhbmVsSWQyXSksIHt9LCB7CiAgICAgICAgICAgICAgICBzaXplOiBfbmV4dFBhbmVsU2l6ZQogICAgICAgICAgICAgIH0pKSwgX29iamVjdFNwcmVhZDUpKQogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ0VVSV9SRVNJWkFCTEVfVE9HR0xFJzoKICAgICAgICB7CiAgICAgICAgICB2YXIgX2FjdGlvbiRwYXlsb2FkNCA9IGFjdGlvbi5wYXlsb2FkLAogICAgICAgICAgICAgIG9wdGlvbnMgPSBfYWN0aW9uJHBheWxvYWQ0Lm9wdGlvbnMsCiAgICAgICAgICAgICAgY3VycmVudFBhbmVsSWQgPSBfYWN0aW9uJHBheWxvYWQ0LnBhbmVsSWQ7CiAgICAgICAgICB2YXIgY3VycmVudFBhbmVsID0gc3RhdGUucGFuZWxzW2N1cnJlbnRQYW5lbElkXTsKICAgICAgICAgIHZhciBzaG91bGRDb2xsYXBzZSA9ICFjdXJyZW50UGFuZWwuaXNDb2xsYXBzZWQ7CiAgICAgICAgICB2YXIgcGFuZWxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY3VycmVudFBhbmVsSWQpOwogICAgICAgICAgdmFyIHByZXZSZXNpemVyID0gcGFuZWxFbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7CgogICAgICAgICAgdmFyIF9wcmV2UGFuZWwyID0gcHJldlJlc2l6ZXIgPyBwcmV2UmVzaXplci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nIDogbnVsbDsKCiAgICAgICAgICB2YXIgbmV4dFJlc2l6ZXIgPSBwYW5lbEVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nOwoKICAgICAgICAgIHZhciBfbmV4dFBhbmVsMiA9IG5leHRSZXNpemVyID8gbmV4dFJlc2l6ZXIubmV4dEVsZW1lbnRTaWJsaW5nIDogbnVsbDsKCiAgICAgICAgICB2YXIgcmVzaXplcnNUb0Rpc2FibGUgPSB7fTsKCiAgICAgICAgICBpZiAocHJldlJlc2l6ZXIgJiYgX3ByZXZQYW5lbDIpIHsKICAgICAgICAgICAgcmVzaXplcnNUb0Rpc2FibGVbcHJldlJlc2l6ZXIuaWRdID0gc3RhdGUucGFuZWxzW19wcmV2UGFuZWwyLmlkXS5pc0NvbGxhcHNlZCA/IHRydWUgOiBzaG91bGRDb2xsYXBzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobmV4dFJlc2l6ZXIgJiYgX25leHRQYW5lbDIpIHsKICAgICAgICAgICAgcmVzaXplcnNUb0Rpc2FibGVbbmV4dFJlc2l6ZXIuaWRdID0gc3RhdGUucGFuZWxzW19uZXh0UGFuZWwyLmlkXS5pc0NvbGxhcHNlZCA/IHRydWUgOiBzaG91bGRDb2xsYXBzZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgb3RoZXJQYW5lbHMgPSB7fTsKCiAgICAgICAgICBpZiAoX3ByZXZQYW5lbDIgJiYgIXN0YXRlLnBhbmVsc1tfcHJldlBhbmVsMi5pZF0uaXNDb2xsYXBzZWQgJiYgb3B0aW9ucy5kaXJlY3Rpb24gPT09ICdyaWdodCcpIHsKICAgICAgICAgICAgb3RoZXJQYW5lbHNbX3ByZXZQYW5lbDIuaWRdID0gc3RhdGUucGFuZWxzW19wcmV2UGFuZWwyLmlkXTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoX25leHRQYW5lbDIgJiYgIXN0YXRlLnBhbmVsc1tfbmV4dFBhbmVsMi5pZF0uaXNDb2xsYXBzZWQgJiYgb3B0aW9ucy5kaXJlY3Rpb24gPT09ICdsZWZ0JykgewogICAgICAgICAgICBvdGhlclBhbmVsc1tfbmV4dFBhbmVsMi5pZF0gPSBzdGF0ZS5wYW5lbHNbX25leHRQYW5lbDIuaWRdOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBzaWJsaW5ncyA9IE9iamVjdC5rZXlzKG90aGVyUGFuZWxzKS5sZW5ndGg7IC8vIEEgdG9nZ2xpbmcgc2VxdWVuY2UgaGFzIG9jY3VycmVkIHdoZXJlIGFuIGltbWVkaWF0ZSBzaWJsaW5nIHBhbmVsCiAgICAgICAgICAvLyBoYXMgbm90IGJlZW4gZm91bmQuIFdlIG5lZWQgdG8gbW92ZSBtb3JlIGJyb2FkbHkgdGhyb3VnaCB0aGUgRE9NCiAgICAgICAgICAvLyB0byBmaW5kIHRoZSBuZXh0IG1vc3Qgc3VpdGFibGUgcGFuZWwgb3Igc3BhY2UgYWZmb3JkYW5jZS4KICAgICAgICAgIC8vIENhbiBvbmx5IG9jY3VyIHdoZW4gbXVsdGlwbGUgaW1tZWRpYXRlIHNpYmxpbmcgcGFuZWxzIGFyZSBjb2xsYXBzZWQuCgogICAgICAgICAgaWYgKCFzaWJsaW5ncykgewogICAgICAgICAgICB2YXIgbWF5YmVQcmV2UGFuZWwgPSBnZXRTaWJsaW5nUGFuZWwocGFuZWxFbGVtZW50LCAncHJldicpOwogICAgICAgICAgICB2YXIgbWF5YmVOZXh0UGFuZWwgPSBnZXRTaWJsaW5nUGFuZWwocGFuZWxFbGVtZW50LCAnbmV4dCcpOwogICAgICAgICAgICB2YXIgdmFsaWRQcmV2UGFuZWwgPSBtYXliZVByZXZQYW5lbCA/IHN0YXRlLnBhbmVsc1ttYXliZVByZXZQYW5lbC5pZF0gOiBudWxsOwogICAgICAgICAgICB2YXIgdmFsaWROZXh0UGFuZWwgPSBtYXliZU5leHRQYW5lbCA/IHN0YXRlLnBhbmVsc1ttYXliZU5leHRQYW5lbC5pZF0gOiBudWxsOyAvLyBJbnRlbnRpb25hbCwgcHJlZmVyZW50aWFsIHJlZGlzdHJpYnV0aW9uIG9yZGVyCgogICAgICAgICAgICBpZiAodmFsaWRQcmV2UGFuZWwgJiYgb3B0aW9ucy5kaXJlY3Rpb24gPT09ICdyaWdodCcpIHsKICAgICAgICAgICAgICBvdGhlclBhbmVsc1t2YWxpZFByZXZQYW5lbC5pZF0gPSB2YWxpZFByZXZQYW5lbDsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWxpZE5leHRQYW5lbCAmJiBvcHRpb25zLmRpcmVjdGlvbiA9PT0gJ2xlZnQnKSB7CiAgICAgICAgICAgICAgb3RoZXJQYW5lbHNbdmFsaWROZXh0UGFuZWwuaWRdID0gdmFsaWROZXh0UGFuZWw7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKHZhbGlkUHJldlBhbmVsKSBvdGhlclBhbmVsc1t2YWxpZFByZXZQYW5lbC5pZF0gPSB2YWxpZFByZXZQYW5lbDsKICAgICAgICAgICAgICBpZiAodmFsaWROZXh0UGFuZWwpIG90aGVyUGFuZWxzW3ZhbGlkTmV4dFBhbmVsLmlkXSA9IHZhbGlkTmV4dFBhbmVsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzaWJsaW5ncyA9IE9iamVjdC5rZXlzKG90aGVyUGFuZWxzKS5sZW5ndGg7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG5ld1BhbmVsU2l6ZSA9IHNob3VsZENvbGxhcHNlID8gcHhUb1BlcmNlbnQoIWN1cnJlbnRQYW5lbC5tb2RlID8gMCA6IDI0LCAvLyBzaXplIG9mIHRoZSBkZWZhdWx0IHRvZ2dsZSBidXR0b24KICAgICAgICAgIHN0YXRlLmNvbnRhaW5lclNpemUpIDogY3VycmVudFBhbmVsLnByZXZTaXplOwoKICAgICAgICAgIHZhciBfZGVsdGEgPSBzaG91bGRDb2xsYXBzZSA/IChjdXJyZW50UGFuZWwuc2l6ZSAtIG5ld1BhbmVsU2l6ZSkgLyBzaWJsaW5ncyA6IChuZXdQYW5lbFNpemUgLSBjdXJyZW50UGFuZWwuc2l6ZSkgLyBzaWJsaW5ncyAqIC0xOwoKICAgICAgICAgIHZhciBjb2xsYXBzZWRQYW5lbHNTaXplID0gT2JqZWN0LnZhbHVlcyhzdGF0ZS5wYW5lbHMpLnJlZHVjZShmdW5jdGlvbiAoc3VtLCBwYW5lbCkgewogICAgICAgICAgICBpZiAocGFuZWwuaWQgIT09IGN1cnJlbnRQYW5lbElkICYmIHBhbmVsLmlzQ29sbGFwc2VkKSB7CiAgICAgICAgICAgICAgc3VtICs9IHBhbmVsLnNpemU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBzdW07CiAgICAgICAgICB9LCAwKTsgLy8gQSB0b2dnbGluZyBzZXF1ZW5jZSBoYXMgb2NjdXJyZWQgd2hlcmUgYSB0by1iZS1vcGVuZWQgcGFuZWwgd2lsbAogICAgICAgICAgLy8gYmVjb21lIHRoZSBvbmx5IG9wZW4gcGFuZWwuIFJhdGhlciB0aGFuIHJlb3BlbiB0byBpdHMgcHJldmlvdXMKICAgICAgICAgIC8vIHNpemUsIGdpdmUgaXQgdGhlIGZ1bGwgd2lkdGgsIGxlc3Mgc2l6ZSBvY2N1cGllZCBieSBjb2xsYXBzZWQgcGFuZWxzLgogICAgICAgICAgLy8gQ2FuIG9ubHkgb2NjdXIgd2l0aCBleHRlcm5hbCB0b2dnbGluZy4KCiAgICAgICAgICBpZiAoIXNob3VsZENvbGxhcHNlICYmICFzaWJsaW5ncykgewogICAgICAgICAgICBuZXdQYW5lbFNpemUgPSAxMDAgLSBjb2xsYXBzZWRQYW5lbHNTaXplOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB1cGRhdGVkUGFuZWxzID0ge307CgogICAgICAgICAgaWYgKF9kZWx0YSA8IDAgJiYgT2JqZWN0LnZhbHVlcyhvdGhlclBhbmVscykuc29tZShmdW5jdGlvbiAocGFuZWwpIHsKICAgICAgICAgICAgcmV0dXJuIHBhbmVsLnNpemUgKyBfZGVsdGEgPCBnZXRQYW5lbE1pblNpemUocGFuZWwubWluU2l6ZSwgc3RhdGUuY29udGFpbmVyU2l6ZSk7CiAgICAgICAgICB9KSkgewogICAgICAgICAgICAvLyBBIHRvZ2dsaW5nIHNlcXVlbmNlIGhhcyBvY2N1cnJlZCB3aGVyZSBhIHRvLWJlLW9wZW5lZCBwYW5lbCBpcwogICAgICAgICAgICAvLyByZXF1ZXN0aW5nIG1vcmUgc3BhY2UgdGhhbiBpdHMgbG9naWNhbCBzaWJsaW5nIHBhbmVsIGNhbiBhZmZvcmQuCiAgICAgICAgICAgIC8vIFJhdGhlciB0aGFuIGNob29zZSBhbm90aGVyIHNpbmdsZSBwYW5lbCB0byBzYWNyaWZpY2Ugc3BhY2UsCiAgICAgICAgICAgIC8vIG9yIHRyeSB0byBwdWxsIHByb3BvcnRpb25hbGx5IGZyb20gYWxsIGF2YWlsYmxlIHBhbmVscwogICAgICAgICAgICAvLyAobmVpdGhlciBvZiB3aGljaCBpcyBndWFyYW50ZWVkIHRvIHByZXZlbnQgbmVnYXRpdmUgcmVzdWx0aW5nIHdpZHRocyksCiAgICAgICAgICAgIC8vIG9yIGF0dGVtcHQgc29tZXRoaW5nIGV2ZW4gbW9yZSBjb21wbGV4LAogICAgICAgICAgICAvLyB3ZSByZWRpc3RyaWJ1dGUgX2FsbF8gc3BhY2UgZXZlbmx5IHRvIG5vbi1jb2xsYXBzZWQgcGFuZWxzCiAgICAgICAgICAgIC8vIGFzIHNvbWV0aGluZyBvZiBhIHJlc2V0LgogICAgICAgICAgICAvLyBUaGlzIHNpdHVhdGlvbiBjYW4gb25seSBvY2N1ciB3aGVuIChuLTEpIHBhbmVscyBhcmUgY29sbGFwc2VkIGF0IG9uY2UKICAgICAgICAgICAgLy8gYW5kIHRoZSBtb3N0IHJlY2VudGx5IGNvbGxhcHNlZCBwYW5lbCBnYWlucyBzaWduaWZpY2FudCB3aWR0aAogICAgICAgICAgICAvLyBkdXJpbmcgdGhlIHByZXZpb3VzbHkgb2NjdXJyaW5nIGNvbGxhcHNlLgogICAgICAgICAgICAvLyBUaGF0IGlzIChsYXJnZWx5KSwgZXh0ZXJuYWwgdG9nZ2xpbmcgd2hlcmUgdGhlIGRlZmF1bHQgbG9naWMgaGFzCiAgICAgICAgICAgIC8vIGJlZW4gbmVnYXRlZCBieSB0aGUgbGFjayBvZiBwYW5lbCBtb2RlIGRpc3RpbmN0aW9uLgogICAgICAgICAgICBvdGhlclBhbmVscyA9IE9iamVjdC52YWx1ZXMoc3RhdGUucGFuZWxzKS5yZWR1Y2UoZnVuY3Rpb24gKG91dCwgcGFuZWwpIHsKICAgICAgICAgICAgICBpZiAocGFuZWwuaWQgIT09IGN1cnJlbnRQYW5lbElkICYmICFwYW5lbC5pc0NvbGxhcHNlZCkgewogICAgICAgICAgICAgICAgb3V0W3BhbmVsLmlkXSA9IF9vYmplY3RTcHJlYWQoe30sIHBhbmVsKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0sIHt9KTsKICAgICAgICAgICAgbmV3UGFuZWxTaXplID0gKDEwMCAtIGNvbGxhcHNlZFBhbmVsc1NpemUpIC8gKE9iamVjdC5rZXlzKG90aGVyUGFuZWxzKS5sZW5ndGggKyAxKTsKICAgICAgICAgICAgdXBkYXRlZFBhbmVscyA9IE9iamVjdC52YWx1ZXMob3RoZXJQYW5lbHMpLnJlZHVjZShmdW5jdGlvbiAob3V0LCBwYW5lbCkgewogICAgICAgICAgICAgIG91dFtwYW5lbC5pZF0gPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHBhbmVsKSwge30sIHsKICAgICAgICAgICAgICAgIHNpemU6IG5ld1BhbmVsU2l6ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0sIHt9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEEgdG9nZ2xpbmcgc2VxdWVuY2UgaGFzIG9jY3VycmVkIHRoYXQgaXMgc3RhbmRhcmQgYW5kIHByZWRpY3RhYmxlCiAgICAgICAgICAgIHVwZGF0ZWRQYW5lbHMgPSBPYmplY3QudmFsdWVzKG90aGVyUGFuZWxzKS5yZWR1Y2UoZnVuY3Rpb24gKG91dCwgcGFuZWwpIHsKICAgICAgICAgICAgICBvdXRbcGFuZWwuaWRdID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBwYW5lbCksIHt9LCB7CiAgICAgICAgICAgICAgICBzaXplOiBwYW5lbC5zaXplICsgX2RlbHRhCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfSwge30pOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB3aXRoU2lkZUVmZmVjdChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlKSwge30sIHsKICAgICAgICAgICAgcGFuZWxzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUucGFuZWxzKSwgdXBkYXRlZFBhbmVscyksIHt9LCBfZGVmaW5lUHJvcGVydHkoe30sIGN1cnJlbnRQYW5lbElkLCBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLnBhbmVsc1tjdXJyZW50UGFuZWxJZF0pLCB7fSwgewogICAgICAgICAgICAgIHNpemU6IG5ld1BhbmVsU2l6ZSwKICAgICAgICAgICAgICBpc0NvbGxhcHNlZDogc2hvdWxkQ29sbGFwc2UsCiAgICAgICAgICAgICAgcHJldlNpemU6IHNob3VsZENvbGxhcHNlID8gY3VycmVudFBhbmVsLnNpemUgOiBuZXdQYW5lbFNpemUKICAgICAgICAgICAgfSkpKSwKICAgICAgICAgICAgcmVzaXplcnM6IE9iamVjdC52YWx1ZXMoc3RhdGUucmVzaXplcnMpLnJlZHVjZShmdW5jdGlvbiAob3V0LCByZXNpemVyKSB7CiAgICAgICAgICAgICAgdmFyIF9yZXNpemVyc1RvRGlzYWJsZSRyZTsKCiAgICAgICAgICAgICAgb3V0W3Jlc2l6ZXIuaWRdID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCByZXNpemVyKSwge30sIHsKICAgICAgICAgICAgICAgIGlzRm9jdXNlZDogZmFsc2UsCiAgICAgICAgICAgICAgICBpc0Rpc2FibGVkOiAoX3Jlc2l6ZXJzVG9EaXNhYmxlJHJlID0gcmVzaXplcnNUb0Rpc2FibGVbcmVzaXplci5pZF0pICE9PSBudWxsICYmIF9yZXNpemVyc1RvRGlzYWJsZSRyZSAhPT0gdm9pZCAwID8gX3Jlc2l6ZXJzVG9EaXNhYmxlJHJlIDogcmVzaXplci5pc0Rpc2FibGVkCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfSwge30pCiAgICAgICAgICB9KSk7CiAgICAgICAgfQoKICAgICAgY2FzZSAnRVVJX1JFU0laQUJMRV9CVVRUT05fRk9DVVMnOgogICAgICAgIHsKICAgICAgICAgIHZhciBfcmVzaXplcklkID0gYWN0aW9uLnBheWxvYWQucmVzaXplcklkOwogICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUpLCB7fSwgewogICAgICAgICAgICByZXNpemVyczogT2JqZWN0LnZhbHVlcyhzdGF0ZS5yZXNpemVycykucmVkdWNlKGZ1bmN0aW9uIChvdXQsIHJlc2l6ZXIpIHsKICAgICAgICAgICAgICBvdXRbcmVzaXplci5pZF0gPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHJlc2l6ZXIpLCB7fSwgewogICAgICAgICAgICAgICAgaXNGb2N1c2VkOiByZXNpemVyLmlkID09PSBfcmVzaXplcklkCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfSwge30pCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICBjYXNlICdFVUlfUkVTSVpBQkxFX0JVVFRPTl9CTFVSJzoKICAgICAgICB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZSksIHt9LCB7CiAgICAgICAgICAgIHJlc2l6ZXJzOiBPYmplY3QudmFsdWVzKHN0YXRlLnJlc2l6ZXJzKS5yZWR1Y2UoZnVuY3Rpb24gKG91dCwgcmVzaXplcikgewogICAgICAgICAgICAgIG91dFtyZXNpemVyLmlkXSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgcmVzaXplciksIHt9LCB7CiAgICAgICAgICAgICAgICBpc0ZvY3VzZWQ6IGZhbHNlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfSwge30pCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICBjYXNlICdFVUlfUkVTSVpBQkxFX1JFU0VUJzoKICAgICAgICB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpbml0aWFsU3RhdGUpLCB7fSwgewogICAgICAgICAgICBwYW5lbHM6IHN0YXRlLnBhbmVscywKICAgICAgICAgICAgcmVzaXplcnM6IHN0YXRlLnJlc2l6ZXJzLAogICAgICAgICAgICBjb250YWluZXJTaXplOiBzdGF0ZS5jb250YWluZXJTaXplCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICBjYXNlICdFVUlfUkVTSVpBQkxFX09OQ0hBTkdFJzoKICAgICAgICB7CiAgICAgICAgICBvblBhbmVsV2lkdGhDaGFuZ2Uoc2l6ZXNPbmx5KHN0YXRlLnBhbmVscykpOwogICAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgICAgIH0KICAgICAgLy8gVE9ETzogSW1wbGVtZW50IG1vcmUgZ2VuZXJpYyB2ZXJzaW9uIG9mCiAgICAgIC8vICdFVUlfUkVTSVpBQkxFX0RSQUdfTU9WRScgdG8gZXhwb3NlIHRvIGNvbnN1bWVycwoKICAgICAgY2FzZSAnRVVJX1JFU0laQUJMRV9SRVNJWkUnOgogICAgICAgIHsKICAgICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgICB9CgogICAgICBkZWZhdWx0OgogICAgICAgIGFzc2VydE5ldmVyKGFjdGlvbik7CiAgICAgICAgcmV0dXJuIHN0YXRlOwogICAgfQogIH0KCiAgdmFyIF91c2VSZWR1Y2VyID0gdXNlUmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsU3RhdGUsIGluaXQpLAogICAgICBfdXNlUmVkdWNlcjIgPSBfc2xpY2VkVG9BcnJheShfdXNlUmVkdWNlciwgMiksCiAgICAgIHJlZHVjZXJTdGF0ZSA9IF91c2VSZWR1Y2VyMlswXSwKICAgICAgZGlzcGF0Y2ggPSBfdXNlUmVkdWNlcjJbMV07CgogIHZhciBhY3Rpb25zID0gdXNlTWVtbyhmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICByZXNldDogZnVuY3Rpb24gcmVzZXQoKSB7CiAgICAgICAgcmV0dXJuIGRpc3BhdGNoKHsKICAgICAgICAgIHR5cGU6ICdFVUlfUkVTSVpBQkxFX1JFU0VUJwogICAgICAgIH0pOwogICAgICB9LAogICAgICBpbml0Q29udGFpbmVyOiBmdW5jdGlvbiBpbml0Q29udGFpbmVyKGlzSG9yaXpvbnRhbCkgewogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnRVVJX1JFU0laQUJMRV9DT05UQUlORVJfSU5JVCcsCiAgICAgICAgICBwYXlsb2FkOiB7CiAgICAgICAgICAgIGlzSG9yaXpvbnRhbDogaXNIb3Jpem9udGFsCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIHJlZ2lzdGVyUGFuZWw6IGZ1bmN0aW9uIHJlZ2lzdGVyUGFuZWwocGFuZWwpIHsKICAgICAgICByZXR1cm4gZGlzcGF0Y2goewogICAgICAgICAgdHlwZTogJ0VVSV9SRVNJWkFCTEVfUEFORUxfUkVHSVNURVInLAogICAgICAgICAgcGF5bG9hZDogewogICAgICAgICAgICBwYW5lbDogcGFuZWwKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSwKICAgICAgZGVyZWdpc3RlclBhbmVsOiBmdW5jdGlvbiBkZXJlZ2lzdGVyUGFuZWwocGFuZWxJZCkgewogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnRVVJX1JFU0laQUJMRV9QQU5FTF9ERVJFR0lTVEVSJywKICAgICAgICAgIHBheWxvYWQ6IHsKICAgICAgICAgICAgcGFuZWxJZDogcGFuZWxJZAogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICByZWdpc3RlclJlc2l6ZXI6IGZ1bmN0aW9uIHJlZ2lzdGVyUmVzaXplcihyZXNpemVyKSB7CiAgICAgICAgcmV0dXJuIGRpc3BhdGNoKHsKICAgICAgICAgIHR5cGU6ICdFVUlfUkVTSVpBQkxFX0JVVFRPTl9SRUdJU1RFUicsCiAgICAgICAgICBwYXlsb2FkOiB7CiAgICAgICAgICAgIHJlc2l6ZXI6IHJlc2l6ZXIKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSwKICAgICAgZGVyZWdpc3RlclJlc2l6ZXI6IGZ1bmN0aW9uIGRlcmVnaXN0ZXJSZXNpemVyKHJlc2l6ZXJJZCkgewogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnRVVJX1JFU0laQUJMRV9CVVRUT05fREVSRUdJU1RFUicsCiAgICAgICAgICBwYXlsb2FkOiB7CiAgICAgICAgICAgIHJlc2l6ZXJJZDogcmVzaXplcklkCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGRyYWdTdGFydDogZnVuY3Rpb24gZHJhZ1N0YXJ0KF9yZWYyKSB7CiAgICAgICAgdmFyIHByZXZQYW5lbElkID0gX3JlZjIucHJldlBhbmVsSWQsCiAgICAgICAgICAgIG5leHRQYW5lbElkID0gX3JlZjIubmV4dFBhbmVsSWQsCiAgICAgICAgICAgIHBvc2l0aW9uID0gX3JlZjIucG9zaXRpb247CiAgICAgICAgcmV0dXJuIGRpc3BhdGNoKHsKICAgICAgICAgIHR5cGU6ICdFVUlfUkVTSVpBQkxFX0RSQUdfU1RBUlQnLAogICAgICAgICAgcGF5bG9hZDogewogICAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sCiAgICAgICAgICAgIHByZXZQYW5lbElkOiBwcmV2UGFuZWxJZCwKICAgICAgICAgICAgbmV4dFBhbmVsSWQ6IG5leHRQYW5lbElkCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGRyYWdNb3ZlOiBmdW5jdGlvbiBkcmFnTW92ZShfcmVmMykgewogICAgICAgIHZhciBwcmV2UGFuZWxJZCA9IF9yZWYzLnByZXZQYW5lbElkLAogICAgICAgICAgICBuZXh0UGFuZWxJZCA9IF9yZWYzLm5leHRQYW5lbElkLAogICAgICAgICAgICBwb3NpdGlvbiA9IF9yZWYzLnBvc2l0aW9uOwogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnRVVJX1JFU0laQUJMRV9EUkFHX01PVkUnLAogICAgICAgICAgcGF5bG9hZDogewogICAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sCiAgICAgICAgICAgIHByZXZQYW5lbElkOiBwcmV2UGFuZWxJZCwKICAgICAgICAgICAgbmV4dFBhbmVsSWQ6IG5leHRQYW5lbElkCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGtleU1vdmU6IGZ1bmN0aW9uIGtleU1vdmUoX3JlZjQpIHsKICAgICAgICB2YXIgcHJldlBhbmVsSWQgPSBfcmVmNC5wcmV2UGFuZWxJZCwKICAgICAgICAgICAgbmV4dFBhbmVsSWQgPSBfcmVmNC5uZXh0UGFuZWxJZCwKICAgICAgICAgICAgZGlyZWN0aW9uID0gX3JlZjQuZGlyZWN0aW9uOwogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnRVVJX1JFU0laQUJMRV9LRVlfTU9WRScsCiAgICAgICAgICBwYXlsb2FkOiB7CiAgICAgICAgICAgIHByZXZQYW5lbElkOiBwcmV2UGFuZWxJZCwKICAgICAgICAgICAgbmV4dFBhbmVsSWQ6IG5leHRQYW5lbElkLAogICAgICAgICAgICBkaXJlY3Rpb246IGRpcmVjdGlvbgogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICB0b2dnbGVQYW5lbDogZnVuY3Rpb24gdG9nZ2xlUGFuZWwocGFuZWxJZCwgb3B0aW9ucykgewogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnRVVJX1JFU0laQUJMRV9UT0dHTEUnLAogICAgICAgICAgcGF5bG9hZDogewogICAgICAgICAgICBwYW5lbElkOiBwYW5lbElkLAogICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIHJlc2l6ZXJGb2N1czogZnVuY3Rpb24gcmVzaXplckZvY3VzKHJlc2l6ZXJJZCkgewogICAgICAgIHJldHVybiBkaXNwYXRjaCh7CiAgICAgICAgICB0eXBlOiAnRVVJX1JFU0laQUJMRV9CVVRUT05fRk9DVVMnLAogICAgICAgICAgcGF5bG9hZDogewogICAgICAgICAgICByZXNpemVySWQ6IHJlc2l6ZXJJZAogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICByZXNpemVyQmx1cjogZnVuY3Rpb24gcmVzaXplckJsdXIoKSB7CiAgICAgICAgcmV0dXJuIGRpc3BhdGNoKHsKICAgICAgICAgIHR5cGU6ICdFVUlfUkVTSVpBQkxFX0JVVFRPTl9CTFVSJwogICAgICAgIH0pOwogICAgICB9CiAgICB9OwogIH0sIFtdKTsKICByZXR1cm4gW2FjdGlvbnMsIHJlZHVjZXJTdGF0ZV07Cn07Cgp0cnkgewogIHNpemVzT25seS5fX2RvY2dlbkluZm8gPSB7CiAgICBkZXNjcmlwdGlvbjogJycsCiAgICBkaXNwbGF5TmFtZTogJ3NpemVzT25seScsCiAgICBtZXRob2RzOiBbXSwKICAgIHByb3BzOiB7fSwKICAgIGV4dGVuZGVkSW50ZXJmYWNlczogWydQYXJhbXMnXQogIH07Cn0gY2F0Y2ggKGUpIHt9Cgp0cnkgewogIHVzZUNvbnRhaW5lckNhbGxiYWNrcy5fX2RvY2dlbkluZm8gPSB7CiAgICBkZXNjcmlwdGlvbjogJycsCiAgICBkaXNwbGF5TmFtZTogJ3VzZUNvbnRhaW5lckNhbGxiYWNrcycsCiAgICBtZXRob2RzOiBbXSwKICAgIHByb3BzOiB7CiAgICAgIGluaXRpYWxTdGF0ZTogewogICAgICAgIGRlZmF1bHRWYWx1ZTogbnVsbCwKICAgICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgICAgbmFtZTogJ2luaXRpYWxTdGF0ZScsCiAgICAgICAgcGFyZW50OiB7CiAgICAgICAgICBmaWxlTmFtZTogJ2V1aS9zcmMvY29tcG9uZW50cy9yZXNpemFibGVfY29udGFpbmVyL2hlbHBlcnMudHMnLAogICAgICAgICAgbmFtZTogJ1BhcmFtcycKICAgICAgICB9LAogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIHR5cGU6IHsKICAgICAgICAgIG5hbWU6ICdFdWlSZXNpemFibGVDb250YWluZXJTdGF0ZScKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNvbnRhaW5lclJlZjogewogICAgICAgIGRlZmF1bHRWYWx1ZTogbnVsbCwKICAgICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgICAgbmFtZTogJ2NvbnRhaW5lclJlZicsCiAgICAgICAgcGFyZW50OiB7CiAgICAgICAgICBmaWxlTmFtZTogJ2V1aS9zcmMvY29tcG9uZW50cy9yZXNpemFibGVfY29udGFpbmVyL2hlbHBlcnMudHMnLAogICAgICAgICAgbmFtZTogJ1BhcmFtcycKICAgICAgICB9LAogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIHR5cGU6IHsKICAgICAgICAgIG5hbWU6ICdSZWZPYmplY3Q8SFRNTERpdkVsZW1lbnQ+JwogICAgICAgIH0KICAgICAgfSwKICAgICAgb25QYW5lbFdpZHRoQ2hhbmdlOiB7CiAgICAgICAgZGVmYXVsdFZhbHVlOiBudWxsLAogICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICBuYW1lOiAnb25QYW5lbFdpZHRoQ2hhbmdlJywKICAgICAgICBwYXJlbnQ6IHsKICAgICAgICAgIGZpbGVOYW1lOiAnZXVpL3NyYy9jb21wb25lbnRzL3Jlc2l6YWJsZV9jb250YWluZXIvaGVscGVycy50cycsCiAgICAgICAgICBuYW1lOiAnUGFyYW1zJwogICAgICAgIH0sCiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgIHR5cGU6IHsKICAgICAgICAgIG5hbWU6ICcoe306IHsgW2tleTogc3RyaW5nXTogbnVtYmVyOyB9KSA9PiBhbnknCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZXh0ZW5kZWRJbnRlcmZhY2VzOiBbJ1BhcmFtcyddCiAgfTsKfSBjYXRjaCAoZSkge30="},{"version":3,"sources":["D:/work/eui/src/components/resizable_container/helpers.ts"],"names":["useMemo","useReducer","assertNever","isMouseEvent","event","pxToPercent","proportion","whole","sizesOnly","panelObject","Object","values","reduce","out","panel","id","size","_getPanelMinSize","panelMinSize","containerSize","panelMinSizePercent","panelMinSizeInt","parseInt","indexOf","getPanelMinSize","paddingMin","configMin","Math","max","getPosition","isHorizontal","clientX","touches","clientY","getSiblingPanel","element","adjacency","method","sibling","matches","init","state","useContainerCallbacks","initialState","containerRef","onPanelWidthChange","reducer","action","getContainerSize","current","getBoundingClientRect","width","height","runSideEffect","panels","withSideEffect","newState","type","payload","panelId","resizer","resizers","resizerId","position","prevPanelId","nextPanelId","isDragging","currentResizerPos","prevPanel","nextPanel","delta","prevPanelMin","minSize","nextPanelMin","prevPanelSize","getSizePx","nextPanelSize","direction","options","currentPanelId","currentPanel","shouldCollapse","isCollapsed","panelElement","document","getElementById","prevResizer","previousElementSibling","nextResizer","nextElementSibling","resizersToDisable","otherPanels","siblings","keys","length","maybePrevPanel","maybeNextPanel","validPrevPanel","validNextPanel","newPanelSize","mode","prevSize","collapsedPanelsSize","sum","updatedPanels","some","isFocused","isDisabled","reducerState","dispatch","actions","reset","initContainer","registerPanel","deregisterPanel","registerResizer","deregisterResizer","dragStart","dragMove","keyMove","togglePanel","resizerFocus","resizerBlur"],"mappings":"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","sourcesContent":["/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport {\n  useMemo,\n  useReducer,\n  MouseEvent as ReactMouseEvent,\n  TouchEvent as ReactTouchEvent,\n} from 'react';\n\nimport { assertNever } from '../common';\nimport {\n  EuiResizablePanelController,\n  EuiResizableButtonController,\n  EuiResizableContainerRegistry,\n  EuiResizableContainerState,\n  EuiResizableContainerAction,\n  EuiResizableContainerActions,\n  ActionDragStart,\n  ActionDragMove,\n  ActionKeyMove,\n  ActionToggle,\n  ActionFocus,\n} from './types';\n\ninterface Params {\n  initialState: EuiResizableContainerState;\n  containerRef: React.RefObject<HTMLDivElement>;\n  onPanelWidthChange?: ({}: { [key: string]: number }) => any;\n}\n\nfunction isMouseEvent(\n  event: ReactMouseEvent | ReactTouchEvent\n): event is ReactMouseEvent {\n  return typeof event === 'object' && 'pageX' in event && 'pageY' in event;\n}\n\nexport const pxToPercent = (proportion: number, whole: number) => {\n  if (whole < 1 || proportion < 0) return 0;\n  return (proportion / whole) * 100;\n};\n\nexport const sizesOnly = (\n  panelObject: EuiResizableContainerRegistry['panels']\n) => {\n  return Object.values(panelObject).reduce(\n    (out: { [key: string]: number }, panel) => {\n      out[panel.id] = panel.size;\n      return out;\n    },\n    {}\n  );\n};\n\nconst _getPanelMinSize = (panelMinSize: string, containerSize: number) => {\n  let panelMinSizePercent = 0;\n  const panelMinSizeInt = parseInt(panelMinSize);\n  if (panelMinSize.indexOf('px') > -1) {\n    panelMinSizePercent = pxToPercent(panelMinSizeInt, containerSize);\n  } else if (panelMinSize.indexOf('%') > -1) {\n    panelMinSizePercent = pxToPercent(\n      containerSize * (panelMinSizeInt / 100),\n      containerSize\n    );\n  }\n  return panelMinSizePercent;\n};\n\nexport const getPanelMinSize = (\n  panelMinSize: string[],\n  containerSize: number\n) => {\n  const paddingMin = _getPanelMinSize(panelMinSize[1], containerSize);\n  const configMin = _getPanelMinSize(panelMinSize[0], containerSize);\n  return Math.max(configMin, paddingMin);\n};\n\nexport const getPosition = (\n  event: ReactMouseEvent | ReactTouchEvent,\n  isHorizontal: boolean\n) => {\n  const clientX = isMouseEvent(event)\n    ? event.clientX\n    : event.touches[0].clientX;\n  const clientY = isMouseEvent(event)\n    ? event.clientY\n    : event.touches[0].clientY;\n  return isHorizontal ? clientX : clientY;\n};\n\nconst getSiblingPanel = (\n  element: HTMLElement | null,\n  adjacency: 'prev' | 'next'\n) => {\n  if (!element) return null;\n  const method =\n    adjacency === 'prev' ? 'previousElementSibling' : 'nextElementSibling';\n  let sibling = element[method];\n  while (sibling) {\n    if (\n      sibling.matches('.euiResizablePanel:not(.euiResizablePanel-isCollapsed)')\n    ) {\n      return sibling;\n    }\n    sibling = sibling[method];\n  }\n};\n\n// lazy initialization to prevent rerender on initial interaction\nconst init = (state: EuiResizableContainerState) => state;\n\nexport const useContainerCallbacks = ({\n  initialState,\n  containerRef,\n  onPanelWidthChange,\n}: Params): [EuiResizableContainerActions, EuiResizableContainerState] => {\n  function reducer(\n    state: EuiResizableContainerState,\n    action: EuiResizableContainerAction\n  ): EuiResizableContainerState {\n    const getContainerSize = (isHorizontal: boolean) => {\n      return isHorizontal\n        ? containerRef.current!.getBoundingClientRect().width\n        : containerRef.current!.getBoundingClientRect().height;\n    };\n\n    const runSideEffect = (panels: EuiResizableContainerState['panels']) => {\n      if (onPanelWidthChange) {\n        onPanelWidthChange(sizesOnly(panels));\n      }\n    };\n\n    const withSideEffect = (newState: EuiResizableContainerState) => {\n      runSideEffect(newState.panels);\n      return newState;\n    };\n\n    switch (action.type) {\n      case 'EUI_RESIZABLE_CONTAINER_INIT': {\n        const { isHorizontal } = action.payload;\n        return {\n          ...state,\n          isHorizontal,\n          containerSize: getContainerSize(isHorizontal),\n        };\n      }\n      case 'EUI_RESIZABLE_PANEL_REGISTER': {\n        const { panel } = action.payload;\n        return {\n          ...state,\n          panels: {\n            ...state.panels,\n            [panel.id]: panel,\n          },\n        };\n      }\n      case 'EUI_RESIZABLE_PANEL_DEREGISTER': {\n        const { panelId } = action.payload;\n        return {\n          ...state,\n          panels: Object.values(state.panels).reduce(\n            (out: EuiResizableContainerState['panels'], panel) => {\n              if (panel.id !== panelId) {\n                out[panel.id] = panel;\n              }\n              return out;\n            },\n            {}\n          ),\n        };\n      }\n      case 'EUI_RESIZABLE_BUTTON_REGISTER': {\n        const { resizer } = action.payload;\n        return {\n          ...state,\n          resizers: {\n            ...state.resizers,\n            [resizer.id]: resizer,\n          },\n        };\n      }\n      case 'EUI_RESIZABLE_BUTTON_DEREGISTER': {\n        const { resizerId } = action.payload;\n        return {\n          ...state,\n          resizers: Object.values(state.resizers).reduce(\n            (out: EuiResizableContainerState['resizers'], panel) => {\n              if (panel.id !== resizerId) {\n                out[panel.id] = panel;\n              }\n              return out;\n            },\n            {}\n          ),\n        };\n      }\n      case 'EUI_RESIZABLE_DRAG_START': {\n        const { position, prevPanelId, nextPanelId } = action.payload;\n        return {\n          ...state,\n          isDragging: true,\n          currentResizerPos: position,\n          prevPanelId,\n          nextPanelId,\n        };\n      }\n      case 'EUI_RESIZABLE_DRAG_MOVE': {\n        if (!state.isDragging) {\n          return state;\n        }\n        const { position, prevPanelId, nextPanelId } = action.payload;\n        const prevPanel = state.panels[prevPanelId];\n        const nextPanel = state.panels[nextPanelId];\n        const delta = position - state.currentResizerPos;\n\n        const prevPanelMin = getPanelMinSize(\n          prevPanel.minSize,\n          state.containerSize\n        );\n        const nextPanelMin = getPanelMinSize(\n          nextPanel.minSize,\n          state.containerSize\n        );\n        const prevPanelSize = pxToPercent(\n          prevPanel.getSizePx() + delta,\n          state.containerSize\n        );\n        const nextPanelSize = pxToPercent(\n          nextPanel.getSizePx() - delta,\n          state.containerSize\n        );\n\n        if (prevPanelSize >= prevPanelMin && nextPanelSize >= nextPanelMin) {\n          return withSideEffect({\n            ...state,\n            currentResizerPos: position,\n            panels: {\n              ...state.panels,\n              [prevPanelId]: {\n                ...state.panels[prevPanelId],\n                size: prevPanelSize,\n              },\n              [nextPanelId]: {\n                ...state.panels[nextPanelId],\n                size: nextPanelSize,\n              },\n            },\n          });\n        }\n\n        return state;\n      }\n      case 'EUI_RESIZABLE_KEY_MOVE': {\n        const { prevPanelId, nextPanelId, direction } = action.payload;\n        const prevPanel = state.panels[prevPanelId];\n        const nextPanel = state.panels[nextPanelId];\n\n        const prevPanelMin = getPanelMinSize(\n          prevPanel.minSize,\n          state.containerSize\n        );\n        const nextPanelMin = getPanelMinSize(\n          nextPanel.minSize,\n          state.containerSize\n        );\n        const prevPanelSize = pxToPercent(\n          prevPanel.getSizePx() - (direction === 'backward' ? 10 : -10),\n          state.containerSize\n        );\n        const nextPanelSize = pxToPercent(\n          nextPanel.getSizePx() - (direction === 'forward' ? 10 : -10),\n          state.containerSize\n        );\n\n        if (prevPanelSize >= prevPanelMin && nextPanelSize >= nextPanelMin) {\n          return withSideEffect({\n            ...state,\n            isDragging: false,\n            panels: {\n              ...state.panels,\n              [prevPanelId]: {\n                ...state.panels[prevPanelId],\n                size: prevPanelSize,\n              },\n              [nextPanelId]: {\n                ...state.panels[nextPanelId],\n                size: nextPanelSize,\n              },\n            },\n          });\n        }\n\n        return state;\n      }\n\n      case 'EUI_RESIZABLE_TOGGLE': {\n        const { options, panelId: currentPanelId } = action.payload;\n        const currentPanel = state.panels[currentPanelId];\n        const shouldCollapse = !currentPanel.isCollapsed;\n        const panelElement = document.getElementById(currentPanelId);\n        const prevResizer = panelElement!.previousElementSibling;\n        const prevPanel = prevResizer\n          ? prevResizer.previousElementSibling\n          : null;\n        const nextResizer = panelElement!.nextElementSibling;\n        const nextPanel = nextResizer ? nextResizer.nextElementSibling : null;\n\n        const resizersToDisable: { [id: string]: boolean | null } = {};\n        if (prevResizer && prevPanel) {\n          resizersToDisable[prevResizer.id] = state.panels[prevPanel.id]\n            .isCollapsed\n            ? true\n            : shouldCollapse;\n        }\n        if (nextResizer && nextPanel) {\n          resizersToDisable[nextResizer.id] = state.panels[nextPanel.id]\n            .isCollapsed\n            ? true\n            : shouldCollapse;\n        }\n        let otherPanels: EuiResizableContainerRegistry['panels'] = {};\n        if (\n          prevPanel &&\n          !state.panels[prevPanel.id].isCollapsed &&\n          options.direction === 'right'\n        ) {\n          otherPanels[prevPanel.id] = state.panels[prevPanel.id];\n        }\n        if (\n          nextPanel &&\n          !state.panels[nextPanel.id].isCollapsed &&\n          options.direction === 'left'\n        ) {\n          otherPanels[nextPanel.id] = state.panels[nextPanel.id];\n        }\n        let siblings = Object.keys(otherPanels).length;\n\n        // A toggling sequence has occurred where an immediate sibling panel\n        // has not been found. We need to move more broadly through the DOM\n        // to find the next most suitable panel or space affordance.\n        // Can only occur when multiple immediate sibling panels are collapsed.\n        if (!siblings) {\n          const maybePrevPanel = getSiblingPanel(panelElement, 'prev');\n          const maybeNextPanel = getSiblingPanel(panelElement, 'next');\n          const validPrevPanel = maybePrevPanel\n            ? state.panels[maybePrevPanel.id]\n            : null;\n          const validNextPanel = maybeNextPanel\n            ? state.panels[maybeNextPanel.id]\n            : null;\n          // Intentional, preferential redistribution order\n          if (validPrevPanel && options.direction === 'right') {\n            otherPanels[validPrevPanel.id] = validPrevPanel;\n          } else if (validNextPanel && options.direction === 'left') {\n            otherPanels[validNextPanel.id] = validNextPanel;\n          } else {\n            if (validPrevPanel) otherPanels[validPrevPanel.id] = validPrevPanel;\n            if (validNextPanel) otherPanels[validNextPanel.id] = validNextPanel;\n          }\n          siblings = Object.keys(otherPanels).length;\n        }\n\n        let newPanelSize = shouldCollapse\n          ? pxToPercent(\n              !currentPanel.mode ? 0 : 24, // size of the default toggle button\n              state.containerSize\n            )\n          : currentPanel.prevSize;\n\n        const delta = shouldCollapse\n          ? (currentPanel.size - newPanelSize) / siblings\n          : ((newPanelSize - currentPanel.size) / siblings) * -1;\n\n        const collapsedPanelsSize = Object.values(state.panels).reduce(\n          (sum: number, panel) => {\n            if (panel.id !== currentPanelId && panel.isCollapsed) {\n              sum += panel.size;\n            }\n            return sum;\n          },\n          0\n        );\n\n        // A toggling sequence has occurred where a to-be-opened panel will\n        // become the only open panel. Rather than reopen to its previous\n        // size, give it the full width, less size occupied by collapsed panels.\n        // Can only occur with external toggling.\n        if (!shouldCollapse && !siblings) {\n          newPanelSize = 100 - collapsedPanelsSize;\n        }\n        let updatedPanels: EuiResizableContainerState['panels'] = {};\n        if (\n          delta < 0 &&\n          Object.values(otherPanels).some(\n            (panel) =>\n              panel.size + delta <\n              getPanelMinSize(panel.minSize, state.containerSize)\n          )\n        ) {\n          // A toggling sequence has occurred where a to-be-opened panel is\n          // requesting more space than its logical sibling panel can afford.\n          // Rather than choose another single panel to sacrifice space,\n          // or try to pull proportionally from all availble panels\n          // (neither of which is guaranteed to prevent negative resulting widths),\n          // or attempt something even more complex,\n          // we redistribute _all_ space evenly to non-collapsed panels\n          // as something of a reset.\n          // This situation can only occur when (n-1) panels are collapsed at once\n          // and the most recently collapsed panel gains significant width\n          // during the previously occurring collapse.\n          // That is (largely), external toggling where the default logic has\n          // been negated by the lack of panel mode distinction.\n          otherPanels = Object.values(state.panels).reduce(\n            (out: EuiResizableContainerState['panels'], panel) => {\n              if (panel.id !== currentPanelId && !panel.isCollapsed) {\n                out[panel.id] = {\n                  ...panel,\n                };\n              }\n              return out;\n            },\n            {}\n          );\n\n          newPanelSize =\n            (100 - collapsedPanelsSize) / (Object.keys(otherPanels).length + 1);\n\n          updatedPanels = Object.values(otherPanels).reduce(\n            (out: EuiResizableContainerState['panels'], panel) => {\n              out[panel.id] = {\n                ...panel,\n                size: newPanelSize,\n              };\n              return out;\n            },\n            {}\n          );\n        } else {\n          // A toggling sequence has occurred that is standard and predictable\n          updatedPanels = Object.values(otherPanels).reduce(\n            (out: EuiResizableContainerState['panels'], panel) => {\n              out[panel.id] = {\n                ...panel,\n                size: panel.size + delta,\n              };\n              return out;\n            },\n            {}\n          );\n        }\n\n        return withSideEffect({\n          ...state,\n          panels: {\n            ...state.panels,\n            ...updatedPanels,\n            [currentPanelId]: {\n              ...state.panels[currentPanelId],\n              size: newPanelSize,\n              isCollapsed: shouldCollapse,\n              prevSize: shouldCollapse ? currentPanel.size : newPanelSize,\n            },\n          },\n          resizers: Object.values(state.resizers).reduce(\n            (out: EuiResizableContainerState['resizers'], resizer) => {\n              out[resizer.id] = {\n                ...resizer,\n                isFocused: false,\n                isDisabled: resizersToDisable[resizer.id] ?? resizer.isDisabled,\n              };\n              return out;\n            },\n            {}\n          ),\n        });\n      }\n      case 'EUI_RESIZABLE_BUTTON_FOCUS': {\n        const { resizerId } = action.payload;\n        return {\n          ...state,\n          resizers: Object.values(state.resizers).reduce(\n            (out: EuiResizableContainerState['resizers'], resizer) => {\n              out[resizer.id] = {\n                ...resizer,\n                isFocused: resizer.id === resizerId,\n              };\n              return out;\n            },\n            {}\n          ),\n        };\n      }\n      case 'EUI_RESIZABLE_BUTTON_BLUR': {\n        return {\n          ...state,\n          resizers: Object.values(state.resizers).reduce(\n            (out: EuiResizableContainerState['resizers'], resizer) => {\n              out[resizer.id] = {\n                ...resizer,\n                isFocused: false,\n              };\n              return out;\n            },\n            {}\n          ),\n        };\n      }\n      case 'EUI_RESIZABLE_RESET': {\n        return {\n          ...initialState,\n          panels: state.panels,\n          resizers: state.resizers,\n          containerSize: state.containerSize,\n        };\n      }\n      case 'EUI_RESIZABLE_ONCHANGE': {\n        onPanelWidthChange!(sizesOnly(state.panels));\n        return state;\n      }\n      // TODO: Implement more generic version of\n      // 'EUI_RESIZABLE_DRAG_MOVE' to expose to consumers\n      case 'EUI_RESIZABLE_RESIZE': {\n        return state;\n      }\n      default:\n        assertNever(action);\n        return state;\n    }\n  }\n\n  const [reducerState, dispatch] = useReducer(reducer, initialState, init);\n\n  const actions: EuiResizableContainerActions = useMemo(() => {\n    return {\n      reset: () => dispatch({ type: 'EUI_RESIZABLE_RESET' }),\n      initContainer: (isHorizontal: boolean) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_CONTAINER_INIT',\n          payload: { isHorizontal },\n        }),\n      registerPanel: (panel: EuiResizablePanelController) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_PANEL_REGISTER',\n          payload: { panel },\n        }),\n      deregisterPanel: (panelId: EuiResizablePanelController['id']) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_PANEL_DEREGISTER',\n          payload: { panelId },\n        }),\n      registerResizer: (resizer: EuiResizableButtonController) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_BUTTON_REGISTER',\n          payload: { resizer },\n        }),\n      deregisterResizer: (resizerId: EuiResizableButtonController['id']) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_BUTTON_DEREGISTER',\n          payload: { resizerId },\n        }),\n      dragStart: ({\n        prevPanelId,\n        nextPanelId,\n        position,\n      }: ActionDragStart['payload']) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_DRAG_START',\n          payload: { position, prevPanelId, nextPanelId },\n        }),\n      dragMove: ({\n        prevPanelId,\n        nextPanelId,\n        position,\n      }: ActionDragMove['payload']) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_DRAG_MOVE',\n          payload: { position, prevPanelId, nextPanelId },\n        }),\n      keyMove: ({\n        prevPanelId,\n        nextPanelId,\n        direction,\n      }: ActionKeyMove['payload']) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_KEY_MOVE',\n          payload: { prevPanelId, nextPanelId, direction },\n        }),\n      togglePanel: (\n        panelId: ActionToggle['payload']['panelId'],\n        options: ActionToggle['payload']['options']\n      ) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_TOGGLE',\n          payload: { panelId, options },\n        }),\n      resizerFocus: (resizerId: ActionFocus['payload']['resizerId']) =>\n        dispatch({\n          type: 'EUI_RESIZABLE_BUTTON_FOCUS',\n          payload: { resizerId },\n        }),\n      resizerBlur: () =>\n        dispatch({\n          type: 'EUI_RESIZABLE_BUTTON_BLUR',\n        }),\n    };\n  }, []);\n\n  return [actions, reducerState];\n};\n"]}]}