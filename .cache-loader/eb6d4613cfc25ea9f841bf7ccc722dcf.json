{"remainingRequest":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!D:\\work\\eui\\src\\components\\combo_box\\matching_options.ts","dependencies":[{"path":"D:\\work\\eui\\src\\components\\combo_box\\matching_options.ts","mtime":1649070093343},{"path":"D:\\work\\eui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636976621750},{"path":"D:\\work\\eui\\node_modules\\babel-loader\\lib\\index.js","mtime":1649070120649}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3RhcnRzLXdpdGgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CgpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmICh0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkoYXJyKTsgfQoKZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9CgovKgogKiBMaWNlbnNlZCB0byBFbGFzdGljc2VhcmNoIEIuVi4gdW5kZXIgb25lIG9yIG1vcmUgY29udHJpYnV0b3IKICogbGljZW5zZSBhZ3JlZW1lbnRzLiBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3RyaWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQKICogb3duZXJzaGlwLiBFbGFzdGljc2VhcmNoIEIuVi4gbGljZW5zZXMgdGhpcyBmaWxlIHRvIHlvdSB1bmRlcgogKiB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heQogKiBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywKICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQogKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KZXhwb3J0IHZhciBmbGF0dGVuT3B0aW9uR3JvdXBzID0gZnVuY3Rpb24gZmxhdHRlbk9wdGlvbkdyb3VwcyhvcHRpb25zT3JHcm91cHMpIHsKICByZXR1cm4gb3B0aW9uc09yR3JvdXBzLnJlZHVjZShmdW5jdGlvbiAob3B0aW9ucywgb3B0aW9uT3JHcm91cCkgewogICAgaWYgKG9wdGlvbk9yR3JvdXAub3B0aW9ucykgewogICAgICBvcHRpb25zLnB1c2guYXBwbHkob3B0aW9ucywgX3RvQ29uc3VtYWJsZUFycmF5KG9wdGlvbk9yR3JvdXAub3B0aW9ucykpOwogICAgfSBlbHNlIHsKICAgICAgb3B0aW9ucy5wdXNoKG9wdGlvbk9yR3JvdXApOwogICAgfQoKICAgIHJldHVybiBvcHRpb25zOwogIH0sIFtdKTsKfTsKZXhwb3J0IHZhciBnZXRTZWxlY3RlZE9wdGlvbkZvclNlYXJjaFZhbHVlID0gZnVuY3Rpb24gZ2V0U2VsZWN0ZWRPcHRpb25Gb3JTZWFyY2hWYWx1ZShzZWFyY2hWYWx1ZSwgc2VsZWN0ZWRPcHRpb25zLCBvcHRpb25LZXkpIHsKICB2YXIgbm9ybWFsaXplZFNlYXJjaFZhbHVlID0gc2VhcmNoVmFsdWUudG9Mb3dlckNhc2UoKTsKICByZXR1cm4gc2VsZWN0ZWRPcHRpb25zLmZpbmQoZnVuY3Rpb24gKG9wdGlvbikgewogICAgcmV0dXJuIG9wdGlvbi5sYWJlbC50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkU2VhcmNoVmFsdWUgJiYgKCFvcHRpb25LZXkgfHwgb3B0aW9uLmtleSA9PT0gb3B0aW9uS2V5KTsKICB9KTsKfTsKCnZhciBjb2xsZWN0TWF0Y2hpbmdPcHRpb24gPSBmdW5jdGlvbiBjb2xsZWN0TWF0Y2hpbmdPcHRpb24oYWNjdW11bGF0b3IsIG9wdGlvbiwgc2VsZWN0ZWRPcHRpb25zLCBub3JtYWxpemVkU2VhcmNoVmFsdWUsIGlzUHJlRmlsdGVyZWQsIHNob3dQcmV2U2VsZWN0ZWQpIHsKICAvLyBPbmx5IHNob3cgb3B0aW9ucyB3aGljaCBoYXZlbid0IHlldCBiZWVuIHNlbGVjdGVkIHVubGVzcyByZXF1ZXN0ZWQuCiAgdmFyIHNlbGVjdGVkT3B0aW9uID0gZ2V0U2VsZWN0ZWRPcHRpb25Gb3JTZWFyY2hWYWx1ZShvcHRpb24ubGFiZWwsIHNlbGVjdGVkT3B0aW9ucywgb3B0aW9uLmtleSk7CgogIGlmIChzZWxlY3RlZE9wdGlvbiAmJiAhc2hvd1ByZXZTZWxlY3RlZCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0gLy8gSWYgdGhlIG9wdGlvbnMgaGF2ZSBhbHJlYWR5IGJlZW4gcHJlLWZpbHRlcmVkIHRoZW4gd2UgY2FuIHNraXAgZmlsdGVyaW5nIGFnYWluc3QgdGhlIHNlYXJjaCB2YWx1ZS4KCgogIGlmIChpc1ByZUZpbHRlcmVkKSB7CiAgICBhY2N1bXVsYXRvci5wdXNoKG9wdGlvbik7CiAgICByZXR1cm47CiAgfQoKICBpZiAoIW5vcm1hbGl6ZWRTZWFyY2hWYWx1ZSkgewogICAgYWNjdW11bGF0b3IucHVzaChvcHRpb24pOwogICAgcmV0dXJuOwogIH0KCiAgdmFyIG5vcm1hbGl6ZWRPcHRpb24gPSBvcHRpb24ubGFiZWwudHJpbSgpLnRvTG93ZXJDYXNlKCk7CgogIGlmIChub3JtYWxpemVkT3B0aW9uLmluY2x1ZGVzKG5vcm1hbGl6ZWRTZWFyY2hWYWx1ZSkpIHsKICAgIGFjY3VtdWxhdG9yLnB1c2gob3B0aW9uKTsKICB9Cn07CgpleHBvcnQgdmFyIGdldE1hdGNoaW5nT3B0aW9ucyA9IGZ1bmN0aW9uIGdldE1hdGNoaW5nT3B0aW9ucyhvcHRpb25zLCBzZWxlY3RlZE9wdGlvbnMsIHNlYXJjaFZhbHVlLCBpc1ByZUZpbHRlcmVkLCBzaG93UHJldlNlbGVjdGVkLCBzb3J0TWF0Y2hlc0J5KSB7CiAgdmFyIG5vcm1hbGl6ZWRTZWFyY2hWYWx1ZSA9IHNlYXJjaFZhbHVlLnRyaW0oKS50b0xvd2VyQ2FzZSgpOwogIHZhciBtYXRjaGluZ09wdGlvbnMgPSBbXTsKICBvcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKG9wdGlvbikgewogICAgaWYgKG9wdGlvbi5vcHRpb25zKSB7CiAgICAgIHZhciBtYXRjaGluZ09wdGlvbnNGb3JHcm91cCA9IFtdOwogICAgICBvcHRpb24ub3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChncm91cE9wdGlvbikgewogICAgICAgIGNvbGxlY3RNYXRjaGluZ09wdGlvbihtYXRjaGluZ09wdGlvbnNGb3JHcm91cCwgZ3JvdXBPcHRpb24sIHNlbGVjdGVkT3B0aW9ucywgbm9ybWFsaXplZFNlYXJjaFZhbHVlLCBpc1ByZUZpbHRlcmVkLCBzaG93UHJldlNlbGVjdGVkKTsKICAgICAgfSk7CgogICAgICBpZiAobWF0Y2hpbmdPcHRpb25zRm9yR3JvdXAubGVuZ3RoID4gMCkgewogICAgICAgIC8vIEFkZCBvcHRpb24gZm9yIGdyb3VwIGxhYmVsCiAgICAgICAgbWF0Y2hpbmdPcHRpb25zLnB1c2goewogICAgICAgICAga2V5OiBvcHRpb24ua2V5LAogICAgICAgICAgbGFiZWw6IG9wdGlvbi5sYWJlbCwKICAgICAgICAgIGlzR3JvdXBMYWJlbE9wdGlvbjogdHJ1ZQogICAgICAgIH0pOyAvLyBBZGQgbWF0Y2hpbmcgb3B0aW9ucyBmb3IgZ3JvdXAKCiAgICAgICAgbWF0Y2hpbmdPcHRpb25zLnB1c2guYXBwbHkobWF0Y2hpbmdPcHRpb25zLCBtYXRjaGluZ09wdGlvbnNGb3JHcm91cCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbGxlY3RNYXRjaGluZ09wdGlvbihtYXRjaGluZ09wdGlvbnMsIG9wdGlvbiwgc2VsZWN0ZWRPcHRpb25zLCBub3JtYWxpemVkU2VhcmNoVmFsdWUsIGlzUHJlRmlsdGVyZWQsIHNob3dQcmV2U2VsZWN0ZWQpOwogICAgfQogIH0pOwoKICBpZiAoc29ydE1hdGNoZXNCeSA9PT0gJ3N0YXJ0c1dpdGgnKSB7CiAgICB2YXIgcmVmT2JqID0gewogICAgICBzdGFydFdpdGg6IFtdLAogICAgICBvdGhlcnM6IFtdCiAgICB9OwogICAgbWF0Y2hpbmdPcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKG9iamVjdCkgewogICAgICBpZiAob2JqZWN0LmxhYmVsLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChub3JtYWxpemVkU2VhcmNoVmFsdWUpKSB7CiAgICAgICAgcmVmT2JqLnN0YXJ0V2l0aC5wdXNoKG9iamVjdCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVmT2JqLm90aGVycy5wdXNoKG9iamVjdCk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkocmVmT2JqLnN0YXJ0V2l0aCksIF90b0NvbnN1bWFibGVBcnJheShyZWZPYmoub3RoZXJzKSk7CiAgfQoKICByZXR1cm4gbWF0Y2hpbmdPcHRpb25zOwp9OwoKdHJ5IHsKICBmbGF0dGVuT3B0aW9uR3JvdXBzLl9fZG9jZ2VuSW5mbyA9IHsKICAgIGRlc2NyaXB0aW9uOiAnJywKICAgIGRpc3BsYXlOYW1lOiAnZmxhdHRlbk9wdGlvbkdyb3VwcycsCiAgICBtZXRob2RzOiBbXSwKICAgIHByb3BzOiB7fSwKICAgIGV4dGVuZGVkSW50ZXJmYWNlczogWydBcnJheSddCiAgfTsKfSBjYXRjaCAoZSkge30="},{"version":3,"sources":["D:/work/eui/src/components/combo_box/matching_options.ts"],"names":["flattenOptionGroups","optionsOrGroups","reduce","options","optionOrGroup","push","getSelectedOptionForSearchValue","searchValue","selectedOptions","optionKey","normalizedSearchValue","toLowerCase","find","option","label","key","collectMatchingOption","accumulator","isPreFiltered","showPrevSelected","selectedOption","normalizedOption","trim","includes","getMatchingOptions","sortMatchesBy","matchingOptions","forEach","matchingOptionsForGroup","groupOption","length","isGroupLabelOption","refObj","startWith","others","object","startsWith"],"mappings":"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","sourcesContent":["/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { EuiComboBoxOptionOption } from './types';\n\nexport const flattenOptionGroups = <T>(\n  optionsOrGroups: Array<EuiComboBoxOptionOption<T>>\n) => {\n  return optionsOrGroups.reduce(\n    (\n      options: Array<EuiComboBoxOptionOption<T>>,\n      optionOrGroup: EuiComboBoxOptionOption<T>\n    ) => {\n      if (optionOrGroup.options) {\n        options.push(...optionOrGroup.options);\n      } else {\n        options.push(optionOrGroup);\n      }\n      return options;\n    },\n    []\n  );\n};\n\nexport const getSelectedOptionForSearchValue = <T>(\n  searchValue: string,\n  selectedOptions: Array<EuiComboBoxOptionOption<T>>,\n  optionKey?: string\n) => {\n  const normalizedSearchValue = searchValue.toLowerCase();\n  return selectedOptions.find(\n    (option) =>\n      option.label.toLowerCase() === normalizedSearchValue &&\n      (!optionKey || option.key === optionKey)\n  );\n};\n\nconst collectMatchingOption = <T>(\n  accumulator: Array<EuiComboBoxOptionOption<T>>,\n  option: EuiComboBoxOptionOption<T>,\n  selectedOptions: Array<EuiComboBoxOptionOption<T>>,\n  normalizedSearchValue: string,\n  isPreFiltered: boolean,\n  showPrevSelected: boolean\n) => {\n  // Only show options which haven't yet been selected unless requested.\n  const selectedOption = getSelectedOptionForSearchValue(\n    option.label,\n    selectedOptions,\n    option.key\n  );\n  if (selectedOption && !showPrevSelected) {\n    return false;\n  }\n\n  // If the options have already been pre-filtered then we can skip filtering against the search value.\n  if (isPreFiltered) {\n    accumulator.push(option);\n    return;\n  }\n\n  if (!normalizedSearchValue) {\n    accumulator.push(option);\n    return;\n  }\n\n  const normalizedOption = option.label.trim().toLowerCase();\n  if (normalizedOption.includes(normalizedSearchValue)) {\n    accumulator.push(option);\n  }\n};\n\nexport const getMatchingOptions = <T>(\n  options: Array<EuiComboBoxOptionOption<T>>,\n  selectedOptions: Array<EuiComboBoxOptionOption<T>>,\n  searchValue: string,\n  isPreFiltered: boolean,\n  showPrevSelected: boolean,\n  sortMatchesBy: string\n) => {\n  const normalizedSearchValue = searchValue.trim().toLowerCase();\n  const matchingOptions: Array<EuiComboBoxOptionOption<T>> = [];\n\n  options.forEach((option) => {\n    if (option.options) {\n      const matchingOptionsForGroup: Array<EuiComboBoxOptionOption<T>> = [];\n      option.options.forEach((groupOption: EuiComboBoxOptionOption<T>) => {\n        collectMatchingOption(\n          matchingOptionsForGroup,\n          groupOption,\n          selectedOptions,\n          normalizedSearchValue,\n          isPreFiltered,\n          showPrevSelected\n        );\n      });\n      if (matchingOptionsForGroup.length > 0) {\n        // Add option for group label\n        matchingOptions.push({\n          key: option.key,\n          label: option.label,\n          isGroupLabelOption: true,\n        });\n        // Add matching options for group\n        matchingOptions.push(...matchingOptionsForGroup);\n      }\n    } else {\n      collectMatchingOption(\n        matchingOptions,\n        option,\n        selectedOptions,\n        normalizedSearchValue,\n        isPreFiltered,\n        showPrevSelected\n      );\n    }\n  });\n\n  if (sortMatchesBy === 'startsWith') {\n    const refObj: {\n      startWith: Array<EuiComboBoxOptionOption<T>>;\n      others: Array<EuiComboBoxOptionOption<T>>;\n    } = { startWith: [], others: [] };\n\n    matchingOptions.forEach((object) => {\n      if (object.label.toLowerCase().startsWith(normalizedSearchValue)) {\n        refObj.startWith.push(object);\n      } else {\n        refObj.others.push(object);\n      }\n    });\n    return [...refObj.startWith, ...refObj.others];\n  }\n\n  return matchingOptions;\n};\n"]}]}